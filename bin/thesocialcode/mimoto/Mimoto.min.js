/*!
 * Mimoto - Rapid prototyping and production web app development kit
 * Created by The Social Code
 *
 * @author Sebastian Kersten
 *
 * Please support this project by donating: https://paypal.me/thesocialcode
 *
 */(()=>{var __webpack_modules__={412:(t,e,i)=>{"use strict";const o=i(978),n=i(166),s=i(790),r=i(707),a=i(361),l=i(858),u=i(980),c=i(191),d=i(746),h=i(62),_=i(42);window.Mimoto||(window.Mimoto={},window.Mimoto.config={},window.Mimoto.bIsInEmulatorMode=!1,window.Mimoto.log=function(){window.console&&window.console.log.apply(this,arguments)},window.Mimoto.group=function(){window.console&&window.console.group.apply(this,arguments)},window.Mimoto.groupEnd=function(){window.console&&window.console.groupEnd.apply(this,arguments)},window.Mimoto.groupCollapsed=function(){window.console&&window.console.groupCollapsed.apply(this,arguments)},window.Mimoto.warn=function(){window.console&&window.console.warn.apply(this,arguments)},window.Mimoto.error=function(){window.console&&window.console.error.apply(this,arguments)},window.Mimoto.extender=new r,window.Mimoto.user=new n,window.Mimoto.navigation=new o,window.Mimoto.ui=new a,window.Mimoto.translation=new l,window.Mimoto.layout=new u,window.Mimoto.devtools=new c,window.Mimoto.realtime=new d,window.Mimoto.components={},window.Mimoto.firebase={},window.Mimoto.project={services:{},settings:{}},window.Mimoto.isInEmulatorMode=function(){return window.Mimoto.bIsInEmulatorMode},window.Mimoto.init=function(t,e=document.body,i=void 0){window.Mimoto.navigation.setContentTarget(e,t),t&&window.Mimoto.extender.makeView(t,i)},window.Mimoto.start=function(t={},e=!1){t.project?Mimoto.log("%c "+t.project+(t.developer?" by "+t.developer:"")+" %c - Created with %cMimoto%c - https://thesocialcode.com/mimoto","font-weight: bold; background-color: #93C47C; color: #ffffff; padding: 5px 5px;border-radius: 5px;","font-weight: normal","font-weight: normal","font-weight: normal"):Mimoto.log("%c ü•¶Ô∏è Created with Mimoto %c - https://thesocialcode.com/mimoto","font-weight: bold; background-color:#93C47C; color: #ffffff; padding: 5px 5px;border-radius: 5px;","font-weight: normal"),window.Mimoto.config=t,void 0===window.Mimoto.config.data&&(window.Mimoto.config.data={}),t?.contentTarget&&window.Mimoto.navigation.setContentTarget(t.contentTarget),void 0!==window.Mimoto.config.routes&&(Mimoto.layout.addTemplate("MimotoDefaultTemplate403",'<h1 style="text-align:center;margin-top:20px;">403 - Forbidden</h1>'),Mimoto.navigation.errors.addRoute("403","MimotoDefaultTemplate403"),["public","private","errors"].forEach((t=>{if(void 0!==window.Mimoto.config.routes[t])for(let e in window.Mimoto.config.routes[t]){let i=window.Mimoto.config.routes[t][e],o={title:void 0!==i.title?i.title:void 0,vars:void 0!==i.vars?i.vars:void 0,globalVars:void 0!==i.globalVars?i.globalVars:void 0,attributes:void 0!==i.attributes?i.attributes:void 0,roles:void 0!==i.roles?i.roles:void 0!==i.role?[i.role]:[],claims:i.claims},n=void 0!==i.templateName?i.templateName:void 0!==i.templateFile?i.templateFile:void 0!==i.template?i.template:void 0;Mimoto.navigation[t].addRoute(e,n,o)}})),window.Mimoto.config.routes.signedIn&&window.Mimoto.navigation.setRouteOnSignedIn(window.Mimoto.config.routes.signedIn),window.Mimoto.config.routes.signedUp&&window.Mimoto.navigation.setRouteOnSignedUp(window.Mimoto.config.routes.signedUp),window.Mimoto.config.routes.signedOut&&window.Mimoto.navigation.setRouteOnSignedOut(window.Mimoto.config.routes.signedOut));let i=[];const o=()=>{let t=[];void 0!==window.Mimoto.config.preload?.templates&&t.push(window.Mimoto.layout.preloadTemplates(window.Mimoto.config.preload.templates)),Promise.all(t).then((()=>{let t=void 0!==window.Mimoto.config?.firebase&&!1!==window.Mimoto.config?.firebase;void 0===window.Mimoto.config.bRunInEmulatorMode?"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname||(window.Mimoto.bIsInEmulatorMode=!0):window.Mimoto.bIsInEmulatorMode=window.Mimoto.config.bRunInEmulatorMode,(async()=>{try{const o="\n                                import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js';\n                                import { getAnalytics, logEvent } from 'https://www.gstatic.com/firebasejs/10.7.2/firebase-analytics.js';\n                                import { getDatabase, connectDatabaseEmulator, ref, set, get, update, onValue, push, remove, onChildAdded, onChildChanged, onChildRemoved, orderByChild, equalTo, limitToFirst, query, onDisconnect } from 'https://www.gstatic.com/firebasejs/10.7.2/firebase-database.js';\n                                import { getStorage, connectStorageEmulator, ref as storageRef, uploadBytesResumable, getDownloadURL } from 'https://www.gstatic.com/firebasejs/10.7.2/firebase-storage.js';\n                                import { getAuth, connectAuthEmulator, onAuthStateChanged, getRedirectResult, signInWithPopup, signInWithRedirect, signInWithCredential, GoogleAuthProvider, getAdditionalUserInfo, getIdToken, getIdTokenResult, onIdTokenChanged, signOut, updateProfile, reload } from 'https://www.gstatic.com/firebasejs/10.7.2/firebase-auth.js';\n                                import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js';\n                                import { getFunctions, connectFunctionsEmulator, httpsCallable } from 'https://www.gstatic.com/firebasejs/10.7.2/firebase-functions.js';\n                                window.Mimoto.firebase = {\n                                    initializeApp,\n                                    analytics: {\n                                        getAnalytics,\n                                        logEvent\n                                    },\n                                    realtimeDatabase: {\n                                        getDatabase,\n                                        connectDatabaseEmulator,\n                                        ref,\n                                        set,\n                                        get,\n                                        update,\n                                        onValue,\n                                        push,\n                                        remove,\n                                        onChildAdded,\n                                        onChildChanged,\n                                        onChildRemoved,\n                                        orderByChild,\n                                        equalTo,\n                                        limitToFirst,\n                                        query,\n                                        onDisconnect\n                                    },\n                                    storage: {\n                                        getStorage,\n                                        connectStorageEmulator,\n                                        storageRef,\n                                        uploadBytesResumable,\n                                        getDownloadURL\n                                    },\n                                    auth: {\n                                        getAuth,\n                                        connectAuthEmulator,\n                                        onAuthStateChanged,\n                                        getRedirectResult,\n                                        signInWithPopup,\n                                        signInWithRedirect,\n                                        signInWithCredential,\n                                        GoogleAuthProvider,\n                                        getAdditionalUserInfo,\n                                        getIdToken,\n                                        getIdTokenResult,\n                                        onIdTokenChanged,\n                                        signOut,\n                                        updateProfile,\n                                        reload\n                                    },\n                                    getFirestore,\n                                    functions: {\n                                        getFunctions,\n                                        connectFunctionsEmulator,\n                                        httpsCallable\n                                    }\n                                };\n                            ";await(i=URL.createObjectURL(new Blob([o],{type:"text/javascript"})),new Promise(((t,e)=>{const o=document.createElement("script");o.type="module",o.src=i,o.onload=t,o.onerror=e,document.body.appendChild(o)})));const n=window.Mimoto.firebase.initializeApp(window.Mimoto.config.firebaseConfig),r=window.Mimoto.firebase.analytics.getAnalytics(n),a=window.Mimoto.firebase.auth.getAuth(n),l=window.Mimoto.firebase.auth.connectAuthEmulator,u=window.Mimoto.firebase.realtimeDatabase.getDatabase(n),c=window.Mimoto.firebase.realtimeDatabase.connectDatabaseEmulator,d=window.Mimoto.firebase.storage.getStorage(n),p=window.Mimoto.firebase.storage.connectStorageEmulator;window.Mimoto.firebase.app=n,window.Mimoto.data=t&&u?new s({firebaseDatabase:u,firebaseDatabaseModules:window.Mimoto.firebase.realtimeDatabase,firebaseStorage:d,storageModules:window.Mimoto.firebase.storage,emulator:{databaseEmulator:c,realtimeDatabaseConfig:window.Mimoto.config.firebaseEmulatorConfig?.realtimeDatabase,storageEmulator:p,storageConfig:window.Mimoto.config.firebaseEmulatorConfig?.storage}}):new s,window.Mimoto.analytics=new h(r),t&&a&&(window.Mimoto.navigation.__start(),window.Mimoto.user.__start({firebaseAuth:a,firebaseAuthModules:window.Mimoto.firebase.auth,emulator:{autoEmulator:l,auth:window.Mimoto.config.firebaseEmulatorConfig?.auth},authentication:window.Mimoto.config.authentication})),void 0!==window.Mimoto.config?.firebase&&!1!==window.Mimoto.config?.firebase&&!0!==window.Mimoto.config.isAdmin||!0===window.Mimoto.config.isAdmin&&(window.Mimoto.user._bIsAdmin=!0,window.Mimoto.devtools.makeAdmin()),e||t&&a||window.Mimoto.navigation.goto(window.Mimoto.navigation.getCurrentPath());const T=window.Mimoto.config.licenseKey||"",m=!_.validateLicenseKeyFormat(T),g=_.validateLicenseKey(T);if(m||(window.Mimoto.hasLicenseKey=!0),m&&_.reportMissingLicenseKey(),"127.0.0.1"!==window.location.hostname&&"localhost"!==window.location.hostname&&"web.app"!==_.getRootDomain(window.location.hostname)&&(!0!==g||m)){let t=document.createElement("div");t.innerHTML='<a href="https://thesocialcode.com/mimoto?license='+T+'" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 43.43 35.46"><defs><style>.st0{fill:#FFFFFF;}.cls-1,.cls-2{fill:#000000;}.cls-2{font-size:4.53px;font-family:Impact;}</style></defs><path class="st0" d="M0,17.7C0,29,7.7,35.5,21.1,35.5c13.6,0,21.1-6.3,21.1-17.7S34.8,0,21.1,0C7.7,0,0,6.5,0,17.7z"/><path class="cls-1" d="M0,17.73C0,29,7.71,35.46,21.15,35.46c13.63,0,21.14-6.3,21.14-17.73S34.78,0,21.15,0C7.71,0,0,6.46,0,17.73Zm5.28,0c0-8.26,5.34-12.45,15.87-12.45C37,5.28,37,14.65,37,17.73s0,12.45-15.86,12.45C10.62,30.18,5.28,26,5.28,17.73Z"/><text class="cls-2" transform="translate(38.1 5.16)">TM</text><path class="cls-1" d="M19.83,21.86c0,2.58-.8,4.67-1.79,4.67s-1.78-2.09-1.78-4.67.8-4.67,1.78-4.67S19.83,19.28,19.83,21.86Z"/><path class="cls-1" d="M27.37,21.86c0,2.58-.8,4.67-1.79,4.67s-1.78-2.09-1.78-4.67.8-4.67,1.78-4.67S27.37,19.28,27.37,21.86Z"/></svg></a>',t.style.position="fixed",t.style.top="0",t.style.right="0",t.style.width="50px",t.style.borderBottomLeftRadius="10px",t.style.backgroundColor="white",t.style.padding="10px",t.style.paddingRight="12px",document.body.appendChild(t)}}catch(t){console.error("Error loading Firebase scripts:",t)}var i})()}))};if(window.hasOwnProperty("firebase")||void 0===window.Mimoto.config?.firebase||!1===window.Mimoto.config?.firebase)o();else{let t=[],e=[];Promise.all(e).then((()=>{for(let t in i);Promise.all(t).then((()=>o())).catch((t=>window.Mimoto.log(t)))}))}}),t.exports=window.Mimoto},62:t=>{"use strict";t.exports=class{_analytics=null;constructor(t){this._analytics=t}logEvent(t,e){null!==this._analytics&&window.Mimoto.firebase.analytics.logEvent(this._analytics,t,e)}}},790:(t,e,i)=>{"use strict";const o=i(697),n=i(948);i(939);t.exports=function(t){this._aDocuments={},this._aCollections={},this._documentsDeletedByThisUser={},this._aDocumentListeners=[],this.__construct(t)},t.exports.prototype={_firebaseDatabase:null,_firebaseDatabaseModules:null,_storage:null,_storageModules:null,DATA:o.DATA,KEY:o.KEY,LOADED:o.LOADED,CREATED:o.CREATED,CHANGED:o.CHANGED,STORING:o.STORING,STORED:o.STORED,DELETED:o.DELETED,AUTOSAVED:o.AUTOSAVED,ERROR:o.ERROR,FILE_STORED:o.FILE_STORED,FILE_PROGRESS:o.FILE_PROGRESS,__construct:function(t=null){window.Mimoto.extender.makeEventDispatcher(this),null!==t&&(this._firebaseDatabase=t.firebaseDatabase,this._firebaseDatabaseModules=t.firebaseDatabaseModules,this._storage=t.firebaseStorage,this._storageModules=t.storageModules,window.Mimoto.isInEmulatorMode()&&(window.Mimoto.config?.firebaseEmulatorConfig.realtimeDatabase&&t.emulator.databaseEmulator(this._firebaseDatabase,window.Mimoto.config?.firebaseEmulatorConfig.realtimeDatabase.host,window.Mimoto.config?.firebaseEmulatorConfig.realtimeDatabase.port),window.Mimoto.config?.firebaseEmulatorConfig.storage&&t.emulator.storageEmulator(this._storage,window.Mimoto.config?.firebaseEmulatorConfig.storage.host,window.Mimoto.config?.firebaseEmulatorConfig.storage.port))),this.internal={},this.internal.realtimeDatabase=t=>this._firebaseDatabaseModules.ref(this._firebaseDatabase,t),this.internal.realtimeDatabaseModules=()=>this._firebaseDatabaseModules,this.internal.storage=()=>this._storage,this.internal.storageModules=()=>this._storageModules,this.internal.loadLocalData=(t,e,i)=>{this._internalLoadLocalData(t,e,i)},this.internal.updateLocalData=(t,e)=>{this._internalUpdateLocalData(t,e)},this.internal.registerDocumentDeletionInitiatedByThisUser=t=>this._internalRegisterDocumentDeletionInitiatedByThisUser(t),this.internal.hasDocumentDeletionInitiatedByThisUser=t=>this._internalHasDocumentDeletionInitiatedByThisUser(t),this.internal.unregisterDocumentDeletionInitiatedByThisUser=t=>this._internalUnregisterDocumentDeletionInitiatedByThisUser(t),this.internal.publicAPI={ISEQUAL:"isEqual",ISNOTEQUAL:"isNotEqual",STARTSWITH:"startsWith",ENDSWITH:"endsWith",CONTAINS:"contains",ISGREATERTHAN:"isGreaterThan",ISGREATEROREQUALTO:"isGreaterOrEqualTo",ISLESSTHAN:"isLessThan",ISLESSOREQUALTO:"isLessOrEqualTo",ISBETWEEN:"isBetween",ISNOTBETWEEN:"isNotBetween",ISEMPTY:"isEmpty",ISNOTEMPTY:"isNotEmpty",ISREGEX:"isRegex",ISNOTREGEX:"isNotRegex",ISTRUE:"isTrue",ISFALSE:"isFalse",NOT:"not",ISOBJECT:"isObject",ISNUMBER:"isNumber",ISARRAY:"isArray",CONCAT:"concat",SUBSTRING:"substring",STRINGIFY:"stringify",MULTIPLY:"multiply",DIVIDE:"divide",POWER:"power",ROUND:"round",DELAY:"delay",REPLACE:"replace",MERGE:"merge",ADD:"add",SUBTRACT:"subtract",MAX:"max",MIN:"min",SUM:"sum",COUNT:"count",AND:"and",OR:"or",IF:"if",COMPARE:"compare",DATE:"date",API:"api"}},isEqual:function(t,e){return isNaN(t)||isNaN(e)?t===e:parseFloat(t)===parseFloat(e)},isNotEqual:function(t,e){return!this.isEqual(t,e)},startsWith:function(t,e){return t.substring(0,e.length)===e},endsWith:function(t,e){return t.substring(t.length-e.length)===e},contains:function(t,e){return-1!==t.indexOf(e)},isGreaterThan:function(t,e){return isNaN(t)||isNaN(e)?t>e:parseFloat(t)>parseFloat(e)},isGreaterOrEqualTo:function(t,e){return isNaN(t)||isNaN(e)?t>=e:parseFloat(t)>=parseFloat(e)},isLessThan:function(t,e){return isNaN(t)||isNaN(e)?t<e:parseFloat(t)<parseFloat(e)},isLessOrEqualTo:function(t,e){return isNaN(t)||isNaN(e)?t<=e:parseFloat(t)<=parseFloat(e)},isBetween:function(t,e,i){return parseFloat(t)>=parseFloat(e)&&parseFloat(t)<=parseFloat(i)},isNotBetween:function(t,e,i){return!this.isBetween(t,e,i)},isEmpty:function(t=void 0){let e=[];for(const t of arguments){let i=!1;null==t||""===t||"string"==typeof t&&""===t||Array.isArray(t)||0===t.length?i=!0:"object"==typeof t&&(i=t&&0===Object.keys(t).length&&Object.getPrototypeOf(t)===Object.prototype),e.push(i)}return e.every((t=>!0===t))},isNotEmpty:function(t){return!this.isEmpty(t)},isRegex:function(t,e){var i=e.substring(1,e.lastIndexOf("/")),o=e.substring(e.lastIndexOf("/")+1);return new RegExp(i,o).test(t)},isNotRegex:function(t,e){return!this.isRegex(t,e)},isTrue:function(t){return!!t},isFalse:function(t){return this.isEmpty(t)||!this.isTrue(t)},not:function(){return Array.from(arguments).every((t=>this.isFalse(t)))},isObject:function(t){return n.isObject(t)},isNumber:function(t){return!isNaN(t)},isArray:function(t){return Array.isArray(t)},concat:function(){let t="",e=arguments.length;for(let i=0;i<e;i++)t+=void 0!==arguments[i]?arguments[i]:"";return t},substring:function(t,e,i){return this.isEmpty(t)?"":t.substring(e,i)},stringify:function(t){return"object"==typeof t?JSON.stringify(t):t+""},multiply:function(t,e=1){return parseFloat(t)*parseFloat(e)},divide:function(t,e=1){return parseFloat(t)/parseFloat(e)},power:function(t,e=1){return Math.pow(parseFloat(t),parseFloat(e))},round:function(t,e=0,i=null,o=null){return t=isNaN(t)?0:Number(t),e=isNaN(e)?0:Number(e),t=t.toFixed(e),null!==i&&(t=t.toString().replace(".",i)),null!==o&&(t=t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,o)),t},delay:function(t=1){return isNaN(t)&&(t=100),new Promise(((e,i)=>{setTimeout((()=>{e()}),1e3*t)}))},replace:function(t,e,i){return t?t.replace(e,i):t},merge:function(t,e){return n.mergeDeep(t,e)},sum:function(t,e=null){let i=0;if("object"!=typeof t){let e=!0;for(let t of arguments)if(!/^-?[0-9]+(\.[0-9]+)?$/.test(t)){e=!1;break}t=e?parseFloat(t)||0:t||"";let i=arguments.length;if(i<=1)return t;for(let o=1;o<i;o++)e?t+=parseFloat(arguments[o]):t=""+t+(arguments[o]||"");return t}null!==e&&void 0!==t[e]&&(t=t[e]);for(let o in t){let n=t[o];null!==e&&void 0!==n[e]&&(n=n[e]),isNaN(n)||(i+=n)}return i},subtract:function(t,...e){t=parseFloat(t);let i=e.length;for(let o=0;o<i;o++)t-=parseFloat(e[o]);return t},max:function(t,e,...i){return Math.max.apply(null,arguments)},min:function(t,e,...i){return Math.min.apply(null,arguments)},count:function(t){return"object"==typeof t?Object.keys(t).length:this.isEmpty(t)?0:1},and:function(t,e,...i){return Array.from(arguments).every((t=>!0===t))},or:function(t,e,...i){return Array.from(arguments).some((t=>!0===t))},if:function(t,e,i){return t?e:i},compare:function(t,e){return n.compareValuesInObjects(t,e)},date:function(t){var e={d:function(){return("0"+this.getDate()).slice(-2)},D:function(t){return new Intl.DateTimeFormat(t,{weekday:"short"}).format(this)},j:function(){return this.getDate()},l:function(t){return new Intl.DateTimeFormat(t,{weekday:"long"}).format(this)},N:function(){let t=this.getDay();return 0===t?7:t},S:function(){let t=this.getDate();return t%10==1&&11!==t?"st":t%10==2&&12!==t?"nd":t%10==3&&13!==t?"rd":"th"},w:function(){return this.getDay()},z:function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/864e5)},W:function(){let t=new Date(this.valueOf()),e=(this.getDay()+6)%7;t.setDate(t.getDate()-e+3);let i=t.valueOf();return t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7),Math.ceil((i-t)/6048e5)+1},F:function(t){return new Intl.DateTimeFormat(t,{month:"long"}).format(this)},m:function(){return("0"+(this.getMonth()+1)).slice(-2)},M:function(t){return new Intl.DateTimeFormat(t,{month:"short"}).format(this)},n:function(){return this.getMonth()+1},t:function(){let t=this.getFullYear(),e=this.getMonth()+1;return 12===e&&(t=t++,e=0),new Date(t,e,0).getDate()},L:function(){let t=this.getFullYear();return t%400==0||t%100!=0&&t%4==0?1:0},o:function(){let t=new Date(this.valueOf());return t.setDate(t.getDate()-(this.getDay()+6)%7+3),t.getFullYear()},Y:function(){return this.getFullYear()},y:function(){return(""+this.getFullYear()).slice(-2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){return("00"+Math.floor(1e3*((this.getUTCHours()+1)%24+this.getUTCMinutes()/60+this.getUTCSeconds()/3600)/24)).slice(-3)},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){return("0"+(this.getHours()%12||12)).slice(-2)},H:function(){return("0"+this.getHours()).slice(-2)},i:function(){return("0"+this.getMinutes()).slice(-2)},s:function(){return("0"+this.getSeconds()).slice(-2)},v:function(){return("00"+this.getMilliseconds()).slice(-3)},e:function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},I:function(){let t=null;for(let e=0;e<12;++e){let i=new Date(this.getFullYear(),e,1).getTimezoneOffset();if(null===t)t=i;else{if(i<t){t=i;break}if(i>t)break}}return this.getTimezoneOffset()===t|0},O:function(){let t=this.getTimezoneOffset();return(-t<0?"-":"+")+("0"+Math.floor(Math.abs(t/60))).slice(-2)+("0"+Math.abs(t%60)).slice(-2)},P:function(){let t=this.getTimezoneOffset();return(-t<0?"-":"+")+("0"+Math.floor(Math.abs(t/60))).slice(-2)+":"+("0"+Math.abs(t%60)).slice(-2)},T:function(t){let e=this.toLocaleTimeString(t,{timeZoneName:"short"}).split(" "),i=e[e.length-1];return"GMT+1"==i?"CET":"GMT+2"==i?"CEST":i},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return this.format("Y-m-d\\TH:i:sP")},r:function(){return this.format("D, d M Y H:i:s O")},U:function(){return Math.floor(this.getTime()/1e3)}};return Date.prototype.format=function(t,i=navigator.language){var o=this;return t.replace(/(\\?)(.)/g,(function(t,n,s){return""===n&&e[s]?e[s].call(o,i):s}))},(new Date).format(t)},api:function(t,e=null,i=null){return new Promise(((o,s)=>{let r="";for(let t in e)""!==r&&(r+="&"),r+=t+"="+e[t];let a=new XMLHttpRequest;a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){let t=null!==i?n.getDeepValue(i,JSON.parse(a.responseText)):a.responseText;o(t)}},a.open("POST",t,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send(r)}))},_internalLoadLocalData:function(t=null,e=null,i=null){this._aDocumentListeners.push({key:t,onValue:e,onError:i}),this._documentPointer(t).then((i=>{this._broadcastValue(e,t,n.clone(i))})).catch((t=>null))},_internalUpdateLocalData:function(t,e){this._documentPointer(t,e).then((t=>null)).catch((t=>null))},_documentPointer:function(t,e=void 0){return new Promise(((i,o)=>{if("string"!=typeof t)return void o();let s=void 0!==e,r=t.split("."),a=window.Mimoto.config.data;for(;r.length>0;){let t=r.shift();if(void 0===a[t])return void o();0===r.length&&s&&(a[t]="object"==typeof e?n.mergeDeep(a[t],e):e),a=a[t]}if(s){let e="",i=t.split("."),o=window.Mimoto.config.data;for(;i.length>0;){let t=i.shift();e+=""!==e?t+".":t,this._aDocumentListeners.forEach((i=>{i.key===e&&this._broadcastValue(i.onValue,i.key,n.clone(o[t]))})),o=o[t]}}i(a)}))},_broadcastValue:function(t,e,i){t.apply(this,[this._createSnapshotObject(e,n.clone(i))])},_createSnapshotObject:function(t,e){let i={};return i.key=t,i.val=()=>e,i},_internalRegisterDocumentDeletionInitiatedByThisUser:function(t){this._documentsDeletedByThisUser[t]=null},_internalHasDocumentDeletionInitiatedByThisUser:function(t){return void 0!==this._documentsDeletedByThisUser[t]},_internalUnregisterDocumentDeletionInitiatedByThisUser:function(t){delete this._documentsDeletedByThisUser[t]},add:function(t,e={}){if(!e.query)return;let i=window.Mimoto.data.internal.realtimeDatabase(e.query);return new Promise(((e,o)=>{let n=window.Mimoto.data.internal.realtimeDatabaseModules().push(i),s=n.key;window.Mimoto.data.internal.realtimeDatabaseModules().set(n,t).then((()=>e({key:s,value:t}))).catch((t=>o(t)))}))}}},191:(t,e,i)=>{"use strict";const o=i(752),n=i(718);t.exports=function(){this._elPanel=null,this._elStyle=null,this.__construct()},t.exports.prototype={__construct:function(t){window.Mimoto.user.addEventListener(window.Mimoto.user.USER_IS_ADMIN,this._onUserIsAdmin.bind(this))},makeAdmin:function(){null===this._elStyle&&(this._elStyle=this._createCSS(),document.head.appendChild(this._elStyle))},show:function(){if(this._validateAndSetupAdmin()){if(null===this._elPanel){let t=document.createElement("template");t.innerHTML=n.trim(),this._elPanel=t.content.firstChild,this._elPanel.querySelector('[data-mimoto-id="toggle"]').addEventListener("click",(t=>this.hide()));let e=window.Mimoto.hasLicenseKey?"MimotoAdminPanel-donor":"MimotoAdminPanel-donationcallout";this._elPanel.querySelector('[data-mimoto-id="'+e+'"]').classList.add("MimotoTheme_DevToolsService_panel_footer_content_visible")}document.body.append(this._elPanel),setTimeout((()=>document.getElementById("MimotoAdminTools_panel").classList.add("MimotoTheme_DevToolsService_panel_visible")),1)}},hide:function(){this._validateAndSetupAdmin()&&null!==this._elPanel&&document.body.removeChild(this._elPanel)},hint:function(t){if(!this._validateAndSetupAdmin())return;Mimoto.error("elNodeContainingHint =",t),this.show();let e=document.createElement("a");e.setAttribute("class","MimotoTheme_DevToolsService_panel_hint");let i=document.createElement("div");i.setAttribute("class","MimotoTheme_DevToolsService_panel_hint_content"),i.innerHTML=t.getAttribute(o.DATA_MIMOTO_HINT),e.append(i);let n=document.createElement("div");n.setAttribute("class","MimotoTheme_DevToolsService_panel_hint_icon"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 98.48 98.48" xml:space="preserve"><path d="M97.204,45.788c-0.865-1.02-21.537-24.945-47.963-24.945c-26.427,0-47.098,23.925-47.965,24.946c-1.701,2-1.701,4.902,0.001,6.904c0.866,1.02,21.537,24.944,47.964,24.944c26.426,0,47.098-23.926,47.964-24.946C98.906,50.691,98.906,47.789,97.204,45.788z M57.313,35.215c1.777-0.97,4.255,0.143,5.534,2.485c1.279,2.343,0.875,5.029-0.902,5.999c-1.776,0.971-4.255-0.143-5.535-2.485C55.132,38.871,55.535,36.185,57.313,35.215z M49.241,68.969c-18.46,0-33.995-14.177-39.372-19.729c3.631-3.75,11.898-11.429,22.567-16.021c-2.081,3.166-3.301,6.949-3.301,11.021c0,11.104,9.001,20.105,20.105,20.105s20.106-9.001,20.106-20.105c0-4.072-1.219-7.855-3.3-11.021C76.715,37.812,84.981,45.49,88.612,49.24C83.235,54.795,67.7,68.969,49.241,68.969z"/></svg>',e.append(n),e.addEventListener("click",(()=>{t.classList.remove("MimotoTheme_DevToolsService_highlight_element_containing_hint"),window.Mimoto.log(t)})),e.addEventListener("mouseover",(()=>{e.classList.add("MimotoTheme_DevToolsService_panel_hint_hover"),t.classList.add("MimotoTheme_DevToolsService_highlight_element_containing_hint")})),e.addEventListener("mouseout",(()=>{e.classList.remove("MimotoTheme_DevToolsService_panel_hint_hover"),t.classList.remove("MimotoTheme_DevToolsService_highlight_element_containing_hint")})),this._elPanel.querySelector('[data-mimoto-id="MimotoAdminPanel-hints-header"]').classList.add("MimotoTheme_DevToolsService_panel_block_title_visible"),this._elPanel.querySelector('[data-mimoto-id="MimotoAdminPanel-hints"]').append(e)},log:function(t){if(!this._validateAndSetupAdmin())return;this.show();let e=document.createElement("a");e.setAttribute("class","MimotoTheme_DevToolsService_panel_log"),e.innerHTML=t,this._elPanel.querySelector('[data-mimoto-id="MimotoAdminPanel-logs-header"]').classList.add("MimotoTheme_DevToolsService_panel_block_title_visible"),this._elPanel.querySelector('[data-mimoto-id="MimotoAdminPanel-logs"]').append(e),Mimoto.error(t)},xray:function(t){if(!this._validateAndSetupAdmin())return;this.show();let e=document.createElement("a");e.setAttribute("class","MimotoTheme_DevToolsService_panel_hint");let i=document.createElement("div");i.setAttribute("class","MimotoTheme_DevToolsService_panel_hint_content"),i.innerHTML=t.node.id,e.append(i);let o=document.createElement("div");o.setAttribute("class","MimotoTheme_DevToolsService_panel_hint_icon"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 98.48 98.48" xml:space="preserve"><path d="M97.204,45.788c-0.865-1.02-21.537-24.945-47.963-24.945c-26.427,0-47.098,23.925-47.965,24.946c-1.701,2-1.701,4.902,0.001,6.904c0.866,1.02,21.537,24.944,47.964,24.944c26.426,0,47.098-23.926,47.964-24.946C98.906,50.691,98.906,47.789,97.204,45.788z M57.313,35.215c1.777-0.97,4.255,0.143,5.534,2.485c1.279,2.343,0.875,5.029-0.902,5.999c-1.776,0.971-4.255-0.143-5.535-2.485C55.132,38.871,55.535,36.185,57.313,35.215z M49.241,68.969c-18.46,0-33.995-14.177-39.372-19.729c3.631-3.75,11.898-11.429,22.567-16.021c-2.081,3.166-3.301,6.949-3.301,11.021c0,11.104,9.001,20.105,20.105,20.105s20.106-9.001,20.106-20.105c0-4.072-1.219-7.855-3.3-11.021C76.715,37.812,84.981,45.49,88.612,49.24C83.235,54.795,67.7,68.969,49.241,68.969z"/></svg>',e.append(o),e.addEventListener("click",(()=>{t.node.elNode.classList.remove("MimotoTheme_DevToolsService_highlight_element_containing_hint"),window.Mimoto.log(""),window.Mimoto.group('%cü©ª X-ray of "'+t.node.id+'"',"font-weight:bold; font-size: 20px;"),window.Mimoto.log(""),window.Mimoto.log("Element =",t.node.elNode),window.Mimoto.log("This node`s vars =",t.node.getVars()),window.Mimoto.log("This node =",t.node.xray()),window.Mimoto.log("Root node =",t.node.getRoot().xray()),window.Mimoto.log(""),window.Mimoto.log(""),window.Mimoto.groupEnd()})),e.addEventListener("mouseover",(()=>{e.classList.add("MimotoTheme_DevToolsService_panel_hint_hover"),t.node.elNode.classList.add("MimotoTheme_DevToolsService_highlight_element_containing_hint")})),e.addEventListener("mouseout",(()=>{e.classList.remove("MimotoTheme_DevToolsService_panel_hint_hover"),t.node.elNode.classList.remove("MimotoTheme_DevToolsService_highlight_element_containing_hint")})),this._elPanel.querySelector('[data-mimoto-id="MimotoAdminPanel-xrays-header"]').classList.add("MimotoTheme_DevToolsService_panel_block_title_visible"),this._elPanel.querySelector('[data-mimoto-id="MimotoAdminPanel-xrays"]').append(e)},_onUserIsAdmin:function(t){this._validateAndSetupAdmin()},_onUserSignedOut:function(t){},_validateAndSetupAdmin:function(){return!(!window.Mimoto.user.isAdmin()&&!window.Mimoto.config.isAdmin)&&(null!==this._elStyle||(this._elStyle=this._createCSS(),document.head.appendChild(this._elStyle)),!0)},_createCSS:function(){let t=document.createElement("style");return t.setAttribute(o.DATA_MIMOTO_STATUS,"üçÑ"),t.innerHTML="div.MimotoTheme_DevToolsService_panel_container {position: fixed;top: 0;bottom: 0;right: 0;width: 100%;max-width: 400px;z-index: 9999;}div.MimotoTheme_DevToolsService_panel {display: flex;flex-direction: column;align-items: stretch;position: absolute;top: 0;bottom: 0;left: 300px;transition: left 0.3s ease-out;width: 100%;max-width: 400px;overflow: scroll;background-color: #f5f5f5;min-height: 100vh;border-left: 1px solid #cccccc;box-shadow: inset 10px 0 5px -10px #00000033;}div.MimotoTheme_DevToolsService_panel.MimotoTheme_DevToolsService_panel_visible {left: 0;}div.MimotoTheme_DevToolsService_panel_header {flex: none;display: flex;flex-direction: row;align-items: center;justify-content: center;padding: 15px 30px 15px 18px;}div.MimotoTheme_DevToolsService_panel_header_title {flex: auto;font-size: 24px;font-weight: normal;}span.MimotoTheme_DevToolsService_panel_header_subtitle {font-weight: bold;}div.MimotoTheme_DevToolsService_panel_header_logo {flex: none;width: 50px;cursor: pointer;}div.MimotoTheme_DevToolsService_panel_content {flex: auto;overflow: hidden;padding: 15px;}div.MimotoTheme_DevToolsService_panel_block {display: block;margin-bottom: 20px;}div.MimotoTheme_DevToolsService_panel_block_title {margin-bottom: 10px;display: none;}div.MimotoTheme_DevToolsService_panel_block_title_visible {display: block;}div.MimotoTheme_DevToolsService_panel_block {display: block;margin-bottom: 20px;}div.MimotoTheme_DevToolsService_panel_block > a {margin-bottom: 3px;}div.MimotoTheme_DevToolsService_panel_block > a:last-child {margin-bottom: 0;}a.MimotoTheme_DevToolsService_panel_hint, a.MimotoTheme_DevToolsService_panel_log {background-color: #ffffff;border-radius: 5px;font-size: 14px;padding: 7px 10px;cursor: pointer;display: flex;flex-direction: row;gap: 10px;align-items: center;}div.MimotoTheme_DevToolsService_panel_hint_content, div.MimotoTheme_DevToolsService_panel_log_content {flex: auto;}div.MimotoTheme_DevToolsService_panel_hint_icon, div.MimotoTheme_DevToolsService_panel_log_icon {flex: none;width: 20px;opacity: 0.25;margin: 5px 5px 0 0;visibility: hidden;}.MimotoTheme_DevToolsService_panel_hint_hover div.MimotoTheme_DevToolsService_panel_hint_icon, .MimotoTheme_DevToolsService_panel_hint_hover div.MimotoTheme_DevToolsService_panel_log_icon {visibility: visible;}.MimotoTheme_DevToolsService_highlight_element_containing_hint {opacity: 0.5;border-radius: 0;border: 1px solid #000000;}div.MimotoTheme_DevToolsService_panel_footer {flex: none;align-self: stretch;position: relative;margin-top: auto;font-size: 14px;padding: 10px;}div.MimotoTheme_DevToolsService_panel_footer_content {display: none;padding: 10px;border-radius: 10px;background-color: #ffff00;}div.MimotoTheme_DevToolsService_panel_footer_content_visible {display: block;}div.MimotoTheme_DevToolsService_panel_footer_content_license {background-color: transparent;color: #858585;font-style: italic;}div.MimotoTheme_DevToolsService_panel_footer a  {text-decoration: underline;font-weight: bold;color: #000000;}div.MimotoTheme_DevToolsService_panel_footer a:hover  {color: #858585;}",t}}},707:(t,e,i)=>{"use strict";const o=i(109),n=i(310);t.exports=function(){this.__construct()},t.exports.prototype={__construct:function(){},makeEventDispatcher:function(t){new o(t)},makeView:function(t,e,i){return new n(t,e,i)}}},980:(t,e,i)=>{"use strict";const o=i(948),n=i(749),s=i(752);t.exports=function(t){this._aTemplates=[],this._aHTMLTemplates=[],this.__construct(t)},t.exports.prototype={__construct:function(t,e){window.Mimoto.extender.makeEventDispatcher(this)},addTemplate:function(t,e){this._aTemplates[t]=e},getTemplate:function(t){return this._aTemplates[t]||""},hasTemplate:function(t){return void 0!==this._aTemplates[t]},preloadTemplates:function(t){return new Promise(((e,i)=>{let s=[];for(let e in t){let r=t[e],a=this.loadHTML(r);s.push(a),a.then((t=>{let i=n.buildInstanceFromTemplate(t);!1!==i&&o.verifyFormat(e)&&this.addTemplate(e,i)})).catch((t=>i(t)))}Promise.all(s).then((()=>e())).catch((t=>i(t)))}))},createViewFromTemplate:function(t,e=null){let i={},n=o.verifyFormat(t)?this.getTemplate(t):t;return"function"==typeof n?i=new n:(n||(n=document.createElement("div"),s.addHint(n,"Template '"+t+"' not found")),window.Mimoto.extender.makeView(i,n,e)),i},createElementFromTemplate:function(t){let e=this.getTemplate(t),i=document.createElement("div");return i.innerHTML=e,i.children[0]},loadHTML:function(t){return new Promise(((e,i)=>{if(void 0!==this._aHTMLTemplates[t])return void e(this._aHTMLTemplates[t]);let o=new XMLHttpRequest;o.onreadystatechange=function(n){4===o.readyState&&(200===o.status?(this._aHTMLTemplates[t]=o.responseText,e(o.responseText)):i("File '"+t+"' not found"))}.bind(this),o.open("GET",t,!0),o.setRequestHeader("Content-type","text/html"),o.send()}))}}},978:(t,e,i)=>{"use strict";const o=i(948),n=i(752),s=i(104);t.exports=function(t){this.public={},this.private={},this.errors={},this.__construct(t)},t.exports.prototype={_aPublicRoutes:{},_aPrivateRoutes:{},_aErrorRoutes:{},_mode:null,_root:"/",_currentPage:null,_routeRequest:null,_currentRouteID:null,_contentClassRoot:null,_elContentTarget:document.body,_sRoute_onSignedUp:null,_sRoute_onSignedIn:null,_sRoute_onSignedOut:null,_aRegisteredButtons:[],NAVIGATED:"NAVIGATED",__construct:function(t){window.Mimoto.extender.makeEventDispatcher(this),window.addEventListener("locationchange",this._onLocationChanged.bind(this)),window.addEventListener("popstate",(()=>{window.dispatchEvent(new Event("locationchange"))})),this.public.addRoute=(t,e,i={})=>{this._aPublicRoutes[t]={id:"route-"+s.process().toUpperCase(),xTemplate:e,oSettings:i},void 0===this._aPrivateRoutes[t]&&(this._aPrivateRoutes[t]=this._aPublicRoutes[t])},this.private.addRoute=(t,e,i={})=>{this._aPrivateRoutes[t]={id:"route-"+s.process().toUpperCase(),xTemplate:e,oSettings:i,bRequiresAuthentication:!0}},this.errors.addRoute=(t,e,i={})=>{this._aErrorRoutes[t]={id:"route-"+s.process().toUpperCase(),xTemplate:e,oSettings:i}}},__start:function(){window.Mimoto.user.addEventListener(window.Mimoto.user.SIGNED_IN,this._onUserSignedIn.bind(this)),window.Mimoto.user.addEventListener(window.Mimoto.user.SIGNED_OUT,this._onUserSignedOut.bind(this))},setContentTarget:function(t,e){e&&(this._contentClassRoot=e),"string"!=typeof t?t instanceof HTMLElement&&(this._elContentTarget=t):this._elContentTarget=t},setRouteOnSignedUp:function(t){this._sRoute_onSignedUp=t},setRouteOnSignedIn:function(t){this._sRoute_onSignedIn=t},setRouteOnSignedOut:function(t){this._sRoute_onSignedOut=t},goto:function(t="/",e="_self"){if("_blank"===e.toLowerCase())return void window.open(t,"_blank");if(!1===e)return void window.open(t);let i=t.indexOf("#"),o=-1!==i?t.substring(i):"";if((t=-1!==i?t.substring(0,i):t)||(t=window.location.pathname),void 0===window.Mimoto.config?.firebase||!1===window.Mimoto.config?.firebase||!window.Mimoto.firebase.auth||window.Mimoto.user.isReady()){if(this._routeRequest=this.___getCurrentRoute(t),!1===this._routeRequest){if(void 0===this._aErrorRoutes[404])return this.___getCurrentRoute("/")?(this.setPath("/"),void this.goto("/")):void Mimoto.devtools.log("404 - No page for / path");this._routeRequest={route:this._aErrorRoutes[404],vars:{}}}this._routeRequest.path=t,this._goto(this._routeRequest,o)}},getCurrentPath:function(){return window.location.pathname+window.location.hash},setPath:function(t,e=null,i=null){null!==e&&(document.title=e),window.Mimoto.config.isApp||window.history.pushState(null!==i?i:null,null!==e?e:null,t)},getPathVariables:function(t){let e=o.clone(this._requestVars);return t?e[t]:e},hasContentClassRoot:function(){return null!==this._contentClassRoot},initDefaultContentClassRoot:function(){this._contentClassRoot={},window.Mimoto.extender.makeView(this._contentClassRoot,document.body)},_onUserSignedIn:function(){},_onUserSignedOut:function(){(this.___checkIfRouteExists()||this.___doesCurrentPageNeedAuthentication())&&this.___getRouteOnSignedOut()?this.goto(this.___getRouteOnSignedOut()):this.goto(this.getCurrentPath(),"After authentication - User is signed out")},_goto:function(t,e=""){if(t.route.id===this._currentRoute?.route.id&&t.path===this._currentRoute?.path)return void this._positionPage(e);if(t.route.bRequiresAuthentication){if(!window.Mimoto.user.isSignedIn())return void window.Mimoto.user.signIn(window.Mimoto.user.GOOGLE);t.route.oSettings?.claims&&(this._validateClaims(Array.isArray(t.route.oSettings.claims)?t.route.oSettings.claims:[t.route.oSettings.claims])||this._aErrorRoutes[403]&&(t={route:this._aErrorRoutes[403],path:t.path,vars:{}}))}this.setPath(t.path+e,t.route?.oSettings.title),this._currentPage&&this._currentPage.discard&&this._currentPage.discard(),this._requestVars=t.vars?this._requestVars=t.vars:{},this._requestVars=o.mergeDeep(t.route.oSettings?.vars||{},this._requestVars),this._createPage(t.route.xTemplate).then((i=>{this._currentPage=i,this.hasContentClassRoot()||this.initDefaultContentClassRoot();setTimeout((()=>{"string"==typeof this._elContentTarget&&(this._elContentTarget=document.querySelector('[data-mimoto-id="'+this._elContentTarget+'"]'));let i=window.Mimoto.config?.default?.globalVars||{};t.route.oSettings.globalVars&&(i=o.mergeDeep(i,t.route.oSettings.globalVars)),(i||Object.keys(this._requestVars).length>0)&&window.Mimoto.ui.setGlobalVars(o.mergeDeep(i||{},this._requestVars||{})),this._contentClassRoot.Mimoto.ui.refillWithView(this._currentPage,this._elContentTarget.getAttribute(n.DATA_MIMOTO_ID),{vars:this._requestVars}),this._currentRoute=t,this._currentRouteID=t.route.id,this._positionPage(e),this.dispatchEvent(this.NAVIGATED)}),0)})).catch((t=>window.Mimoto.devtools.log(t)))},_positionPage:function(t=""){if(""!==t){let e=document.getElementById(t.substring(1));if(e)return void e.scrollIntoView()}window.scrollTo(0,0),this._elContentTarget.scrollTop=0},_createPage:function(t){return new Promise(((e,i)=>{if("string"!=typeof t)return e(new t);let o={};if(/<\/?[a-z][\s\S]*>/i.test(t))return window.Mimoto.extender.makeView(o,t),e(o);if(window.Mimoto.layout.hasTemplate(t))t=window.Mimoto.layout.getTemplate(t);else{if(".html"===t.trim().substring(t.length-5).toLowerCase()){return void window.Mimoto.layout.loadHTML(t).then((i=>{t=i,window.Mimoto.extender.makeView(o,t),e(o)})).catch((t=>i(t)))}{let e=document.createElement("div");n.addHint(e,"Template '"+t+"' not found"),t=e}}return window.Mimoto.extender.makeView(o,t),e(o)}))},_onLocationChanged:function(){this.goto(this.getCurrentPath())},___getRouteOnSignedUp:function(){return this._sRoute_onSignedUp||window.location.pathname},___getRouteOnSignedIn:function(){return this._sRoute_onSignedIn||window.location.pathname},___getRouteOnSignedOut:function(){return this._sRoute_onSignedOut||window.location.pathname},___checkIfRouteExists:function(){return!1!==this.___getCurrentRoute(this.___addSlashToPathEnd(window.location.pathname))},___doesCurrentPageNeedAuthentication:function(){let t=this.___getCurrentRoute(this.___addSlashToPathEnd(window.location.pathname));return!1!==t&&t.route.bRequiresAuthentication},___getCurrentRoute:function(t){let e=!1;t=this.___addSlashToPathEnd(t);let i=window.Mimoto.user.isSignedIn()?this._aPrivateRoutes:this._aPublicRoutes;for(let o in i){let n=i[o];const s=/{{\s*([a-zA-Z][a-zA-Z0-9]*)\s*}}/g,r=o.match(s);let a="";o=this.___addSlashToPathEnd(o);let l=o,u={};if(Array.isArray(r)&&r.length>0){let e=[];for(let t=0;t<r.length;t++){let i=r[t],n=o.indexOf(i),s=o.substring(0,n);e.push(s),o=o.substring(s.length+i.length),t===r.length-1&&o.length>0&&e.push(o)}let i=t;for(let o=0;o<e.length;o++){let n=e[o];if(a+=n,t.substring(0,a.length)!==a)break;if(i=i.substring(n.length),o<e.length-1){let t=r[o];t=t.substring(2,t.length-2).trim();let n=e[o+1],s=i.indexOf(n),l=i.substring(0,s);u[t]=l,a+=l,i=i.substring(l.length)}}}else a=l;if(a===t){e={route:n,vars:u||{}};break}}return e},___addSlashToPathEnd:function(t){return t.endsWith("/")||(t+="/"),t},_validateClaims:function(t){return t.some((t=>Array.isArray(t)?this._validateClaims(t):"object"==typeof t&&o.compareValuesInObjects(t,window.Mimoto.user.getClaims())))}}},858:t=>{"use strict";t.exports=function(t){this.__construct(t)},t.exports.prototype={__construct:function(t,e){window.Mimoto.extender.makeEventDispatcher(this)},getPreferredLanguage:function(){return navigator.language}}},361:(t,e,i)=>{"use strict";const o=i(948),n=i(752),s=i(104);t.exports=function(t){this._aGlobalVars={},this._aAllComponents={},this._aAllContainers={},this._bIsTabDown=!1,this.states={},this.__construct(t)},t.exports.prototype={isTabDown:function(){return this._bIsTabDown},__construct:function(t){window.Mimoto.extender.makeEventDispatcher(this),this._addCoreStyles(),document.addEventListener("keydown",(t=>{"Tab"===t.key&&(this._bIsTabDown=!0)})),document.addEventListener("keyup",(t=>{"Tab"===t.key&&(this._bIsTabDown=!1)}))},setGlobalVar:function(t,e){this._setVar(t,e)},getGlobalVar:function(t){return this._aGlobalVars[t]},setGlobalVars:function(t){this._setVar(t,void 0)},getGlobalVars:function(){return o.clone(this._aGlobalVars)},___registerView:function(t){if(this._aAllComponents[t.Mimoto.ui.getViewID()]=t,t.Mimoto.ui.setVars(this._aGlobalVars,!1,!0),!window.Mimoto.data.isEmpty(this.states))for(let e in this.states)this._broadcastState(e),e===n.CONSTANT_STATE_SIGNED_IN&&this._broadcastEvent(n.CONSTANT_EVENT_SIGNED_IN,t),e===n.CONSTANT_STATE_SIGNED_OUT&&this._broadcastEvent(n.CONSTANT_EVENT_SIGNED_OUT,t)},___unregisterView:function(t){delete this._aAllComponents[t.Mimoto.ui.getViewID()]},___registerContainer:function(t){let e="MimotoContainer."+s.process().toUpperCase();t.node.elNode.setAttribute(n.DATA_MIMOTO_CONTAINERID,e),this._aAllContainers[e]=t},___getContainer:function(t){return this._aAllContainers[t]},___getAllContainers:function(){return this._aAllContainers},___unregisterContainer:function(t){delete this._aAllContainers[t]},___setState:function(t){this.states[t]=!0,this._broadcastState(t)},___unsetState:function(t){delete this.states[t],this._broadcastState(t,!0)},_broadcastState:function(t,e=!1){let i=e?"unsetState":"setState";for(let e in this._aAllComponents)this._aAllComponents[e].internal.getNodeTree()[i](t,!0)},_broadcastEvent:function(t,e=void 0){(e?[e]:Object.values(this._aAllComponents)).forEach((e=>{e.internal.getNodeTree().findNodesByInstructionType(n.DATA_MIMOTO_EVENT,void 0,!0).forEach((e=>e.api.dispatchEvent(t)))}))},_setVar:function(t,e){let i={};"object"==typeof t&&void 0===e?i=t:i[t]=e;let o=null;for(let t in i)this._aGlobalVars[t]!==i[t]&&(this._aGlobalVars[t]=i[t],null===o&&(o={}),o[t]=i[t]);if(null!==o)for(let t in this._aAllComponents)this._aAllComponents[t].Mimoto.ui.setVars(o,!0,!0)},_addCoreStyles:function(){let t=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");t.appendChild(e),e.appendChild(document.createTextNode(".Mimoto_InvisibleCaret { caret-color: transparent; } .Mimoto_SortHandle--ghost { visibility: hidden; } .Mimoto_SortHandle--dragging { cursor: grabbing; } "))}}},166:(t,e,i)=>{"use strict";const o=i(752),n=i(948);t.exports=function(){this.__construct()},t.exports.SIGNED_IN="SIGNED_IN",t.exports.SIGNED_OUT="SIGNED_OUT",t.exports.USER_IS_ADMIN="USER_IS_ADMIN",t.exports.USER_IS_NOT_ADMIN="USER_IS_NOT_ADMIN",t.exports.prototype={_firebaseAuth:null,_user:null,_userSettings:null,_bIsNewUser:null,_bIsAdmin:!1,_aClaims:{},_credentials:{},_bIsReady:!1,_bIsSignedIn:null,READY:"READY",SIGNED_IN:t.exports.SIGNED_IN,SIGNED_OUT:t.exports.SIGNED_OUT,USER_IS_ADMIN:t.exports.USER_IS_ADMIN,USER_IS_NOT_ADMIN:t.exports.USER_IS_NOT_ADMIN,GOOGLE:"GOOGLE",isReady:function(){return this._bIsReady},isSignedIn:function(){return this._bIsSignedIn},isSignedOut:function(){return!this._bIsSignedIn},getId:function(){return this._user?.uid},getDisplayName:function(){return this._user?.displayName||""},getEmail:function(){return this._user?.email||""},getPhotoURL:function(){return this._user?this._user.photoURL:""},hasEmailVerified:function(){return this._user?.emailVerified},hasUserSettings:function(){return null!==this._userSettings},getUserSettings:function(){return this._userSettings},isAdmin:function(){return this._bIsAdmin},getClaim:function(t){const e=function(t,i){let o=i.split("."),s=o.shift(),r=o.join(".");return o.length>0&&(n.isObject(t[s])||Array.isArray(t[s]))?e(t[s],r):t[i]};return e(this._aClaims,t)},getClaims:function(){return this._aClaims},getUserData:function(){return this._user},__construct:function(){window.Mimoto.extender.makeEventDispatcher(this),this.internal={},this.internal.publicAPI={SIGNIN:"signIn",SIGNOUT:"signOut",GETCLAIM:"getClaim",GETCLAIMS:"getClaims"}},__start:async function(t){this._firebaseAuth=t.firebaseAuth,this._firebaseAuthModules=t.firebaseAuthModules,this._authentication=t.authentication,window.Mimoto.isInEmulatorMode()&&window.Mimoto.config?.firebaseEmulatorConfig.auth&&this._firebaseAuthModules.connectAuthEmulator(this._firebaseAuth,window.Mimoto.config?.firebaseEmulatorConfig.auth),this._firebaseAuthModules.onAuthStateChanged(this._firebaseAuth,this._onAuthStateChanged.bind(this)),window.Mimoto.config?.auth?.events?.onAccessToken&&"function"==typeof window.Mimoto.config?.auth.events.onAccessToken&&this._firebaseAuthModules.getRedirectResult(this._firebaseAuth).then((t=>{t?._tokenResponse.oauthAccessToken&&window.Mimoto.config?.auth.events.onAccessToken(t._tokenResponse.oauthAccessToken)}))},signIn:async function(t="",e=!1){let i=this;return new Promise(((o,s)=>{if(t.toUpperCase()===this.GOOGLE){let t=new this._firebaseAuthModules.GoogleAuthProvider;if(t.addScope("profile"),t.addScope("email"),window.Mimoto.config?.auth?.providers?.google?.scopes&&Array.isArray(window.Mimoto.config?.auth.providers.google.scopes)&&window.Mimoto.config.auth.providers.google.scopes.forEach((e=>t.addScope(e))),!0===e)this._firebaseAuthModules.signInWithPopup(this._firebaseAuth,t).then((async t=>{if(i._bIsNewUser=this._firebaseAuthModules.getAdditionalUserInfo(t).isNewUser,window.Mimoto.config?.auth.events.onAccessToken&&"function"==typeof window.Mimoto.config?.auth.events.onAccessToken){const e=this._firebaseAuthModules.GoogleAuthProvider.credentialFromResult(t).accessToken,i=t.user?.proactiveRefresh?.user?.stsTokenManager?.refreshToken;let r=window.Mimoto.config?.auth.events.onAccessToken(e,i);n.isPromise(r)?r.then((t=>{o(t)})).error((t=>{s(t)})):o("AAA")}else o("BBB")})).catch((t=>{}));else{this._firebaseAuthModules.signInWithRedirect(this._firebaseAuth,t).then((t=>{Mimoto.log("SIGNIN RESULT - ",t);const e=t.credential,i=e.accessToken;Mimoto.log("üî•REDIRECT - credential =",e,", accessToken =",i)})).catch((t=>{Mimoto.log("SIGNIN ERROR - ",t)}))}}else window.console&&Mimoto.log("Please provide a supported authentication provider",'Currently supported: "'+this.GOOGLE+'"')}))},signOut:function(){return new Promise(((t,e)=>{this._firebaseAuthModules.signOut(this._firebaseAuth).then((()=>t())).catch((t=>e()))}))},_onAuthStateChanged:async function(e){setTimeout((async()=>{this._user=e;const i={};if(i[o.CONSTANT_USER_ID]=window.Mimoto.user.getId(),i[o.CONSTANT_USER_ISVERIFIED]=window.Mimoto.user.hasEmailVerified(),i[o.CONSTANT_USER_DISPLAYNAME]=window.Mimoto.user.getDisplayName(),i[o.CONSTANT_USER_AVATAR]=window.Mimoto.user.getPhotoURL(),i[o.CONSTANT_USER_EMAIL]=window.Mimoto.user.getEmail(),window.Mimoto.ui.setGlobalVars(i),this._bIsReady=!0,this._user){this._bIsSignedIn=!0;const t=await this._firebaseAuthModules.getIdTokenResult(this._user);if(this._aClaims=t.claims,window.Mimoto.config?.auth?.events?.onAuthStateChanged&&"function"==typeof window.Mimoto.config?.auth.events.onAuthStateChanged&&window.Mimoto.config?.auth.events.onAuthStateChanged(this._aClaims),this._loadUserSettings(),window.Mimoto.config?.permissionsNotifier&&"string"==typeof window.Mimoto.config.permissionsNotifier){const t=window.Mimoto.data.internal.realtimeDatabase("/"+window.Mimoto.config.permissionsNotifier+"/"+this.getId());window.Mimoto.data.internal.realtimeDatabaseModules().onValue(t,(async e=>{if(!e.exists())return;await window.Mimoto.data.internal.realtimeDatabaseModules().remove(t);const i=await window.Mimoto.firebase.auth.getAuth().currentUser.getIdTokenResult(!0);console.log("‚úÖ New claims:",i.claims),this._aClaims=i.claims,this._finishSignIn()}))}}else this._bIsSignedIn=!1,window.Mimoto.ui.___setState(o.CONSTANT_STATE_SIGNED_OUT),window.Mimoto.ui.___unsetState(o.CONSTANT_STATE_SIGNED_IN),window.Mimoto.ui._broadcastEvent(o.CONSTANT_EVENT_SIGNED_OUT),this.dispatchEvent(t.exports.SIGNED_OUT)}),1)},_loadUserSettings:function(){if(this._authentication&&this._authentication.userSettings){let t=window.Mimoto.user.getId();window.Mimoto.data.internal.realtimeDatabase(this._authentication.userSettings+"/"+t).on("value",(t=>{this._finishSignIn()}))}else this._finishSignIn()},_finishSignIn:function(){window.Mimoto.ui.___unsetState(o.CONSTANT_STATE_SIGNED_OUT),window.Mimoto.ui.___setState(o.CONSTANT_STATE_SIGNED_IN),window.Mimoto.navigation.goto(this._bIsNewUser?window.Mimoto.navigation.___getRouteOnSignedUp():window.Mimoto.navigation.getCurrentPath()),this._bIsNewUser&&(this._bIsNewUser=!1),window.Mimoto.ui._broadcastEvent(o.CONSTANT_EVENT_SIGNED_IN),this.dispatchEvent(t.exports.SIGNED_IN)}}},746:(t,e,i)=>{"use strict";const o=i(104);t.exports=class{_bInitialized=!1;_realtimes={};configure(t,e=null){e&&this.clear(e);const i=this;let n={id:o.process(),paths:[],dispatch:t=>i._dispatch(t,n)};this._realtimes[n.id]=n;for(let e in t){let i={query:e,events:{}};(t[e].connect||t[e].disconnect)&&(i.connect=t[e].connect,i.disconnect=t[e].disconnect);for(let o in t[e])"connect"!==o&&"disconnect"!==o&&(i.events[o]=t[e][o]);n.paths.push(i)}if(this._bInitialized)this._setupRealtimeData([n]);else{this._bInitialized=!0;let t=window.Mimoto.data.internal.realtimeDatabase(".info/connected");window.Mimoto.data.internal.realtimeDatabaseModules().onValue(t,(t=>{!1!==t.val()&&i._setupRealtimeData(Object.values(i._realtimes))}))}return n}clear(t){this._realtimes[t];delete this._realtimes[t]}_setupRealtimeData(t){const e=this;t.forEach((t=>{t.paths.forEach((t=>{let i=window.Mimoto.data.internal.realtimeDatabase(t.query);if(void 0!==t.disconnect){const o=null===t.disconnect?"set":"update";window.Mimoto.data.internal.realtimeDatabaseModules().onDisconnect(i)[o](t.disconnect).then((()=>e._handleConnect(i,t.connect)))}else e._handleConnect(i,t.connect)}))}))}_handleConnect(t,e){const i=null===e?"set":"update";void 0!==e&&window.Mimoto.data.internal.realtimeDatabaseModules()[i](t,e)}_dispatch(t,e){e.paths.forEach((e=>{if(void 0===e.events[t])return;let i=window.Mimoto.data.internal.realtimeDatabase(e.query);window.Mimoto.data.internal.realtimeDatabaseModules().update(i,e.events[t])}))}}},697:(t,e,i)=>{"use strict";const o=i(948),n=i(671),s=(i(752),i(104));t.exports=function(t,e={},i=!1){this._bHasFiredOnce=!1,this.__construct(t,e,i)},t.exports.TYPE="MimotoDocument",t.exports.TYPE_FORM="MimotoForm",t.exports.DATA="MimotoDocument.DATA",t.exports.DATA_INIT="MimotoDocument.DATA_INIT",t.exports.KEY="MimotoDocument.KEY",t.exports.LOADED="MimotoDocument.LOADED",t.exports.CREATED="MimotoDocument.CREATED",t.exports.CHANGED="MimotoDocument.CHANGED",t.exports.STORING="MimotoDocument.STORING",t.exports.STORED="MimotoDocument.STORED",t.exports.DELETED="MimotoDocument.DELETED",t.exports.AUTOSAVED="MimotoDocument.AUTOSAVED",t.exports.ERROR="MimotoDocument.ERROR",t.exports.FILE_STORED="MimotoDocument.FILE_STORED",t.exports.FILE_PROGRESS="MimotoDocument.FILE_PROGRESS",t.exports.prototype={_documentID:"MimotoDocument."+s.process().toUpperCase(),_sDataQuery:null,_sDataQueryRoot:null,_sDataKey:null,_listeners:{},_settings:null,_dataValueStored:null,_dataValueCurrent:null,_changedValues:null,_bAutoSaveEnabled:!0,_timerAutoSave:null,_timerAutoSaveDelay:1200,_aChanges:[],_bIsNew:!1,_bIsStoring:!1,_firebaseStorage:null,getKey:function(){return this._sDataKey},getPath:function(){return this._sDataQuery.substring(0,this._sDataQuery.lastIndexOf("/"))},getQuery:function(){return this._sDataQuery},getValue:function(t){let e=o.clone(this._dataValueCurrent);return e&&t?e[t]:e},setValue:function(t){this._dataValueCurrent=t},updateValue:function(e){this._changedValues=this._updateValues(e,this._changedValues||{}),this._dataValueCurrent=this._updateValues(e,this._dataValueCurrent||{}),this.dispatchEvent(t.exports.DATA,this.getValue())},hasChanges:function(){return null!==this._changedValues},isStoring:function(){return this._bIsStoring},__construct:function(t,e={},i=!1){window.Mimoto.extender.makeEventDispatcher(this),this._storeSettings(t,e,i),void 0!==e.id&&(this._documentID=e.id)},markAsNew:function(){this._bIsNew=!0},load:async function(){if(!this._sDataQuery||"*"===this._sDataQuery.substring(0,1))return;const t=i(752);switch(this._settings.db){case t.CONSTANT_LOCAL:window.Mimoto.data.internal.loadLocalData(this._sDataQuery,this._onValue.bind(this),this._onError.bind(this));break;case t.CONSTANT_REALTIME:default:if(this._settings.find&&o.isObject(this._settings.find)&&1===Object.keys(this._settings.find).length){const t=window.Mimoto.data.internal.realtimeDatabase(this._sDataQuery),e=window.Mimoto.data.internal.realtimeDatabaseModules().query,i=window.Mimoto.data.internal.realtimeDatabaseModules().orderByChild,o=window.Mimoto.data.internal.realtimeDatabaseModules().equalTo,n=window.Mimoto.data.internal.realtimeDatabaseModules().limitToFirst,s=window.Mimoto.data.internal.realtimeDatabaseModules().get,r=Object.keys(this._settings.find)[0],a=this._settings.find[r],l=e(t,i(r),o(a),n(1)),u=await s(l);if(!u.exists())return void this._onError(this._sDataQuery+"/"+r+' = "'+a+'" not found!');{const t=u.val();this._sDataQuery+="/"+Object.keys(t)[0]}}const e=window.Mimoto.data.internal.realtimeDatabase(this._sDataQuery);this._listeners[this._sDataQuery]=window.Mimoto.data.internal.realtimeDatabaseModules().onValue(e,this._onValue.bind(this))}},reload:function(t,e={},i=!1){this._storeSettings(t,e,i),this.load()},redispatchInitEvent:function(){this._bHasFiredOnce&&this.dispatchEvent(t.exports.DATA_INIT,this.getValue())},_onValue:function(e){let i=!1;if(this._settings.orderByChild&&this._settings.equalTo){let t=e.val();for(let e in t){i=this._sDataKey!==e,this._sDataKey=e,this._dataValueStored=t[e],this._dataValueCurrent=o.clone(this._dataValueStored),this._sDataQuery+="/"+this._sDataKey;break}}else i=this._sDataKey!==e.key,this._sDataKey=e.key,this._dataValueStored=e.val(),this._dataValueCurrent=o.clone(this._dataValueStored),this._changedValues=null;null===this._dataValueStored?this._onError(this._sDataQuery+" not found!"):(Mimoto.log(""),i&&this.dispatchEvent(t.exports.KEY,this._sDataKey),this.dispatchEvent(t.exports.DATA,this.getValue()),this._bHasFiredOnce||(this._bHasFiredOnce=!0,this.dispatchEvent(t.exports.DATA_INIT,this.getValue())))},_onError:function(e){this.dispatchEvent(t.exports.ERROR,e)},update:function(e,n){null===this._dataValueCurrent&&(this._dataValueCurrent={}),this._changedValues=this._updateValues(e,this._changedValues||{}),this._dataValueCurrent=this._updateValues(e,this._dataValueCurrent||{}),n&&!0===n.skipUpdateEvent||this.dispatchEvent(t.exports.CHANGED,this.getValue());const s=i(752);switch(this._settings.db||(this._settings.db=""),this._settings.db.toUpperCase()){case s.CONSTANT_LOCAL:window.Mimoto.data.internal.updateLocalData(this._sDataQuery,o.clone(this._dataValueCurrent));break;case s.CONSTANT_REALTIME:default:!n||!1!==n.instantSave&&!0!==n.dontStore?this.store(n):this._bAutoSaveEnabled&&!n.dontStore&&this._setAutoSaveTimer()}},store:async function(e={}){this.dispatchEvent(t.exports.STORING,this.getValue());let n=o.removeUndefinedProperties(o.clone(this._changedValues));if(!this._sDataQuery)return this._dataValueStored=n,void this.dispatchEvent(t.exports.DATA,this.getValue());const s=i(752);switch(this._settings.db){case s.CONSTANT_LOCAL:break;case s.CONSTANT_REALTIME:default:if(!0===e.passiveUpdate)return void this.dispatchEvent(t.exports.DATA,this.getValue());window.Mimoto.data.internal.realtimeDatabaseModules().update(window.Mimoto.data.internal.realtimeDatabase(e.query?e.query:this._sDataQuery),n).then((()=>{this._dataValueStored=o.mergeDeep(this._dataValueStored,n),this._changedValues=null,this.dispatchEvent(t.exports.DATA,this.getValue())}))}},delete:function(e={}){return new Promise(((i,o)=>{let n=e.query&&"string"==typeof e.query&&e.query.length>0?e.query:this._sDataQuery;window.Mimoto.data.internal.registerDocumentDeletionInitiatedByThisUser(n);let s=this.getValue(),r=n.lastIndexOf("/");r>-1&&n.substring(0,r),r>-1&&n.substring(r+1);window.Mimoto.data.internal.realtimeDatabaseModules().remove(window.Mimoto.data.internal.realtimeDatabase(this._settings.query?this._settings.query:this._sDataQuery)).then((()=>{i(),this.dispatchEvent(t.exports.DELETED,s)})).catch((t=>o(t)))}))},upload:function(t,e={}){return new Promise(((i,s)=>{let r=document.createElement("input");r.setAttribute("type","file"),"object"==typeof e&&e.accept&&r.setAttribute("accept",e.accept),r.addEventListener("input",(async r=>{if(0===r.target.files.length)return void s("No file provided");if("object"==typeof e&&e.elPreview&&"img"===e.elPreview.tagName.toLowerCase()){const t=new FileReader;t.addEventListener("loadend",(()=>e.elPreview.src=t.result)),t.readAsDataURL(r.target.files[0])}let a=await n.storeFile(r.target.files[0],e.path?e.path:this._sDataQuery+"/"+t.replace(".","/")),l=o.setDeepValue(t,a,{});await window.Mimoto.data.internal.realtimeDatabaseModules().update(window.Mimoto.data.internal.realtimeDatabase(e.query?e.query:this._sDataQuery),l),i()})),r.click()}))},download:function(t,e={}){fetch(t).then((t=>t.blob())).then((i=>{const o=window.URL.createObjectURL(i),n=document.createElement("a");n.href=o,"object"===e&&e.name||(e.name=t.split("/o/")[1],e.name=e.name.split("?alt=media")[0],e.name=decodeURIComponent(e.name),e.name=e.name.substring(e.name.lastIndexOf(" ")+1)),n.download=e.name,n.click(),window.URL.revokeObjectURL(o)})).catch(console.error)},move:async function(t){const e=window.Mimoto.data.internal.realtimeDatabase(this._sDataQuery),i=window.Mimoto.data.internal.realtimeDatabase(t);try{const t=await window.Mimoto.data.internal.realtimeDatabaseModules().get(e);t.exists()?(await window.Mimoto.data.internal.realtimeDatabaseModules().set(i,t.val()),await window.Mimoto.data.internal.realtimeDatabaseModules().remove(e)):Mimoto.log("No data found at the old location")}catch(t){Mimoto.log("Error moving data:",t)}},_onAutoSaveTimerDone:function(){this._clearAutoSaveTimer(),this.hasChanges()&&this.store()},_setAutoSaveTimer:function(){this._clearAutoSaveTimer(),this._timerAutoSave=setTimeout(function(){this._onAutoSaveTimerDone()}.bind(this),this._timerAutoSaveDelay)},_clearAutoSaveTimer:function(){null!==this._timerAutoSave&&clearTimeout(this._timerAutoSave),this._timerAutoSave=null},_updateValues:function(t,e,n=null){const s=i(752);if(!o.isObject(t)||o.isObject(t)&&0===Object.keys(t).length)return null!==n?e[n]=t:e=t,null!==n?e[n]:e;for(let i in t)if(i.indexOf(".")>-1){let o=e[i.substring(0,i.indexOf("."))],r=i.substring(0,i.indexOf(".")),a=s.buildDeepValue(i.substring(i.indexOf(".")+1),t[i],void 0!==o?o:{});null!==n?e[n][r]=a:e[r]=a}else{null!==n&&void 0===e[n]&&(e[n]={});let o=this._updateValues(t[i],null!==n?e[n]:e,i);null!==n?e[n][i]=o:e[i]=o}return null!==n?e[n]:e},_storeSettings:function(t,e,i){this._sDataQuery=t,null!==t&&(this._sDataQueryRoot=t.lastIndexOf("/")>-1?t.substring(0,t.lastIndexOf("/")):null,this._sDataKey=t.lastIndexOf("/")>-1?t.substring(t.lastIndexOf("/")+1):null),this._bIsNew=!0===i,e?(this._settings=e,!1===this._settings.autoSave&&(this._bAutoSaveEnabled=!1)):this._settings={}}}},939:(t,e,i)=>{"use strict";const o=i(948),n=i(104);t.exports=function(t,e,i){this._sListQuery=null,this._listQueryOptions=null,this._dbListItems=null,this._bIsNew=!1,this._aItems=[],this.__construct(t,e)},t.exports.TYPE="MimotoList",t.exports.MIMOTO_LIST="MimotoList",t.exports.MIMOTO_LIST_ITEM="MimotoListItem",t.exports.ITEM_ADDED="MimotoList.ITEM_ADDED",t.exports.ITEM_CHANGED="MimotoList.ITEM_CHANGED",t.exports.ITEM_REMOVED="MimotoList.ITEM_REMOVED",t.exports.ITEMS_MOVED="MimotoList.ITEMS_MOVED",t.exports.prototype={getQuery:function(){return this._sListQuery},getItems:function(){return o.clone(this._aItems)},__construct:function(t,e,i){window.Mimoto.extender.makeEventDispatcher(this),this._sListQuery=t,this._bIsNew=!0===i,e&&(this._listQueryOptions=e,!0===this._listQueryOptions.autoSave&&(this._bAutoSaveEnabled=!0)),"*"!==this._sListQuery&&(this._dbListItems=window.Mimoto.data.internal.realtimeDatabase(this._sListQuery))},load:function(){if("*"!==this._sListQuery){let t=window.Mimoto.data.internal.realtimeDatabase(this._sListQuery),e=window.Mimoto.data.internal.realtimeDatabaseModules().query;if(this._listQueryOptions&&this._listQueryOptions.orderByChild){t=e(t,(0,window.Mimoto.data.internal.realtimeDatabaseModules().orderByChild)(this._listQueryOptions.orderByChild))}if(this._listQueryOptions&&this._listQueryOptions.equalTo){t=e(t,(0,window.Mimoto.data.internal.realtimeDatabaseModules().equalTo)(this._listQueryOptions.equalTo))}if(this._listQueryOptions&&this._listQueryOptions.limitToFirst&&!isNaN(this._listQueryOptions.limitToFirst)&&this._listQueryOptions.limitToFirst>0){t=e(t,(0,window.Mimoto.data.internal.realtimeDatabaseModules().limitToFirst)(this._listQueryOptions.limitToFirst))}window.Mimoto.data.internal.realtimeDatabaseModules().onChildAdded(t,this._onChildAdded.bind(this)),window.Mimoto.data.internal.realtimeDatabaseModules().onChildChanged(t,this._onChildChanged.bind(this)),window.Mimoto.data.internal.realtimeDatabaseModules().onChildRemoved(t,this._onChildRemoved.bind(this))}},reload:function(t,e){if(this._sListQuery=t,"*"!==this._sListQuery&&(this._dbListItems=window.Mimoto.data.internal.realtimeDatabase(this._sListQuery),this._listQueryOptions&&this._listQueryOptions.orderByChild&&this._listQueryOptions.equalTo)){let t=window.Mimoto.data.internal.realtimeDatabaseModules().query,e=window.Mimoto.data.internal.realtimeDatabaseModules().equalTo,i=window.Mimoto.data.internal.realtimeDatabaseModules().orderByChild;this._dbListItems=t(this._dbListItems,i(this._listQueryOptions.orderByChild),e(this._listQueryOptions.equalTo))}},add:function(t,e={}){let i=null,o=null;if(isNaN(e))for(let t in e){let n=e[t];null!==i||isNaN(n)?null===o&&"vars"===t&&(o=e[t]):i=n}else i=e;if("*"===this._sListQuery)return new Promise(((e,i)=>{let o="MimotoList_API_item_"+n.process().toUpperCase(),s=this._composeItem(o,t);this._aItems[o]=s,this._reportChildAdded(s),e()}));let s=e.query?window.Mimoto.data.internal.realtimeDatabase(e.query):this._dbListItems;return new Promise(((e,i)=>{let o=window.Mimoto.data.internal.realtimeDatabaseModules().push(s),n=o.key;window.Mimoto.data.internal.realtimeDatabaseModules().set(o,t).then((()=>e(this._composeItem(n,t)))).catch((t=>i(t)))}))},set:function(t,e){if(!e.query)return;let i=window.Mimoto.data.internal.realtimeDatabase(e.query);return new Promise(((e,o)=>{window.Mimoto.data.internal.realtimeDatabaseModules().set(i,t).then((()=>e(t))).catch((t=>o(t)))}))},remove:function(t,e={}){let i=e.query?e.query:this._sListQuery;i+=i.length>0?"/":"",i+=t;let o=window.Mimoto.data.internal.realtimeDatabase(i);return new Promise(((t,e)=>{window.Mimoto.data.internal.realtimeDatabaseModules().remove(o).then((()=>t())).catch((t=>e(t)))}))},hasChanges:function(){return this._mimotoDocument.hasChanges()},_onChildAdded:function(t){let e=this._composeItem(t.key,t.val());this._aItems[t.key]=e,this._reportChildAdded(e)},_reportChildAdded:function(e){this.dispatchEvent(t.exports.ITEM_ADDED,e)},_composeItem:function(t,e){return{key:t,value:e}},_onChildChanged:function(e){let i=this._aItems[e.key];i.value=o.updateObjectWithMissingFields(i.value,e.val()),this.dispatchEvent(t.exports.ITEM_CHANGED,i)},_onChildRemoved:function(e){const i=this._aItems[e.key];i&&(delete this._aItems[e.key],this.dispatchEvent(t.exports.ITEM_REMOVED,i))},_convertOrderObjectToArray:function(t,e=null,i=null){let o=[];if(null===t)return o;for(let e in t){o[t[e].sortIndex]=e}return o},_convertOrderArrayToStorableObject:function(t){let e={},i=t.length;for(let o=0;o<i;o++){let n=t[o];e[n]={key:n,previousItem:o>0?t[o-1]:null,nextItem:o<i-1?t[o+1]:null,sortIndex:o}}return e}}},109:(t,e,i)=>{"use strict";const o=i(104);t.exports=function(t){this.__construct(t)},t.exports.MIMOTOEVENTDISPATCHER="MimotoEventDispatcher",t.exports.prototype={__construct:function(e){e.__EventDispatcherExtender_aEventListeners={},e.__EventDispatcherExtender_aEventListenersToRemove={},e.addEventListener=function(i,n){void 0===e.__EventDispatcherExtender_aEventListeners[i]&&(e.__EventDispatcherExtender_aEventListeners[i]=[]);let s={MimotoObjectType:t.exports.MIMOTOEVENTDISPATCHER,id:t.exports.MIMOTOEVENTDISPATCHER+"."+o.process().toUpperCase(),type:i,fMethod:n};return e.__EventDispatcherExtender_aEventListeners[i].push(s),s}.bind(e),e.removeEventListener=function(i){if("string"!=typeof i){if("object"==typeof i&&i?.MimotoObjectType===t.exports.MIMOTOEVENTDISPATCHER){let t=i,o=e.__EventDispatcherExtender_aEventListeners[t.type].length;for(let i=0;i<o;i++){if(e.__EventDispatcherExtender_aEventListeners[t.type][i].id===t.id)return void(e.__EventDispatcherExtender_aEventListenersToRemove[t.id]=t)}}}else{let t=i;e.__EventDispatcherExtender_aEventListeners[t].forEach((t=>{e.__EventDispatcherExtender_aEventListenersToRemove[t.id]=t}))}},e.dispatchEvent=function(t,i){if(e.__EventDispatcherExtender_aEventListeners[t]){for(let o=0;o<e.__EventDispatcherExtender_aEventListeners[t].length;o++){let n=e.__EventDispatcherExtender_aEventListeners[t][o];if(void 0!==e.__EventDispatcherExtender_aEventListenersToRemove[n.id]){e.__EventDispatcherExtender_aEventListeners[t].splice(o,1),o--,delete e.__EventDispatcherExtender_aEventListenersToRemove[n.id];continue}let s={type:t,data:i};n.fMethod.apply(null,[s])}0===e.__EventDispatcherExtender_aEventListeners[t].length&&delete e.__EventDispatcherExtender_aEventListeners[t]}}}}},310:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";const MimotoInstructionUtils=__webpack_require__(752),MimotoTemplateUtils=__webpack_require__(749),MimotoUtils=__webpack_require__(948),MimotoInstruction=__webpack_require__(25),MimotoNode=__webpack_require__(450),MimotoList=__webpack_require__(939),MimotoDocument=__webpack_require__(697),UniqID=__webpack_require__(104);module.exports=function(t,e,i){this.__construct(t,e,i)},module.exports.TYPE="MimotoView",module.exports.prototype={__construct:function(classRoot,template,settings={}){this._classRoot=classRoot,this._config=settings,this._viewID=module.exports.TYPE+"."+UniqID.process().toUpperCase(),this._ui={},this._aInstructionTree={},this._nodeTree=null,this._root=this._initRoot(classRoot,template,this._config),this._sKey=null,this._aVarsInView={},this._aUserVariablesGlobal=window.Mimoto.ui.getGlobalVars(),this._aUserVariablesLocal=settings.vars||{},this._aUserVariables=MimotoUtils.mergeDeep(this._aUserVariablesGlobal,this._aUserVariablesLocal),classRoot.Mimoto={},classRoot.Mimoto.ui={},classRoot.internal={},classRoot.debugID=this._viewID,classRoot.debugClassRoot=this,classRoot.Mimoto.ui.getHTML=()=>this._root.html,classRoot.Mimoto.ui.getRootJS=()=>this._root.js,classRoot.Mimoto.ui.getViewID=()=>this._viewID,classRoot.Mimoto.ui.getKey=()=>this._sKey,classRoot.Mimoto.ui.setKey=t=>this._sKey=t,classRoot.Mimoto.ui.addView=(t,e,...i)=>this._uiAdd(t,e,!1,...i),classRoot.Mimoto.ui.addSubview=(t,e,i)=>this._uiAdd(t,e,!0,i),classRoot.Mimoto.ui.removeView=t=>this._uiRemoveView(t),classRoot.Mimoto.ui.emptyView=t=>{this._uiEmptyView(t)},classRoot.Mimoto.ui.refillWithView=(t,e,i)=>this._uiRefill(t,e,!1,i),classRoot.Mimoto.ui.refillWithSubview=(t,e,i)=>this._uiRefill(t,e,!0,i),classRoot.Mimoto.ui.replaceWithSubview=(t,e,i)=>this._uiReplace(t,e,!0,i),classRoot.Mimoto.ui.replaceWithView=(t,e,i)=>this._uiReplace(t,e,!1,i),classRoot.Mimoto.ui.moveTo=(t,e,i)=>this._uiMoveTo(t,e,i),classRoot.Mimoto.ui.getPosition=(t,e)=>this._uiGetPosition(t,e),classRoot.Mimoto.ui.findElement=t=>this._uiFindElement(t),classRoot.Mimoto.ui.collectElements=t=>this._uiCollectElements(t),classRoot.Mimoto.ui.setLocalVar=(t,e,i,o)=>{this._uiSetLocalVar(t,e,i,o)},classRoot.Mimoto.ui.getLocalVar=t=>this._uiGetLocalVar(t),classRoot.Mimoto.ui.setGlobalVar=(t,e)=>{window.Mimoto.ui.setGlobalVar(t,e)},classRoot.Mimoto.ui.getGlobalVar=t=>window.Mimoto.ui.getGlobalVar(t),classRoot.Mimoto.ui.setGlobalVars=t=>{window.Mimoto.ui.setGlobalVars(t)},classRoot.Mimoto.ui.setVars=(t,e,i)=>{this._uiSetVars(t,e,i)},classRoot.Mimoto.ui.setState=(t,e,i)=>{this._uiToggleState(t,e,i,!1)},classRoot.Mimoto.ui.unsetState=(t,e,i)=>{this._uiToggleState(t,e,i,!0)},classRoot.Mimoto.ui.openPopup=(t,e)=>("object"!=typeof e&&(e={}),this._uiOpen(t,null,e)),classRoot.Mimoto.ui.openInline=(t,e,i)=>this._uiOpen(t,e,i),classRoot.Mimoto.ui.navigate=(t,e)=>{Mimoto.navigation.goto(t,e)},classRoot.Mimoto.ui.logEvent=(t,e)=>{Mimoto.analytics.logEvent(t,e)},classRoot.Mimoto.ui.xray=function(t){Mimoto.log.apply(this,["ü©ª - Mimoto XRAY:"].concat(Array.prototype.slice.call(arguments)))},classRoot.Mimoto.ui.event=(t,e)=>this._uiEvent(t,e),classRoot.internal.publicAPI={ADDVIEW:"addView",ADDSUBVIEW:"addSubview",REMOVEVIEW:"removeView",EMPTYVIEW:"emptyView",REFILLWITHVIEW:"refillWithView",REFILLWITHSUBVIEW:"refillWithSubview",REPLACEWITHVIEW:"replaceWithView",REPLACEWITHSUBVIEW:"replaceWithSubview",MOVETOVIEW:"moveToView",GETPOSITION:"getPosition",FINDELEMENT:"findElement",SETLOCALVAR:"setLocalVar",GETLOCALVAR:"getLocalVar",SETGLOBALVAR:"setGlobalVar",GETGLOBALVAR:"getGlobalVar",SETGLOBALVARS:"setGlobalVars",SETVARS:"setVars",SETSTATE:"setState",UNSETSTATE:"unsetState",OPENPOPUP:"openPopup",OPENINLINE:"openInline",EVENT:"event",NAVIGATE:"navigate",XRAY:"xray",LOGEVENT:"logEvent"},classRoot.internal.run=t=>{this._internalRun(t)},classRoot.internal.getRoot=()=>this._internalGetRoot(),classRoot.internal.getNodeTree=()=>this._internalGetNodeTree(),classRoot.internal.getUserVariables=()=>this._internalGetUserVariables(),classRoot.internal.setHTML=t=>{this._internalSetHTML(t)},!1===classRoot.Mimoto.ui.getHTML()&&classRoot.internal.setHTML(document.createElement("div")),classRoot.Mimoto.ui.getHTML().hasAttribute(MimotoInstructionUtils.DATA_MIMOTO_ID)||classRoot.Mimoto.ui.getHTML().setAttribute(MimotoInstructionUtils.DATA_MIMOTO_ID,this._viewID),MimotoTemplateUtils.registerTemplates(this._root.html),setTimeout((()=>{if(this._root.html!==document&&this._root.html!==document.body&&(!this._config||this._config&&!this._config.dontAutoExecuteScripts)){let aScripts=this._root.html.getElementsByTagName("script");for(let nScriptIndex=0;nScriptIndex<aScripts.length;nScriptIndex++)eval(aScripts[nScriptIndex].text)}}),0),this._nodeTree=new MimotoNode(this._root.html,null,null,this),this._ui={viewID:this._viewID,elRoot:this._root.html,localMethods:{}};for(let t in classRoot.Mimoto.ui)this._ui.localMethods["Mimoto.ui."+t]={scope:classRoot.Mimoto.ui,method:classRoot.Mimoto.ui[t]};this._nodeTree.ui=this._ui,window.Mimoto.extender.makeEventDispatcher(classRoot),this._root.html===document.body&&(this._internalRun(this._nodeTree.subNodes),setTimeout((()=>{window.Mimoto.ui.___registerView(this._classRoot)}),1))},_uiRefill:function(t,e,i=!1,o={}){this._uiEmptyView(e);let n=Array.isArray(t)?t:[t];if(0===n.length)return;let s=n.length;for(let t=0;t<s;t++)this._uiAdd(n[t],e,i,o)},_uiAdd:function(t,e=null,i=!1,o={},n=!1){if(null!==e&&!this._checkIfTargetExists(e)&&!n)return;let s=null,r={};if(isNaN(o))for(let t in o){let e=o[t];null!==s||isNaN(e)?null===r&&"vars"===t&&(r=o[t]):s=e}else s=o;o.vars=MimotoUtils.mergeDeep(i?null!==r?MimotoUtils.mergeDeep(this._aUserVariablesLocal,r):r:this._aUserVariablesLocal,o.vars);let a=this._createView(t,o),l=n?this._nodeTree.subNodes[Object.keys(this._nodeTree.subNodes)[0]]:this._nodeTree.findNodeByID(e);return l.addNode(a,i,s),a.internal.getNodeTree().container=l,n&&(a.TEMP_SOLUTION_OriginalParentElement=a.Mimoto.ui.getHTML().parentNode,document.body.append(a.Mimoto.ui.getHTML())),a},_uiReplace:function(t,e,i=!1,o={}){if(!this._checkIfTargetExists(e))return;o.vars=i?MimotoUtils.mergeDeep(this._aUserVariablesLocal,o.vars||{}):o.vars||{};let n=this._createView(t,o);return this._nodeTree.replaceNode(e,n,i,void 0,void 0!==o?.position?o.position:null),n},_createView:function(t,e=null){if("string"==typeof t)t=this._createChildView(t,e);else t="function"==typeof t?new t:t,e.vars&&t.Mimoto.ui.setVars(e.vars);return t},_checkIfTargetExists:function(t){return!!this._nodeTree.hasNode(t)||(MimotoInstructionUtils.addHint(this._root.html,"Target '"+t+"' not found"),!1)},_uiRemoveView:function(t){const e=function(t){for(let e in t.internal.getNodeTree().container.subNodes){let i=t.internal.getNodeTree().container.subNodes[e];if(i.view&&i.view.Mimoto.ui.getViewID()===t.Mimoto.ui.getViewID())return e}return!1}.bind(this);let i="string"==typeof t?t:!!t.Mimoto&&e(t);!1!==i&&this._nodeTree.removeNode(i)},_uiEmptyView:function(t){this._nodeTree.emptyNode(t)},_uiMoveTo:function(t,e,i={}){if(!this._checkIfTargetExists(e))return;if(!this._checkIfTargetExists(t))return;let o=isNaN(i)?null:i;this._nodeTree.moveNode(t,e,o)},_uiGetPosition:function(t,e){return!!this._checkIfTargetExists(e)&&(!!this._checkIfTargetExists(t)&&this._nodeTree.getNodePosition(t,e))},_uiFindElement:function(t){return this._nodeTree.findNodeByID(t)},_uiSetLocalVar:function(t,e,i=!0,o=!1){this._setVar(t,e,i,o)},_uiGetLocalVar:function(t){return this._aUserVariablesLocal[t]},_uiSetVars:function(t,e=!0,i=!1){this._setVar(t,void 0,e,i)},_uiGetLocalVars:function(){return MimotoUtils.clone(this._aUserVariablesLocal)},_uiToggleState:function(t,e,i=!0,o=!1){let n=this._nodeTree.findNodeByID(e);n&&(o?n.unsetState(t,i):n.setState(t,i))},_uiOpen:function(t,e=null,i={}){return new Promise(((o,n)=>{let s=!0===i.insertAsSubview,r=this._uiAdd(t,e,s,i,null===e);if(!r)return void n();let a=r.Mimoto.ui.getHTML(),l="dialog"===r.Mimoto.ui.getHTML().tagName.toLowerCase();if(null===e){let t=this._classRoot.Mimoto.ui.getHTML();l||(a=document.createElement("dialog"),t.appendChild(a),t=a,t.appendChild(r.Mimoto.ui.getHTML())),a.showModal()}let u=new MimotoInstruction(MimotoInstructionUtils.DATA_MIMOTO_FORM,"",null,void 0,void 0);r.internal.getNodeTree().addInstruction(u),u.api.initLocalDB(null,{},i.vars),u.disableAutoRun(),r.internal.run();let c={};c.collect=function(t,e=null){let i={};null!==e?i[t]=e:i=t,u.api.updateValue(i)}.bind(this),c.close=function(t=void 0){void 0===t&&(t=u.api.getValue()),c.cleanup(),o(t)}.bind(this),c.cancel=function(){c.cleanup()}.bind(this),c.cleanup=function(){r.TEMP_SOLUTION_OriginalParentElement&&(r.TEMP_SOLUTION_OriginalParentElement.appendChild(r.Mimoto.ui.getHTML()),delete r.TEMP_SOLUTION_OriginalParentElement),this._uiRemoveView(r),null!==e||l||a.parentNode.removeChild(a)}.bind(this),u.api.setLocalMethod("collect",{scope:c,method:c.collect}),u.api.setLocalMethod("close",{scope:c,method:c.close}),u.api.setLocalMethod("cancel",{scope:c,method:c.cancel}),a.addEventListener("close",(t=>c.cleanup()))}))},_uiEvent:function(t,e){this._classRoot.dispatchEvent(t,e)},_internalRun:function(t){t||(t=[this._nodeTree]),MimotoInstructionUtils.executeInstructions(t),setTimeout((()=>{this._nodeTree.findNodesByInstructionType(MimotoInstructionUtils.DATA_MIMOTO_EVENT,void 0,!0).forEach((t=>t.api.dispatchEvent(MimotoInstructionUtils.CONSTANT_EVENT_INIT)))}),0)},_internalGetRoot:function(){return this},_internalGetNodeTree:function(){return this._nodeTree},_internalGetUserVariables:function(){return MimotoUtils.clone(this._aUserVariables)},_internalSetHTML:function(t=null){null===t&&(t=document.createElement("div")).setAttribute(MimotoInstructionUtils.DATA_MIMOTO_HINT,"Mimoto placeholder element. If you come across this, something very likely went wrong."),this._root.html=t},_initRoot:function(t,e,i){let o={js:t,html:document.body};if("string"==typeof e){if(/<\/?[a-z][\s\S]*>/i.test(e.trim()))o.html=MimotoTemplateUtils.buildInstanceFromTemplate(e);else{MimotoUtils.verifyFormat(e)||window.Mimoto.devtools.log("Template empty");let t=document.querySelector('[data-mimoto-id="'+e+'"]');t&&(o.html=t)}return this._tagView(o)}return e instanceof HTMLElement?(o.html=e,this._tagView(o)):(e instanceof Object&&e.Mimoto&&(i?.vars?(o.js=Object.create(e.prototype),o.js.__construct.apply(o.js,i.vars)):o.js=new e,o.html=o.js.Mimoto.ui.getHTML()),this._tagView(o))},_tagView:function(t){return t},_createChildView:(t,e)=>{if("string"==typeof t)return window.Mimoto.layout.createViewFromTemplate(t,e);if(t instanceof HTMLElement){let i={};return window.Mimoto.extender.makeView(i,t,e),i}return"object"==typeof t&&t.Mimoto?t:void 0},_locateTarget:(t,e)=>{let i=null;return"string"==typeof e?i=t._nodeTree.findNodeByID(e):e&&(e instanceof Element||e instanceof HTMLElement)&&(i=e),void 0===i&&(i=t._root.html,MimotoInstructionUtils.addHint(i,"Target '"+e+"' not found")),i},_addChild:function(t,e,i,o=null){if(!t._classRoot.Mimoto.ui.getHTML())return;let n=-1;if(!isNaN(o)&&o>=0){let t=i.children.length;for(let e=0;e<t;e++)if(i.children[e].getAttribute(MimotoInstructionUtils.DATA_MIMOTO_SORTINDEX)>o){n=e;break}}-1===n?i.append(e.Mimoto.ui.getHTML()):i.insertBefore(e.Mimoto.ui.getHTML(),i.children[n])},_removeChild:function(t,e,i){i.contains(e.Mimoto.ui.getHTML())&&i.removeChild(e.Mimoto.ui.getHTML())},_setVar:function(t,e,i,o){let n={};"object"==typeof t&&void 0===e?n=t:n[t]=e;let s=o?this._aUserVariablesGlobal:this._aUserVariablesLocal,r=!1;for(let t in n)s[t]!==n[t]&&(r=!0,s[t]=n[t]);this._aUserVariables=MimotoUtils.mergeDeep(this._aUserVariablesGlobal,this._aUserVariablesLocal),r&&i&&this._nodeTree.setVars(this._aUserVariables)},_executeInstructionOnVarChange:function(t,e){e&&t.execute().then((()=>{})).catch((t=>{}))},_convertInstructionTreeToList:function(t,e=[],i=null){for(let o in t)e[o]=t[o],e[o].parent=i||this._aInstructionTree,e=this._convertInstructionTreeToList(t[o].subNodes,e,e[o]);return e},_rebuildInstructionList:function(){this._aInstructionList=this._convertInstructionTreeToList(this._aInstructionTree)},_cleanupInstructionList:function(t,e){delete e[t.nodeID];for(let i in t.subNodes)this._cleanupInstructionList(t.subNodes[i],e);return e},_replaceNodeInVarsInView:function(t,e){Mimoto.log("Is this used? MimotoViewExtender._replaceNodeInVarsInView");for(let i in this._aVarsInView){let o=this._aVarsInView[i].length;for(let n=0;n<o;n++)this._aVarsInView[i][n]===t&&(this._aVarsInView[i][n]=e)}}}},831:(t,e,i)=>{"use strict";const o=i(104),n=(i(752),i(948));t.exports=function(t,e){this.id=null,this.view=null,this.parent=null,this._bIsSubview=!1,this._bIsWrapper=!1,this.subNodes=null,this.instructions=null,this.__construct(t,e)},t.exports.TYPE="MimotoBridgeNode",t.exports.prototype={isView:function(){return!0!==this._bIsSubview},isSubview:function(){return!0===this._bIsSubview},isWrapper:function(){return!0===this._bIsWrapper},__construct:function(e,i){this.TYPE=t.exports.TYPE,this.view=e,this.parent=i,this.id=t.exports.TYPE+"."+o.process().toUpperCase()},findNodeByID:function(t,e=!1){if(!0===this._bIsSubview)return this.view.internal.getNodeTree().findNodeByID(t,e)},findNodesByInstructionType:function(t,e=null,i=!1){return!0!==this._bIsSubview?[]:this.view.internal.getNodeTree().findNodesByInstructionType(t,e,i)},getRoot:function(){return null!==this.parent?this.parent.getRoot():this.view.internal.getNodeTree()},getVars:function(){return null!==this.parent?n.mergeDeep(this.parent.getVars(),this.view.internal.getUserVariables()):this.view.internal.getUserVariables()},getNodeList:function(t=!0,e={}){return null!==this.id&&(e[this.id]=this),!0!==this._bIsSubview?e:e=this.view.internal.getNodeTree().getNodeList(t,e)},getInstructionList:function(t=!0,e={}){return null!==this.instructions&&Object.keys(this.instructions).forEach((t=>e[t]=this.instructions[t])),!0!==this._bIsSubview?e:e=this.view.internal.getNodeTree().getInstructionList(t,e)},connectSubview:function(){this._bIsSubview=!0,this.view.internal.getNodeTree().bridge=this},getRootHTML:function(){let t=this.view.internal.getNodeTree().subNodes;for(let e in t)return t[e].getRootHTML()},makeWrapper:function(t){this._bIsWrapper=!0,this.subNodes={},this.instructions=t},hasDataSource:function(t,e){return this.parent.hasDataSource(t,e)},getDataSource:function(t,e,i=null,o=0,n=!1){return this.parent?.getDataSource(t,e,i,o,n)},getContainers:function(t){return this.isSubview()?this.view.internal.getNodeTree().getContainers(t):[]},setState:function(t,e=!1){e&&this.isSubview()&&this.view.internal.getNodeTree().setState(t,e)},unsetState:function(t,e=!1){e&&this.view.internal.getNodeTree().unsetState(t,e)},setValues:function(t,e,i){if(this.isWrapper())for(let t in this.instructions)this.instructions[t].execute().then((()=>{})).catch((t=>{}));this.isSubview()&&this.view.internal.getNodeTree().setValues(t,e,i)},setVars:function(t){if(this.isWrapper())for(let t in this.instructions)this.instructions[t].execute().then((()=>{})).catch((t=>{}));this.isSubview()&&this.view.internal.getNodeTree().setVars(t)},run:function(){this.view.internal.run()},discard:function(){this.view.internal.getNodeTree().discard()},disconnectSubview:function(){delete this.view.internal.getNodeTree().bridge},xray:function(){let t={TYPE:this.isSubview()?"SUBVIEW":"VIEW",id:this.id};for(let e in this.view.internal.getNodeTree().subNodes)void 0===t.subNodes&&(t.subNodes=[]),t.subNodes[e]=this.view.internal.getNodeTree().subNodes[e].xray();return this.instructions&&(t.instruction=this.instructions),t}}},25:(t,e,i)=>{"use strict";const o=i(752),n=i(697),s=i(401),r=i(757),a=i(92),l=i(444),u=i(527),c=i(909),d=i(659),h=i(101),_=i(311),p=i(214),T=i(252),m=i(836),g=i(889),f=i(511),E=i(574),A=i(428),N=i(960),I=i(995),O=i(635),M=i(804),S=i(948),v=i(104);t.exports=function(t,e,i,o,n,s,r){this.id=null,this.type=null,this.group=null,this.value=void 0,this.settings=void 0,this.vars=void 0,this.parser={value:void 0,valuePreparsed:void 0,valuePreparseIndex:[],valueParseIndex:[],settings:void 0,settingsPreparsed:void 0,settingsPreparseIndex:[],settingsParseIndex:[],vars:void 0,varsPreparsed:void 0,varsPreparseIndex:[],varsParseIndex:[],preparsed:!1,parsed:!1,needsPreparsing:null,needsParsing:null},this.scope={node:null,elNode:null,nodeID:null,extenderRoot:null,localMethods:[]},this.data={cache:null},this.current=null,this.log={},this.ui=[],this.localMethods={},this.user={isEditing:!1},this.requiredVarsAndValues=[],this.busy=null,this.done=!1,this._output=null,this.api={},this._listeners={},this._broadcasters={},this._sLatestProcessID=null,this.__construct(t,e,i,o,n,s,r)},t.exports.TYPE="OutputInstruction",t.exports.prototype={TYPE:t.exports.TYPE,PROCESS_CANCELLATION_MESSAGE:{message:"Process stopped due to new process request"},__construct:function(e,i,n,S,b,w,D={}){switch(this.id=D.id||t.exports.TYPE+"."+v.process().toUpperCase(),this.type=e,this.group=i,this.value=n,this.settings=S,this.vars=b,this.node=w,this.type){case o.DATA_MIMOTO_LAYOUT:this._output=new _(this);break;case o.DATA_MIMOTO_VIEW:this._output=new d(this);break;case o.DATA_MIMOTO_SUBVIEW:this._output=new h(this);break;case o.DATA_MIMOTO_DOCUMENT:this._output=new l(this);break;case o.DATA_MIMOTO_LIST:this._output=new u(this);break;case o.DATA_MIMOTO_CONTAINER:this._output=new c(this);break;case o.DATA_MIMOTO_OUTPUT:this._output=new a(this);break;case o.DATA_MIMOTO_VALUE:this._output=new r(this);break;case o.DATA_MIMOTO_LOG:this._output=new T(this);break;case o.DATA_MIMOTO_XRAY:this._output=new m(this);break;case o.DATA_MIMOTO_INPUT:this._output=new p(this);break;case o.DATA_MIMOTO_ACTION:this._output=new g(this);break;case o.DATA_MIMOTO_EVENT:this._output=new f(this);break;case o.DATA_MIMOTO_NAVIGATION:this._output=new E(this);break;case o.DATA_MIMOTO_DRAGHANDLE:this._output=new A(this);break;case o.DATA_MIMOTO_CLASS:this._output=new N(this);break;case o.DATA_MIMOTO_ATTRIBUTE:this._output=new I(this);break;case o.DATA_MIMOTO_FORM:this._output=new s(this);break;case o.DATA_MIMOTO_REALTIME:this._output=new O(this);break;case o.DATA_MIMOTO_META:this._output=new M(this)}},execute:async function(t=!1,e=null){let i=this.node.getDataSource(this.group,[n.TYPE,n.TYPE_FORM],null,0,this.type===o.DATA_MIMOTO_DOCUMENT),s=void 0!==i&&i.source.getValue?i.source.getValue():{};const r="Process-"+v.process().toUpperCase();return this._sLatestProcessID===r||t||(this.parser.needsPreparsing&&(this.parser.preparsed=!1,this.parser.needsParsing=null),this.parser.parsed=!1),this._sLatestProcessID=r,new Promise((async(i,n)=>{if(!this.node.getRoot().extenderRoot)return void n();let a=null;if(null===this.parser.needsPreparsing)try{let t=await o.indexInstructionForPreparsing(this);if(this._sLatestProcessID!==r)return void n(this.PROCESS_CANCELLATION_MESSAGE);this.parser.needsPreparsing=t}catch(t){return o.addHint(this.node.elNode,t),void n(t)}if(this.parser.needsPreparsing&&!this.parser.preparsed){a=e?this._collectVarsAndValues(Mimoto.data.merge(e,s)):this._collectVarsAndValues(s);try{if(await o.computeInstruction(this,o.INSTRUCTION_PREPARSE_INDEX,a),this._sLatestProcessID!==r)return void n(this.PROCESS_CANCELLATION_MESSAGE);this.parser.preparsed=!0}catch(t){return o.addHint(this.node.elNode,t),void n(t)}}if(null===this.parser.needsParsing)try{let t=await o.indexInstructionForParsing(this,o.INSTRUCTIONS_WITH_PARSE_SUPPORT.includes(this.type));if(this._sLatestProcessID!==r)return void n(this.PROCESS_CANCELLATION_MESSAGE);this.parser.needsParsing=t}catch(t){return o.addHint(this.node.elNode,t),void n(t)}if(this.parser.needsParsing&&!this.parser.parsed){if(!t&&[o.DATA_MIMOTO_ACTION,o.DATA_MIMOTO_EVENT].includes(this.type))return this.parser.parsed=!0,this._update(s,!0),void i();null===a&&(a=e?this._collectVarsAndValues(Mimoto.data.merge(e,s)):this._collectVarsAndValues(s));try{if(await o.computeInstruction(this,o.INSTRUCTION_PARSE_INDEX,a,o.INSTRUCTIONS_WITH_PARSE_SUPPORT.includes(this.type)),this._sLatestProcessID!==r)return void n(this.PROCESS_CANCELLATION_MESSAGE);this.parser.parsed=!0}catch(t){return"object"==typeof t&&t.MimotoParseResponse===o.CANCEL?void i():(o.addHint(this.node.elNode,t),void n(t))}}t||[o.DATA_MIMOTO_ACTION,o.DATA_MIMOTO_EVENT].includes(this.type)||this._update(s),i()}))},disableAutoRun:function(){null!==this._output&&this._output.disableAutoRun()},discard:function(){null!==this._output&&void 0!==this._output.discard&&"function"==typeof this._output.discard&&this._output.discard()},listen:function(t,e){this._listeners[e]||(this._listeners[e]={}),this._listeners[e][t.id]=t},unlisten:function(t,e){this._listeners[e]&&(this._listeners[e][t.id]&&delete this._listeners[e][t.id],0===Object.keys(this._listeners[e]).length&&delete this._listeners[e])},broadcast:function(t){Object.keys(t).forEach((e=>{this._listeners[e]&&Object.keys(this._listeners[e]).forEach((i=>{let o=this._listeners[e][i];if(!o)return;let n={};n[this.id+"_"+e]=t[e],o.execute(void 0,n).then((()=>{})).catch((t=>{}))}))}))},_collectVarsAndValues:function(t){return S.mergeDeep(S.mergeDeep(window.Mimoto.ui.getGlobalVars(),this.node.getVars()),t||{})},_update:function(t,e=!1){if(null!==this._output)if(e)this._output.update(this.parser.valueParseIndex,this.parser.settingsParseIndex,this.parser.varsParseIndex);else{let e=[o.DATA_MIMOTO_LAYOUT,o.DATA_MIMOTO_SUBVIEW].includes(this.type)?S.mergeDeep(t,this.parser.vars):this.parser.vars;if(this.current&&this.current.value===this.parser.value&&Mimoto.data.compare(this.current.settings,this.parser.settings)&&Mimoto.data.compare(this.current.vars,e))return;this.current={value:this.parser.value,settings:this.parser.settings,vars:e},this.parser.settings?.realtime&&(this._realtime=window.Mimoto.realtime.configure(this.parser.settings.realtime,this._realtime?.id),this._output.realtime=this._realtime),this._output.update(this.parser.value,this.parser.settings,e)}},_reset:function(){null!==this._output&&(this.current.value=void 0,this.current.settings=void 0,this.current.vars=void 0,void 0!==this._output.reset&&"function"==typeof this._output.reset&&this._output.reset())}}},450:(t,e,i)=>{"use strict";const o=i(831),n=i(25),s=i(752),r=i(749),a=i(948),l=i(697),u=i(939),c=i(104);t.exports=function(t,e=null,i=null,o=null){this.id=null,this.parent=null,this.elNode=null,this.subNodes={},this.instructions={},this.dataSource={},this.dataSource[l.TYPE]={},this.dataSource[l.TYPE_FORM]={},this.dataSource[u.TYPE]={},this.collection={},this.bridge=null,this.containingNodeID=null,this.states={},this.__construct(t,e,i,o)},t.exports.TYPE="MimotoNode",t.exports.prototype={__construct:function(e,i=null,o=null,n=null){if(this.TYPE=t.exports.TYPE,null!==o?this.parent=o:(this.extenderRoot=n,this.view=n._classRoot,this.ui=null,this.container=null),null!==i)return this.id=e.getAttribute(s.DATA_MIMOTO_ID),this.elNode=e,this._collectInstructions(i),void this._parseSubNodes(e);this._parseNode(e)},hasNode:function(t){return!1!==this.findNodeByID(t)},findNodeByID:function(t){let e=this.getNodeList()[t];return e||!1},findInstructionByID:function(t){let e=this.getInstructionList()[t];return e||!1},findBridgeNodeByView:function(t){let e=this.getNodeList();for(let i in e)if(e[i].view===t)return i;return!1},getRoot:function(){return null!==this.parent?this.parent.getRoot():null!==this.bridge?this.bridge.getRoot():this},getVars:function(){return null!==this.parent?this.parent.getVars():null!==this.bridge?this.bridge.getVars():this.view.internal.getUserVariables()},getNodeList:function(t=!0,e={}){if(null!==this.id&&(e[this.id]=this),t)for(let i in this.subNodes)e=this.subNodes[i].getNodeList(t,e);return e},getInstructionList:function(t=!0,e={}){if(null!==this.instructions&&Object.keys(this.instructions).forEach((t=>e[t]=this.instructions[t])),e)for(let i in this.subNodes)e=this.subNodes[i].getInstructionList(t,e);return e},findNodesByInstructionType:function(t,e=null,i=!1){let o=[];for(let n in this.instructions)if(this.instructions[n].type===t){if(null!==e&&this.instructions[n].group!==e)continue;o.push(!0===i?this.instructions[n]:this);break}for(let n in this.subNodes)o=o.concat(this.subNodes[n].findNodesByInstructionType(t,e,i));return o},cutNode:function(t,e=!0){let i=this.findNodeByID(t.id?t.id:t);if(!1!==i)return i.isView&&i.isView()&&window.Mimoto.ui.___unregisterView(i.view),e&&this.removeNode(i.id,e),i.parent=null,i},pasteNode:function(t,e=null,i=!0){let o=this.elNode||this.container?.elNode,n=t.elNode||t.view.Mimoto.ui.getHTML();this._storeSubNode(t),i&&this._connectHTML(o,n,e),t.parent=this},addNode:function(t,e=!1,i=null){let n=new o(t,this);return!0===e&&n.connectSubview(),this._storeSubNode(n),this._connectHTML(this.elNode,n.view.Mimoto.ui.getHTML(),i),this._runBridgeNode(n),n},discard:function(){for(let t in this.instructions)this.instructions[t].discard();for(let t in this.subNodes)this.subNodes[t].discard()},_connectHTML:function(t,e,i=null,o=!1){if(o)return t.replaceWith(e),void(null!==i&&e.parentNode.children[i]&&e.parentNode.insertBefore(e,e.parentNode.children[i]));let n=-1,r=null;if(!isNaN(i)&&i>=0){r=!0;let e=t.children.length;for(let o=0;o<e;o++)if(t.children[o].hasAttribute(s.DATA_MIMOTO_SORTINDEX)){if(t.children[o].getAttribute(s.DATA_MIMOTO_SORTINDEX)>i){n=o;break}}else r=!1}if(-1===n){if(!1===r)return e.parentNode===t&&t.removeChild(e),void t.insertBefore(e,t.children[i]);t.append(e)}else t.insertBefore(e,t.children[n])},getRootHTML:function(){if(this.elNode)return this.elNode;let t=this.view.internal.getNodeTree().subNodes;for(let e in t)return t[e].getRootHTML()},removeNode:function(t,e=!0){let i=this.findNodeByID(t);!1!==i&&(!0===e&&(i.TYPE===o.TYPE?null!==i.view?.Mimoto.ui.getHTML().parentNode?i.view.Mimoto.ui.getHTML().parentNode.removeChild(i.view.Mimoto.ui.getHTML()):i.getRootHTML().parentNode&&i.getRootHTML().parentNode.removeChild(i.getRootHTML()):i.elNode.parentNode.removeChild(i.elNode)),this._cleanupNode(i))},emptyNode:function(t){let e=this.findNodeByID(t);if(!1!==e)for(let t in e.subNodes){e.cutNode(e.subNodes[t]).discard()}},replaceNode:function(t,e,i=!1,n=!1,s=null){let r=this.findNodeByID(t);if(!1===r)return;this._cleanupNode(r);let a=r.parent;a.cutNode(r);let l=new o(e,a);l.id=t,!0===i&&l.connectSubview(),l.makeWrapper(r.instructions),a._storeSubNode(l);let u=r.TYPE===o.TYPE&&r.isWrapper()?r.view.Mimoto.ui.getHTML():r.elNode;this._connectHTML(u,e.Mimoto.ui.getHTML(),s,!0),this._runBridgeNode(l)},isRootNode:function(){return null===this.parent},restoreOriginalNode:function(t,e){let i=this.findNodeByID(t.id);if(!1===i)return;this._cleanupNode(i);let o=this.findNodeByID(t.parent.id);!1!==o&&(o.pasteNode(t),this.subNodes[t.id].run&&this.subNodes[t.id].run())},moveNode:function(t,e,i=null){let o=this.findNodeByID(t);if(!1===o)return;let n=o.parent,s=this.findNodeByID(e);!1!==s&&(s.pasteNode(n.cutNode(o),i),this._runBridgeNode(o))},getNodePosition:function(t,e){let i=this.findNodeByID(t);if(!1===i)return;let o=this.findNodeByID(e);if(!1===o)return;let n=i.elNode||i.view.Mimoto.ui.getHTML(),s=o.elNode.children.length;for(let t=0;t<s;t++)if(o.elNode.children[t]===n)return t;return!1},dispatchEvent:function(t,e=null){for(let i in this.instructions)this.instructions[i].type===s.DATA_MIMOTO_EVENT&&this.instructions[i].api.dispatchEvent(t,e)},_runBridgeNode:function(t){t.run()},run:function(){s.executeInstructions([this])},alterNodeSortIndex:function(t,e){},createDirectParentNode:function(){let t=this._tagNodeWithID(this.elNode.parentNode),e=r.findElementIndexInContainer(this.elNode.parentNode),i=r.findElementIndexInContainer(this.elNode);this.parent._parseNode(this.elNode.parentNode,!0);let o=this.parent.findNodeByID(t);this.parent.pasteNode(o,e);let n=this.parent.cutNode(this);o.pasteNode(n,i)},convertElementToNode:function(t,e){let i=this._tagNodeWithID(t);this._parseNode(t,!0);Array.prototype.slice.call(e.elNode.children).indexOf(t);let o=this.findNodeByID(i);for(let n in e.subNodes){let s=e.subNodes[n];if(n===i)continue;if(!t.contains(s.elNode))continue;let r=e.cutNode(s,!1);o.pasteNode(r,null,!1)}return o},addDataSource:function(t){let e=[];switch(t.type){case l.TYPE:e.push(l.TYPE);break;case u.TYPE:e.push(u.TYPE);break;case l.TYPE_FORM:e.push(l.TYPE_FORM)}e.forEach((e=>{void 0===this.dataSource[e][t.originInstruction.group]?this.dataSource[e][t.originInstruction.group]=t:s.addHint(this.elNode,"Overlapping dataSource")}))},hasDataSource:function(t,e=l.TYPE){return void 0!==this.dataSource[e][t]},getDataSource:function(t="",e=l.TYPE,i=null,o=0,n=!1){if(!n)if(null!==i&&["update","store","delete","openPopup","openInline","cancel","collect","close","add","updateAll","setAll","moveAll","removeAll","set"].includes(i)){let e=[l.TYPE,u.TYPE,l.TYPE_FORM].find((e=>this.dataSource[e][t]&&this.dataSource[e][t]?.source.localMethods[i]));if(e){if(!(o>0))return this.dataSource[e][t];o--}}else if(Array.isArray(e)){let i=e.find((e=>!(!this.dataSource[e]||!this.dataSource[e][t])));if(i)return this.dataSource[i][t]}else if(void 0!==this.dataSource[e][t])return this.dataSource[e][t];return null!==this.parent?this.parent.getDataSource(t,e,i,o):null!==this.bridge?this.bridge.getDataSource(t,e,i,o):void 0},getContainers:function(t){let e=[],i=!0;for(let o in this.instructions){if([s.DATA_MIMOTO_LIST,s.DATA_MIMOTO_COLLECTION].includes(this.instructions[o].type)&&this.instructions[o].node!==t.node){i=!1;break}if(this.instructions[o].type===s.DATA_MIMOTO_CONTAINER){if(null!==t.group&&this.instructions[o].group!==t.group)continue;if(this.instructions[o].api.hasOwnDataSource())continue;e.push(this.instructions[o]);break}}if(!i)return[];for(let i in this.subNodes)e=e.concat(this.subNodes[i].getContainers(t));return e},setValues:function(t,e,i,o=!1){a.mergeDeep(this.getVars(),t);let n=!o;for(let t in this.instructions){let i=this.instructions[t];[s.DATA_MIMOTO_ID,s.DATA_MIMOTO_XRAY].includes(i.type)||(o&&![s.DATA_MIMOTO_DOCUMENT,s.DATA_MIMOTO_LIST,s.DATA_MIMOTO_COLLECTION,s.DATA_MIMOTO_FORM].includes(i.type)||!o&&i.group===e&&[s.DATA_MIMOTO_DOCUMENT,s.DATA_MIMOTO_LIST,s.DATA_MIMOTO_COLLECTION,s.DATA_MIMOTO_FORM].includes(i.type)||i.group===e&&(i.user.isEditing||i.execute().then((()=>{})).catch((t=>{}))))}if(this.dispatchEvent(s.CONSTANT_EVENT_DATA,t),n)for(let o in this.subNodes)this.subNodes[o].hasDataSource(e)?this.subNodes[o].setValues(t,e,i,!0):(!this.subNodes[o].hasDataSource(e)||void 0!==this.subNodes[o].isSubview&&this.subNodes[o].isSubview())&&this.subNodes[o].setValues(t,e,i,this.subNodes[o].hasDataSource(e))},setVars:function(t){for(let t in this.instructions){let e=this.instructions[t];[s.DATA_MIMOTO_ID].includes(e.type)||(e.user.isEditing||e.execute().then((()=>{})).catch((t=>{})))}for(let e in this.subNodes)this.subNodes[e].setVars(t)},xray:function(){let t={TYPE:null===this.parent?"ROOT NODE":"NODE"};null!==this.parent&&(t.id=this.id,t.elNode=this.elNode),this.container&&(t.container=this.container);for(let e in this.instructions){void 0===t.instructions&&(t.instructions=[]);let i={id:e,type:this.instructions[e].type,value:this.instructions[e].value,settings:this.instructions[e].settings,vars:this.instructions[e].vars,instruction:this.instructions[e]};Mimoto.data.isEmpty(this.instructions[e].group)||(i.group=this.instructions[e].group),t.instructions[e]=i}for(let e in this.subNodes)this===this.root&&void 0===t.nodes&&(t.nodes={}),this!==this.root&&void 0===t.subNodes&&(t.subNodes={}),t[this===this.root?"nodes":"subNodes"][e]=this.subNodes[e].xray();for(let e in this.dataSource[l.TYPE])void 0===t.document&&(t.document={}),t.document[e]={query:this.dataSource[l.TYPE][e].source.getQuery?this.dataSource[l.TYPE][e].source.getQuery():null,data:this.dataSource[l.TYPE][e].source.getValue?this.dataSource[l.TYPE][e].source.getValue():null};for(let e in this.dataSource[u.TYPE])void 0===t.collection&&(t.collection={}),t.collection[e]={query:this.dataSource[u.TYPE][e].source.getQuery?this.dataSource[u.TYPE][e].source.getQuery():null};for(let e in this.dataSource[l.TYPE_FORM])void 0===t.forms&&(t.forms={}),t.forms[e]={query:this.dataSource[l.TYPE_FORM][e].source.getQuery?this.dataSource[l.TYPE_FORM][e].source.getQuery():null};return t},addInstruction:function(t){t.node=this,this.instructions[t.id]=t},setState:function(t,e=!1){if(this.states[t]=!0,this._runInstructions([s.DATA_MIMOTO_CLASS],"(MimotoNode.setState)"),e)for(let i in this.subNodes)this.subNodes[i].setState(t,e)},unsetState:function(t,e=!1){if(delete this.states[t],this._runInstructions([s.DATA_MIMOTO_CLASS],"(MimotoNode.unsetState)"),e)for(let i in this.subNodes)this.subNodes[i].unsetState(t,e)},hasState:function(t){return!0===this.states[t]},_parseNode:function(e,i=!1){let o=[];if(!e.hasAttribute(s.DATA_MIMOTO_NOPE)&&!e.hasAttribute(s.DATA_MIMOTO_STATUS)){for(let t in e.dataset){let i=s.convertDatasetIdentifierToInstruction(t);if(null===i)continue;if(!1===i){s.addHint(e,'"'+s.convertDatasetIdentifierToInstruction(t,!0)+"\" isn't a valid instruction");continue}if(e.setAttribute(s.DATA_MIMOTO_STATUS,s.DATA_MIMOTO_STATUS_ACTIVE),t.substring(t.length-s.INSTRUCTION_SETTINGS_POSTFIX_DATASET.length)===s.INSTRUCTION_SETTINGS_POSTFIX_DATASET)continue;if(t.substring(t.length-s.INSTRUCTION_VARS_POSTFIX_DATASET.length)===s.INSTRUCTION_VARS_POSTFIX_DATASET)continue;if(t!==s.MIMOTO_PREFIX+"Id"&&t.substring(t.length-s.INSTRUCTION_ID_POSTFIX_DATASET.length)===s.INSTRUCTION_ID_POSTFIX_DATASET)continue;if(e.hasAttribute(s.DATA_MIMOTO_ID)||this._tagNodeWithID(e),0===e.dataset[t].indexOf(s.DATA_MIMOTO_VIEW))continue;if(0===e.dataset[t].indexOf(s.DATA_MIMOTO_STATUS))continue;let n=t.substring(s.MIMOTO_PREFIX.length+i.replace(/-/g,"").substring(10).length).toLowerCase();if(!s.INSTRUCTIONS_ALL.includes(i))continue;let r={type:i,group:n,value:e.dataset[t],settings:e.hasAttribute(i+s.INSTRUCTION_SETTINGS_POSTFIX)?e.getAttribute(i+s.INSTRUCTION_SETTINGS_POSTFIX):void 0,vars:e.hasAttribute(i+s.INSTRUCTION_VARS_POSTFIX)?e.getAttribute(i+s.INSTRUCTION_VARS_POSTFIX):void 0,id:e.hasAttribute(i+s.INSTRUCTION_ID_POSTFIX)?e.getAttribute(i+s.INSTRUCTION_ID_POSTFIX):void 0};o.push(r)}if(o.length>0){let i=new t.exports(e,o,this);this._storeSubNode(i,!1,!1)}else!0!==i&&this._parseSubNodes(e)}},_storeSubNode:function(t,e=!1){this._reportDuplicates(t,e),this.subNodes[t.id]=t,t.isView&&t.isView()&&window.Mimoto.ui.___registerView(t.view)},_reportDuplicates:function(t,e=!1){let i=this.getNodeList(),o=t.getNodeList();Object.keys(o).slice().reverse().forEach((t=>{!0!==e&&void 0!==i[t]&&s.addHint(o[t].elNode,'Duplicate data-mimoto-id "'+t+'"')}))},_cleanupNode:function(t){delete t.parent.subNodes[t.id]},_parseSubNodes:function(t){let e=t.children.length;for(let i=0;i<e;i++)this._parseNode(t.children[i])},_collectInstructions:function(t){t.forEach((t=>{let e=new n(t.type,t.group,t.value,t.settings,t.vars,this,{id:t.id});this.instructions[e.id]=e}))},_tagNodeWithID:function(e){let i=t.exports.TYPE+"."+c.process().toUpperCase();return e.setAttribute(s.DATA_MIMOTO_ID,i),i},_runInstructions:function(t,e){for(let e in this.instructions)t.includes(this.instructions[e].type)&&this.instructions[e].execute().then((()=>{})).catch((t=>{}))}}},889:(t,e,i)=>{"use strict";const o=i(752),n=i(948),s=i(697);t.exports=function(t){this._instruction=t,this._eventListeners={},this._eventHandlers={}},t.exports.TYPE="MimotoActionInstruction",t.exports.prototype={update:function(t){if(Array.isArray(t)&&0!==t.length&&t[0]&&t[0].type)switch(this.reset(),t[0].type){case o.ARGUMENT_TYPE_CALLBACK:case o.ARGUMENT_TYPE_ARRAY:this._eventListeners[o.MIMOTOSCRIPT_ACTION_TYPES[o.CONSTANT_EVENT_CLICK]]=t,this._setEventHandler(o.MIMOTOSCRIPT_ACTION_TYPES[o.CONSTANT_EVENT_CLICK]);break;case o.ARGUMENT_TYPE_OBJECT:t[0].arguments.forEach((t=>{this._eventListeners[o.MIMOTOSCRIPT_ACTION_TYPES[t.key]]=[t],this._setEventHandler(o.MIMOTOSCRIPT_ACTION_TYPES[t.key])}))}},reset:function(){for(let t in o.MIMOTOSCRIPT_ACTION_TYPES){if(!this._eventListeners[o.MIMOTOSCRIPT_ACTION_TYPES[t]])return;this._removeAllListeners(this._instruction.node.elNode,o.MIMOTOSCRIPT_ACTION_TYPES[t])}this._eventListeners={}},_setEventHandler:function(t){this._addListener(this._instruction.node.elNode,t,this._onAction.bind(this))},_onAction:function(t){if(t.stopImmediatePropagation(),t.preventDefault(),!this._eventListeners[t.type])return;let e=this._instruction.node.getDataSource(this._instruction.group,[s.TYPE,s.TYPE_FORM]),i=void 0!==e&&e.source.getValue?e.source.getValue():{},r=n.mergeDeep(this._instruction.node.getVars(),i);this._eventListeners[t.type].forEach((t=>{o.composeArgument(n.clone(t),this._instruction,r).catch((t=>{"object"==typeof t&&t.MimotoParseResponse===o.CANCEL||o.addHint(this._instruction.node.elNode,t)}))}))},_addListener:function(t,e,i,o=!1){this._eventHandlers[e]||(this._eventHandlers[e]=[]),this._eventHandlers[e].push({node:t,handler:i,capture:o}),t.addEventListener(e,i,o)},_removeAllListeners:function(t,e){this._eventHandlers[e].filter((({node:e})=>e===t)).forEach((({node:t,handler:i,capture:o})=>t.removeEventListener(e,i,o))),this._eventHandlers[e]=this._eventHandlers[e].filter((({node:e})=>e!==t))}}},995:t=>{"use strict";t.exports=function(t){this.originalAttributes={},this._instruction=t},t.exports.TYPE="MimotoAttributeInstruction",t.exports.prototype={update:function(t,e){let i=0!==Object.keys(this.originalAttributes).length;for(let e in t)!i&&this._instruction.node.elNode.getAttribute(e)&&(this.originalAttributes[e]=this._instruction.node.elNode.getAttribute(e)),!1===t[e]?this._instruction.node.elNode.removeAttribute(e):this._instruction.node.elNode.setAttribute(e,t[e])},reset:function(){for(let t in this.originalAttributes)this._instruction.node.elNode.setAttribute(t,this.originalAttributes[t]);this.originalAttributes={}}}},960:(t,e,i)=>{"use strict";const o=i(948);t.exports=function(t){this._sOriginalClasses=null,this._originalClasses=[],this._currentClasses={},this._instruction=t},t.exports.TYPE="MimotoClassInstruction",t.exports.prototype={update:function(t,e,i){null===this._sOriginalClasses&&(this._sOriginalClasses=this._instruction.node.elNode.getAttribute("class"),this._originalClasses=this._sOriginalClasses?this._storeClasses({},this._sOriginalClasses,!0):{});let n=o.clone(this._originalClasses);for(let t in this._currentClasses)void 0===this._originalClasses[t]&&(n[t]=!1);if("string"==typeof t)n=this._storeClasses(n,t,!Mimoto.data.isEmpty(t));else if(Array.isArray(t))t.forEach((t=>n=this._storeClasses(n,t,!0)));else for(let e in t)this._storeClasses(n,e,t[e]);for(let t in n)t&&(n[t]?this._instruction.node.elNode.classList.add(t):this._instruction.node.elNode.classList.remove(t));this._currentClasses=n},reset:function(){null!==this._sOriginalClasses&&this._instruction.node.elNode.setAttribute("class",this._sOriginalClasses),this._sOriginalClasses=null,this._originalClasses=[],this._currentClasses={}},_storeClasses:function(t,e,i){return this._splitClassName(e).forEach((e=>t[e]=i)),t},_splitClassName:function(t){return"string"==typeof t?t.replace(/\s\s+/g," ").split(" "):[t]}}},909:(t,e,i)=>{"use strict";const o=i(948),n=i(752),s=i(428),r=i(939),a=i(697),l=i(292),u=i(104);t.exports=function(t){this._instruction=t,this._list=null,this._value=null,this._settings=null,this._vars=null,this._current={},this._dbItemsAll=null,this._dbItemsVisible=null,this._sContainerID=null,this._aOtherContainers=null,this._rootView=null,this._sortable=null,this._bFirstItemHasBeenAdded=!1,this._bHasOwnDataSource=!1,this._aSortIndexes=null,this._sortIndexesListener=null,this._sortIndexNotes={manuallyAdded:[]},this.__construct()},t.exports.TYPE="MimotoContainerInstruction",t.exports.prototype={__construct:function(){this._sContainerID=this._instruction.node.elNode.getAttribute(n.DATA_MIMOTO_ID),window.Mimoto.ui.___registerContainer(this._instruction),this._instruction.api.setList=function(t){this._list=t}.bind(this),this._instruction.api.getList=function(){return this._list}.bind(this),this._instruction.api.addItem=function(t){this._addItem(t)}.bind(this),this._instruction.api.updateItem=function(t){this._updateItem(t)}.bind(this),this._instruction.api.removeItem=function(t){this._removeItem(t)}.bind(this),this._instruction.api.setLockState=function(t){this._setLockState(n.CONSTANT_STATE_LOCKED,!0,t)}.bind(this),this._instruction.api.unsetLockState=function(){this._unsetLockState(n.CONSTANT_STATE_LOCKED)}.bind(this),this._instruction.api.setUnlockState=function(t){this._setLockState(n.CONSTANT_STATE_UNLOCKED,!1,t)}.bind(this),this._instruction.api.unsetUnlockState=function(){this._unsetLockState(n.CONSTANT_STATE_UNLOCKED)}.bind(this),this._instruction.api.getVisibleItems=function(){return this._getDbItemsVisible()}.bind(this),this._instruction.api.flush=function(){return this._flush()}.bind(this),this._instruction.api.hasOwnDataSource=()=>this._bHasOwnDataSource,this._instruction.api.isManuallyOrdered=function(){return!1!==this._settings.sortOrder}.bind(this),this._instruction.api.storeSortIndexes=function(){this._storeSortIndexes(this._instruction.node.elNode)}.bind(this),this._instruction.node.setState(n.CONSTANT_STATE_EMPTY)},update:async function(t,e={},i={}){if(Object.keys(i).length>0&&this._current.value===t&&Mimoto.data.compare(this._current.settings,e)&&!Mimoto.data.compare(this._current.vars,i)){let t=this._instruction.node.getDataSource(this._instruction.group,[a.TYPE,a.TYPE_FORM]),e=void 0!==t&&t.source.getValue?t.source.getValue():{},n=this._settings?.addItemsAsSubview?o.mergeDeep(this._instruction.node.getVars(),i):i;return void(this._dbItemsVisible&&Object.keys(this._dbItemsVisible).forEach((t=>{let i=this._dbItemsVisible[t].view;i.internal.getNodeTree().setValues(e),i.Mimoto.ui.setVars(n)})))}this._current.value=o.clone(t),this._current.settings=o.clone(e),this._current.vars=o.clone(i),this._value=t,this._settings=e,this._vars=i,this._bHasOwnDataSource=Array.isArray(this._settings.data);let s=!1;if(!this._bHasOwnDataSource){let t=this._instruction.node.getDataSource(this._instruction.group,r.TYPE);if(s=t&&t.source&&this._list!==t.source,s){this._list=t.source;for(let t in this._dbItemsVisible)this._removeView(t)}}(null===this._dbItemsAll||s)&&(this._dbItemsAll={}),(null===this._dbItemsVisible||s)&&(this._dbItemsVisible={}),this._rootView=this._instruction.node.getRoot().view.Mimoto.ui,this._settings.sortBy||(this._settings.sortBy=n.CONSTANT_KEY),this._settings.sortReversed=!0===this._settings.sortReversed,this._settings.group=this._settings.group||n.CONSTANT_ALL,this._settings.dragging=!0===this._settings.dragging,this._settings.addItemsAsSubview=!0===this._settings.addItemsAsSubview,this._settings.sortOrder=void 0!==this._settings.sortOrder&&this._settings.sortOrder,this._settings.dragging&&this._setupSortable(),this._bHasOwnDataSource&&this._settings.data.forEach((t=>{this._addItem({key:t.key?t.key:"custom-"+u.process().toUpperCase(),value:t.value?t.value:t})}));let l=[];if(!1!==this._settings.sortOrder){let t=window.Mimoto.data.internal.realtimeDatabase(this._settings.sortOrder);l.push(new Promise(((e,i)=>{this._sortIndexesListener&&window.Mimoto.data.internal.realtimeDatabaseModules().off(t,this._sortIndexesListener),this._sortIndexesListener=window.Mimoto.data.internal.realtimeDatabaseModules().onValue(t,(t=>{let i=t.val();JSON.stringify(i)!==JSON.stringify(this._aSortIndexes)&&(this._aSortIndexes=i,Object.keys(this._dbItemsVisible).length>0&&this._aSortIndexes&&this._aSortIndexes.forEach(((t,e)=>{let i=this._instruction.node.elNode.querySelector('[data-mimoto-key="'+t+'"]');i&&i!==this._instruction.node.elNode.children[e]&&(this._instruction.node.elNode.insertBefore(i,this._instruction.node.elNode.children[e]),i.setAttribute(n.DATA_MIMOTO_SORTINDEX,e))}))),e()}))})))}Promise.all(l).then((()=>{if(s){let t=this._list.getItems();for(let e in t)this._addItem(t[e])}})).catch((t=>{}))},_addItem:function(t){this._dbItemsAll[t.key]={key:t.key,value:t.value};let e=this._getTemplate(this._dbItemsAll[t.key]);window.Mimoto.layout.hasTemplate(e)&&(this._dbItemsAll[t.key].sTemplateName=e,this._dbItemsAll[t.key].view=this._addView(t.key),this._dbItemsAll[t.key].view.Mimoto.ui.getHTML().setAttribute(n.DATA_MIMOTO_KEY,t.key),this._bFirstItemHasBeenAdded||(this._bFirstItemHasBeenAdded=!0,this._instruction.node.dispatchEvent(n.CONSTANT_EVENT_FIRST_ITEM_ADDED,t)),this._instruction.node.dispatchEvent(n.CONSTANT_EVENT_ITEM_ADDED,t),this._instruction.node.dispatchEvent(n.ITEM_COUNT,Object.keys(this._dbItemsVisible).length))},_updateItem:function(t){this._dbItemsAll[t.key].value=o.clone(t.value);let e=this._dbItemsAll[t.key].sTemplateName;if(this._dbItemsAll[t.key].sTemplateName=this._getTemplate(this._dbItemsAll[t.key]),e===this._dbItemsAll[t.key].sTemplateName&&this._dbItemsAll[t.key].sTemplateName||(void 0!==e&&(this._removeView(t.key),this._instruction.node.dispatchEvent(n.CONSTANT_EVENT_ITEM_REMOVED),this._instruction.node.dispatchEvent(n.ITEM_COUNT,Object.keys(this._dbItemsVisible).length)),this._dbItemsAll[t.key].sTemplateName)){if(e!==this._dbItemsAll[t.key].sTemplateName)return this._dbItemsAll[t.key].view=this._addView(t.key),this._instruction.node.dispatchEvent(n.CONSTANT_EVENT_ITEM_ADDED),void this._instruction.node.dispatchEvent(n.ITEM_COUNT,Object.keys(this._dbItemsVisible).length);this._moveView(t.key),this._dbItemsAll[t.key].view.internal.getNodeTree().setValues(o.clone(t.value),this._instruction.group,this._list),this._dbItemsAll[t.key].instruction.api.update(o.clone(t.value),{passiveUpdate:!0})}},_removeItem:function(t){this._removeView(t.key),delete this._dbItemsAll[t.key],this._instruction.node.dispatchEvent(n.ITEM_COUNT,Object.keys(this._dbItemsVisible).length)},_addView:function(t){this._dbItemsVisible[t]=this._dbItemsAll[t];let e,o=this._getSortPosition(t),r={position:o.position,vars:this._vars},a=!0===this._settings.addItemsAsSubview?"addSubview":"addView",l=this._rootView[a](this._dbItemsAll[t].sTemplateName,this._sContainerID,r);if(o.isUnorderedItem||l.Mimoto.ui.getHTML().setAttribute(n.DATA_MIMOTO_SORTINDEX,o.position),l.Mimoto.ui.getHTML().setAttribute(n.DATA_MIMOTO_KEY,t),this._list){const o=i(25);e=this._dbItemsAll[t].instruction=new o(n.DATA_MIMOTO_DOCUMENT,this._instruction.group,this._list.getQuery()+"/"+t,void 0,void 0),l.internal.getNodeTree().addInstruction(e)}this._dbItemsAll[t].containingNodeID=this._instruction.node.getRoot().findBridgeNodeByView(l),this._list&&(e.disableAutoRun(),e._output.update(this._list.getQuery()+"/"+t),e.api.setValue(this._dbItemsAll[t].value)),l.internal.run(l.internal.getNodeTree().subNodes),this._list?(setTimeout((()=>l.internal.getNodeTree().setValues(this._dbItemsAll[t].value,e.group,e)),0),e.api.setLocalMethod("remove",{scope:this._list,method:this._list.remove,arguments:[t]})):setTimeout((()=>l.internal.getNodeTree().setValues(this._dbItemsAll[t].value)),0);let u=l.internal.getNodeTree().findNodesByInstructionType(n.DATA_MIMOTO_DRAGHANDLE);this._settings.dragging&&0===u.length&&l.Mimoto.ui.getHTML().classList.add(s.DRAGHANDLE);let c=Object.keys(this._dbItemsVisible).length;return c>0&&this._instruction.node.unsetState(n.CONSTANT_STATE_EMPTY),this._instruction.broadcast({DATA_ITEM_COUNT:c}),l},_getSortPosition:function(t){let e={isUnorderedItem:!1,position:-1};return!1!==this._aSortIndexes&&Array.isArray(this._aSortIndexes)&&(e.position=this._getSortIndex(t)),e.position<0&&(e.position=this._getListItemPosition(t),!1!==this._aSortIndexes&&(e.isUnorderedItem=!0)),e},_removeView:function(t){if(delete this._dbItemsVisible[t],!this._dbItemsAll[t].view)return;this._rootView.removeView(this._dbItemsAll[t].containingNodeID),delete this._dbItemsAll[t].view;let e=Object.keys(this._dbItemsVisible).length;0===e&&this._instruction.node.setState(n.CONSTANT_STATE_EMPTY),this._instruction.broadcast({DATA_ITEM_COUNT:e})},_moveView:function(t){let e=this._getSortPosition(t);e.position!==this._rootView.getPosition(this._dbItemsAll[t].containingNodeID,this._sContainerID)&&this._rootView.moveTo(this._dbItemsAll[t].containingNodeID,this._sContainerID,e.position)},_getListItemPosition:function(t){let e=Object.keys(this._dbItemsVisible);if(e.sort(),this._settings.sortBy!==n.CONSTANT_KEY){let e=null;if("string"==typeof this._settings.sortBy&&(e=[this._settings.sortBy]),Array.isArray(this._settings.sortBy)&&(e=this._settings.sortBy),e){!0===this._settings.sortReversed&&(e=e.map((t=>"-"+t)));let i=[];for(let t in this._dbItemsVisible){let e=o.clone(this._dbItemsVisible[t].value);e._key=t,i.push(e)}return i=i.sort(o.sortByKeys(e)),i.findIndex((e=>e._key===t))}}return!0===this._settings.sortReversed&&(e=e.reverse()),e.indexOf(t)},_getTemplate:function(t){let e=null;if(this._instruction.parser.settings?.deny){if(!0===this._instruction.parser.settings.deny)return e;if(o.compareValuesInObjects(this._instruction.parser.settings.deny,t.value))return e}if(this._instruction.parser.settings?.allow){if(!1===this._instruction.parser.settings.allow)return e;if(!o.compareValuesInObjects(this._instruction.parser.settings.allow,t.value))return e}if("object"==typeof this._value){for(let i in this._value)if(!0===this._value[i]||o.compareValuesInObjects(this._value[i],t.value)){e=i;break}}else e=this._value;if(this._settings.filter&&"function"==typeof this._settings.filter){let i=this._settings.filter(o.createInstructionExtensionObject(this._value,this._settings,this._vars,this._instruction.node.elNode,this._instruction.id,t));!1===i?e=null:"string"==typeof i&&(e=i)}return e},_setupSortable:function(){this._sortable&&(this._sortable.destroy(),delete this._sortable),this._sortable=l.create(this._instruction.node.elNode,{group:{name:this._settings.group},handle:"."+s.DRAGHANDLE,sort:!1!==this._settings.sortOrder,ghostClass:"Mimoto_SortHandle--ghost",animation:150,delay:2,invertSwap:!1,invertedSwapThreshold:5,emptyInsertThreshold:20,forceFallback:!0,onClone:this._onDragClone.bind(this),onStart:this._onDragStart.bind(this),onEnd:this._onDragEnd.bind(this)})},_onDragClone:function(t){let e=t.item.getAttribute(n.DATA_MIMOTO_KEY),i=this._dbItemsAll[e].view;for(let t in i.internal.getNodeTree().subNodes)i.internal.getNodeTree().subNodes[t].setState(n.CONSTANT_STATE_DRAGGING)},_onDragStart:function(t){let e=t.item.getAttribute(n.DATA_MIMOTO_KEY),i=this._dbItemsAll[e].instruction.api.getValue(),s=window.Mimoto.ui.___getAllContainers();this._aOtherContainer=[];for(let t in s){if(s[t]===this._instruction)continue;let e=s[t].parser.settings.group===this._instruction.parser.settings.group;s[t].parser.settings.deny&&o.compareValuesInObjects(s[t].parser.settings.deny,i)&&(s[t].api.setLockState(e),this._aOtherContainer.push({key:t,locked:!0})),s[t].parser.settings.allow&&!o.compareValuesInObjects(s[t].parser.settings.allow,i)&&(s[t].api.setLockState(e),this._aOtherContainer.push({key:t,locked:!0})),s[t].parser.settings.inherit===this._instruction.parser.settings.inherit&&o.compareValuesInObjects(s[t].parser.settings.inherit,this._instruction.parser.settings.inherit)&&(s[t].api.setLockState(e),this._aOtherContainer.push({key:t,locked:!0})),s[t].api.getList(),this._instruction.api.getList(),s[t].api.setUnlockState(e),this._aOtherContainer.push({key:t,unlocked:!0})}},_onDragEnd:function(t){let e=t.item.getAttribute(n.DATA_MIMOTO_KEY),i=t.to.getAttribute(n.DATA_MIMOTO_CONTAINERID),s=t.from.getAttribute(n.DATA_MIMOTO_CONTAINERID),r=this._dbItemsAll[e].view;for(let t in r.internal.getNodeTree().subNodes)r.internal.getNodeTree().subNodes[t].unsetState(n.CONSTANT_STATE_DRAGGING);this._aOtherContainer.forEach((t=>{t.locked&&window.Mimoto.ui.___getContainer(t.key).api.unsetLockState(),t.unlocked&&window.Mimoto.ui.___getContainer(t.key).api.unsetUnlockState()}));let a=window.Mimoto.ui.___getContainer(i),l=window.Mimoto.ui.___getContainer(s);if(a===l)return void(!1!==this._settings.sortOrder&&this._storeSortIndexes(this._instruction.node.elNode));let u=this._dbItemsAll[e].instruction.api.getValue();return a.api.getList()===l.api.getList()?(Mimoto.log("Same list!"),(l.api.isManuallyOrdered()||a.api.isManuallyOrdered())&&(l.api.isManuallyOrdered()&&l.api.storeSortIndexes(),a.api.isManuallyOrdered()&&a.api.storeSortIndexes()),t.item.parentNode.removeChild(t.item),void(a.parser.settings.inherit&&this._dbItemsAll[e].instruction.api.update(o.clone(a.parser.settings.inherit),{instantSave:!0}))):(a.parser.settings.inherit&&(u=o.mergeDeep(u,a.parser.settings.inherit)),a.api.getList().getQuery()===l.api.getList().getQuery()?(l.api.isManuallyOrdered()||a.api.isManuallyOrdered()?(l.api.isManuallyOrdered()&&l.api.storeSortIndexes(),a.api.isManuallyOrdered()&&a.api.storeSortIndexes()):this._moveView(e),void this._dbItemsAll[e].instruction.api.update(u)):(a.api.getList().add(u),void(a.parser.settings.clone||l.api.getList().remove(e))))},_getSortIndex:function(t){return this._aSortIndexes.findIndex((e=>e===t))},_storeSortIndexes:function(){this._aSortIndexes||(this._aSortIndexes=Object.keys(this._dbItemsVisible)),this._aSortIndexes=[];let t=this._instruction.node.elNode.children.length;for(let e=0;e<t;e++){let t=this._instruction.node.elNode.children[e].getAttribute(n.DATA_MIMOTO_KEY);this._aSortIndexes.push(t)}let e=window.Mimoto.data.internal.realtimeDatabase(this._settings.sortOrder);window.Mimoto.data.internal.realtimeDatabaseModules().set(e,this._aSortIndexes),this._updateSortIndexes()},_updateSortIndexes:function(){if(null===this._aSortIndexes)return;let t=this._instruction.node.elNode.children.length;for(let e=0;e<t;e++){let t=this._getSortIndex(this._instruction.node.elNode.children[e].getAttribute(n.DATA_MIMOTO_KEY));-1!==t&&this._instruction.node.elNode.children[e].setAttribute(n.DATA_MIMOTO_SORTINDEX,t)}},_addItemToSortIndexAfterManualSort:function(t,e){!1!==this._settings.sortOrder&&(this._aSortIndexes||(this._aSortIndexes=Object.keys(this._dbItemsVisible)),this._aSortIndexes.splice(e,0,t),this._sortIndexNotes.manuallyAdded.push({key:t,position:e}),this._storeSortIndexes())},_setLockState:function(t,e=!1,i=!1){this._settings.dragging&&e&&(this._sortable.options.disabled=e),i&&this._instruction.node.setState(t)},_unsetLockState:function(t){this._settings.dragging&&(this._sortable.options.disabled=!1),this._instruction.node.unsetState(t)},_getDbItemsVisible:function(){return this._dbItemsVisible},_flush:function(){for(let t in this._dbItemsAll)this._removeView(t)}}},444:(t,e,i)=>{"use strict";const o=i(697),n=i(752),s=i(948);t.exports=function(e){this._document=null,this._value=null,this._settings=null,this._vars=null,this._bAutoRun=!0,this._instruction=e,this._type=t.exports.TYPE,this.__construct()},t.exports.TYPE="MimotoDocumentInstruction",t.exports.prototype={__construct:function(){this._instruction.api.update=(t,e)=>this._document.update(t,e),this._instruction.api.setLocalMethod=(t,e)=>this._document.localMethods[t]=e,this._instruction.api.getValue=()=>this._document.getValue(),this._instruction.api.setValue=t=>this._document.setValue(t),this._instruction.api.updateValue=t=>this._document.updateValue(t);const t=i(401);this._type===t.TYPE&&(this._instruction.api.initLocalDB=(t,e,i)=>{this._document=new o(t,e),i&&this._document.updateValue(i),this._document.localMethods={},this._document.localMethods.update={scope:this._document,method:this._document.update},this._instruction.node.addDataSource({type:o.TYPE_FORM,source:this._document,originInstruction:this._instruction,dispatchers:[this._document.addEventListener(o.KEY,(t=>{this._onKey(t)})),this._document.addEventListener(o.DATA,(t=>{this._onData(t)}))]})})},update:function(t,e,i){JSON.stringify(t)===JSON.stringify(this._value)&&JSON.stringify(e)===JSON.stringify(this._settings)&&JSON.stringify(i)===JSON.stringify(this._vars)||(this._value=t,this._settings=e,this._vars=i,this._document?this._document.reload(t,e):(this._document=new o(t,e),this._document.localMethods||(this._document.localMethods={}),this._document.localMethods.update={scope:this._document,method:this._document.update},this._document.localMethods.store={scope:this._document,method:this._document.store},this._document.localMethods.delete={scope:this._document,method:this._document.delete},this._document.localMethods.upload={scope:this._document,method:this._document.upload},this._document.localMethods.download={scope:this._document,method:this._document.download},this._document.localMethods.move={scope:this._document,method:this._document.move},this._instruction.node.addDataSource({type:o.TYPE,source:this._document,originInstruction:this._instruction,dispatchers:[this._document.addEventListener(o.DATA,(t=>{this._onData(t)})),this._document.addEventListener(o.DELETED,(t=>{this._onDeleted(t)})),this._document.addEventListener(o.ERROR,(t=>{this._onError(t)}))]}),this._bAutoRun&&this._document.load()))},disableAutoRun:function(){this._bAutoRun=!1},_onKey:function(t){let e=t.data;this._instruction.node.dispatchEvent(n.CONSTANT_EVENT_KEY,e)},_onData:function(t){let e=this._vars?s.mergeDeep(this._vars,t.data):t.data;this._instruction.node.setValues(e,this._instruction.group,this._instruction)},_onDeleted:function(t){let e=this._vars?s.mergeDeep(this._vars,t.data):t.data;this._instruction.node.dispatchEvent(n.CONSTANT_EVENT_DELETED,e)},_onError:function(t){let e=this._vars?s.mergeDeep(this._vars,t.data):t.data;this._instruction.node.dispatchEvent(n.CONSTANT_EVENT_ERROR,e)}}},428:t=>{"use strict";t.exports=function(t){this._instruction=t},t.exports.TYPE="MimotoDragHandleInstruction",t.exports.DRAGHANDLE="MimotoDragHandle",t.exports.prototype={update:function(e,i){this._instruction.node.elNode.classList.add(t.exports.DRAGHANDLE)},reset:function(){this._instruction.node.elNode.classList.remove(t.exports.DRAGHANDLE)}}},511:(t,e,i)=>{"use strict";const o=i(752),n=i(948);t.exports=function(t){this._instruction=t,this._eventListeners={},this.__construct()},t.exports.TYPE="MimotoEventInstruction",t.exports.prototype={__construct:function(){this._instruction.api.dispatchEvent=function(t,e=null){this._onEvent(t,e)}.bind(this)},update:function(t){if((Array.isArray(t)||!(t.length>1))&&(this.reset(),t[0]&&t[0].type&&t[0].type===o.ARGUMENT_TYPE_OBJECT))t[0].arguments.forEach((t=>{t.insertedByEventInstruction||void 0!==t.key&&(this._eventListeners[t.key.toUpperCase()]={type:o.ARGUMENT_TYPE_CALLBACK,name:o.ARGUMENT_TYPE_CHAIN,group:this._instruction.group,arguments:[{type:o.ARGUMENT_TYPE_CALLBACK,name:o.ARGUMENT_TYPE_CHAIN_EVENTDATA,group:this._instruction.group,arguments:[null]},t],insertedByEventInstruction:!0})}))},reset:function(){this._eventListeners={}},_onEvent:function(t,e){if(!this._eventListeners[t])return;this._eventListeners[t].arguments[0].arguments[0]=e;let i=this._instruction.node.getDataSource(this._instruction.group),s=void 0!==i&&i.source.getValue?i.source.getValue():{},r=n.mergeDeep(this._instruction.node.getVars(),s);o.composeArgument(n.clone(this._eventListeners[t]),this._instruction,r).catch((t=>{"object"==typeof t&&t.MimotoParseResponse===o.CANCEL||o.addHint(this._instruction.node.elNode,t)}))}}},401:(t,e,i)=>{"use strict";const o=i(444);t.exports=function(e){this._instruction=e,this._type=t.exports.TYPE,this.__construct()},t.exports.TYPE="MimotoFormInstruction",t.exports.prototype=o.prototype},214:(t,e,i)=>{"use strict";const o=i(752),n=i(948),s=i(46),r=i(697);t.exports=function(t){this._originalInnerHTML=null,this._bFirstRun=!0,this._bIsEmpty=!1,this._value=null,this._settings=null,this._uploadedFile=null,this._instruction=t,this.__construct()},t.exports.TYPE="MimotoInputInstruction",t.exports.prototype={__construct:function(){},update:function(t,e={}){if(null===this._originalInnerHTML&&(this._originalInnerHTML=this._instruction.node.elNode.innerHTML),this._value=t,this._settings=e,this._settings.selectOnTabEntry=!0===this._settings.selectOnTabEntry,this._settings.autoSave=!0===this._settings.autoSave,this._settings.multiline=!0===this._settings.multiline,this._settings.html=!0===this._settings.html,this._settings.replace=!!this._settings.replace&&this._settings.replace,this._settings.validation=!(!this._settings.validation||"string"!=typeof this._settings.validation)&&this._settings.validation,this._settings.storeInvalid=!0===this._settings.storeInvalid,this._settings.collectInstant=!0===this._settings.collectInstant,this._settings.editable=!1!==this._settings.editable,this._settings.autoFocus=!0===this._settings.autoFocus,this._updateEmptyState(t),"img"===this._instruction.node.elNode.tagName.toLowerCase())this._instruction.node.elNode.setAttribute("src",t);else this._instruction.node.elNode.innerHTML=t||e.placeholder||"",this._settings.validation&&this._validateValue(t),this._instruction.node.elNode.setAttribute("contenteditable",this._settings.editable),void 0!==t&&this._connectToForm(t);if(this._settings.editable?this._instruction.node.setState(o.CONSTANT_STATE_EDITABLE):this._instruction.node.unsetState(o.CONSTANT_STATE_EDITABLE),this._bFirstRun)if(this._bFirstRun=!1,"img"===this._instruction.node.elNode.tagName.toLowerCase())this._instruction.node.elNode.addEventListener("click",this._onImageClick.bind(this,this._instruction));else this._instruction.node.elNode.addEventListener("keydown",this._onInputKeyDown.bind(this,this._instruction)),this._instruction.node.elNode.addEventListener("input",this._onInput.bind(this,this._instruction)),this._instruction.node.elNode.addEventListener("focus",this._onFocus.bind(this,this._instruction)),this._instruction.node.elNode.addEventListener("blur",this._onBlur.bind(this,this._instruction)),this._settings.autoFocus&&this._instruction.node.elNode.focus()},reset:function(){null!==this._originalInnerHTML&&(this._instruction.node.elNode.innerHTML=this._originalInnerHTML),this._instruction.node.elNode.setAttribute("contenteditable","false"),this._originalInnerHTML=null},discard:function(){this._instruction.node.elNode.removeEventListener("click",this._onImageClick.bind(this,this._instruction)),this._instruction.node.elNode.removeEventListener("keydown",this._onInputKeyDown.bind(this,this._instruction)),this._instruction.node.elNode.removeEventListener("input",this._onInput.bind(this,this._instruction)),this._instruction.node.elNode.removeEventListener("focus",this._onFocus.bind(this,this._instruction)),this._instruction.node.elNode.removeEventListener("blur",this._onBlur.bind(this,this._instruction))},_onInputKeyDown:function(t,e){if(13===e.keyCode&&!e.shiftKey||"Escape"===e.key){if(e.stopPropagation(),"Escape"===e.key)this._setValue(this._value||this._settings.placeholder||"");else{if(this._settings.multiline)return;this._setValue(t.node.elNode.innerText.trim())}t.node.elNode.blur()}},_setValue:function(t){if("input"===this._instruction.node.elNode.tagName.toLowerCase())this._instruction.node.elNode.value=t;else this._settings.html?this._instruction.node.elNode.innerHTML=t:this._instruction.node.elNode.innerText=t},_getValue:function(){switch(this._instruction.node.elNode.tagName.toLowerCase()){case"img":break;case"input":return this._instruction.node.elNode.value;default:return this._settings.html?this._instruction.node.elNode.innerHTML:this._instruction.node.elNode.innerText}},_onInput:function(t,e){this._settings.parser&&"function"==typeof this._settings.parser&&this._settings.parser(n.createInstructionExtensionObject(this._value,this._settings,this._vars,this._instruction.node.elNode,this._instruction.id)),this._settings.collectInstant&&this._connectToForm(this._getValue(),!0),!1!==this._settings.autoSave&&this._storeValue(t,!1)},_onFocus:function(t,e){this._bIsEmpty&&(this._instruction.node.elNode.innerHTML=""),this._instruction.user.isEditing=!0,this._instruction.node.unsetState(o.CONSTANT_STATE_ERROR),window.Mimoto.ui.isTabDown()&&(this._instruction.node.elNode.classList.add("Mimoto_InvisibleCaret"),this._instruction.node.elNode.addEventListener("keyup",this._onKeyUp.bind(this,this._instruction),{once:!0})),this._instruction.node.unsetState(o.CONSTANT_STATE_EMPTY),this._instruction.node.setState(o.CONSTANT_STATE_FOCUSED),this.realtime&&this.realtime.dispatch("FOCUS")},_onKeyUp:function(t,e){if("Tab"===e.key)if(this._instruction.node.elNode.classList.remove("Mimoto_InvisibleCaret"),!0===this._settings.selectOnTabEntry)s.selectText(this._instruction.node.elNode);else s.setCursorPosition(this._instruction.node.elNode,this._instruction.node.elNode.innerHTML.length)},_onBlur:function(t,e){if(this._instruction.user.isEditing=!1,this._settings.replace&&"object"==typeof this._settings.replace&&this._settings.replace.from&&this._settings.replace.to&&this._setValue(this._getValue().replace(new RegExp(this._settings.replace.from,"g"),this._settings.replace.to)),this._settings.collectInstant||this._connectToForm(this._getValue(),!0),this._settings.validation&&!this._validateValue(this._getValue())&&!this._settings.storeInvalid)return;let i=!(Mimoto.data.isEmpty(this._getValue())&&Mimoto.data.isEmpty(this._value))||this._getValue()===this._value;this._updateEmptyState(this._getValue()),this._instruction.node.unsetState(o.CONSTANT_STATE_FOCUSED),this.realtime&&this.realtime.dispatch("BLUR"),i&&this._storeValue(t,!0),this._showPlaceholder()},_showPlaceholder:function(){this._bIsEmpty&&Mimoto.data.isEmpty(this._getValue())&&this._settings.placeholder&&this._setValue(this._settings.placeholder)},_onImageClick:function(t){let e=this._instruction.parser[o.INSTRUCTION_VALUE_PREPARSED],i=this._instruction.node.getDataSource(this._instruction.group);void 0!==i||(i=this._instruction.node.getDataSource(this._instruction.group,r.TYPE_FORM)),i&&i.source.localMethods.upload&&i.source.localMethods.upload.method.apply(i.source.localMethods.upload.scope,[e,{elPreview:this._instruction.node.elNode,accept:this._settings.accept}])},_storeValue:function(t,e=!0){let i,n=!1,s=this._instruction.parser.valueParseIndex?.[0]?.name||!1;if(!1===s)return;if("img"===this._instruction.node.elNode.tagName.toLowerCase())this._uploadedFile?(i=o.buildDeepValue(s,this._uploadedFile),n=s):i=o.buildDeepValue(s,this._instruction.node.elNode.getAttribute("src"));else i=o.buildDeepValue(s,this._getValue());let a=this._instruction.node.getDataSource(this._instruction.group),l=void 0!==a;l||(a=this._instruction.node.getDataSource(this._instruction.group,r.TYPE_FORM)),a&&a.source.localMethods.update&&a.source.localMethods.update.method.apply(a.source.localMethods.update.scope,[i,{instantSave:l&&e,dontStore:!l,containsFile:n}])},_updateEmptyState:function(t){this._bIsEmpty=Mimoto.data.isEmpty(t),this._bIsEmpty?this._instruction.node.setState(o.CONSTANT_STATE_EMPTY):this._instruction.node.unsetState(o.CONSTANT_STATE_EMPTY)},_validateValue:function(t,e=!0){if(void 0===t)return;let i;if(t=t.trim(),"/"===this._settings.validation.substring(0,1)){let t=this._settings.validation.substring(1).lastIndexOf("/");t>-1&&(i=new RegExp(this._settings.validation.substring(1,t+1),this._settings.validation.substring(t+2)))}i||(i=new RegExp(this._settings.validation));let n=i.test(t);return e&&(n?this._instruction.node.unsetState(o.CONSTANT_STATE_ERROR):this._instruction.node.setState(o.CONSTANT_STATE_ERROR)),n},_connectToForm:function(t,e=!1){if(!this._settings.collect)return;let i={},o=!0===this._settings.collect||"string"!=typeof this._settings.collect?this._instruction.parser.valuePreparsed:this._settings.collect;if(i[o]=t||"",!e&&(void 0===t||i[o]===t))return;let n=this._instruction.node.getDataSource(this._instruction.group,r.TYPE_FORM);n&&n.source.localMethods.collect&&n.source.localMethods.collect.method.apply(n.source.localMethods.collect.scope,[i])}}},311:(t,e,i)=>{"use strict";const o=i(752),n=i(749),s=i(948);t.exports=function(e){this._parentNode=null,this._originalNode=null,this._originalRootNodes=null,this._originalNodesWithTargets=null,this._layoutView=null,this._instruction=e,this._type=t.exports.TYPE,this.__construct()},t.exports.TYPE="MimotoLayoutInstruction",t.exports.TOP="TOP",t.exports.BOTTOM="BOTTOM",t.exports.ORIGINAL="ORIGINAL",t.exports.REVERSED="REVERSED",t.exports.prototype={__construct:function(){this._initData(),"xxx"===this._instruction.id&&Mimoto.warn("LAYOUT elNode =",this._instruction.node.elNode)},update:function(e,i={},r={}){if(!Mimoto.layout.hasTemplate(e))return void(null!==this._originalNode&&this.reset());void 0===i.inheritAttributes&&(i.inheritAttributes=!1);let a=null===this._originalNode;if(a){i.position=n.findElementIndexInContainer(this._instruction.node.elNode),this._instruction.node.elNode.parentNode.hasAttribute(o.DATA_MIMOTO_ID),this._parentNode=this._instruction.node.parent,this._originalNode=this._instruction.node.parent.subNodes[this._instruction.node.id],Array.from(this._instruction.node.elNode.children).forEach(((t,e)=>{let i=null;i=t.hasAttribute(o.DATA_MIMOTO_ID)?this._instruction.node.findNodeByID(t.getAttribute(o.DATA_MIMOTO_ID)):this._instruction.node.convertElementToNode(t,this._instruction.node),this._originalRootNodes.push(i)}));let t=this._instruction.node.findNodesByInstructionType(o.DATA_MIMOTO_TARGET,this._instruction.group,!0);t.forEach((t=>{t.node.parent.elNode!==t.node.elNode.parentNode&&t.node.createDirectParentNode()})),t.slice().reverse().forEach((t=>{let e=t.node.parent.elNode===this._instruction.node.elNode,i=t.node.parent.elNode===t.node.elNode.parentNode?t.node.parent.elNode:t.node.elNode.parentNode,o=Array.from(i.children).indexOf(t.node.elNode);this._originalNodesWithTargets[t.node.id]={id:t.node.id,instruction:t,node:t.node,originalParentNodeID:t.node.parent.id,position:o,isRootNode:e}}));let e=[];Object.keys(this._originalNodesWithTargets).slice().reverse().forEach((t=>{e[t]=this._originalNodesWithTargets[t]})),this._originalNodesWithTargets=e}a||this._restoreNodes();let l=["MimotoSubviewInstruction",t.exports.TYPE].includes(this._type)?"replaceWithSubview":"replaceWithView";i.vars=s.mergeDeep(r,i.vars||{}),this._layoutView=this._instruction.node.getRoot().view.Mimoto.ui[l](e,this._instruction.node.id,i),this._originalRootNodes.forEach(((e,o)=>{let n=i?.order&&[t.exports.ORIGINAL,t.exports.REVERSED].includes(i.order.toUpperCase())?i.order.toUpperCase():t.exports.ORIGINAL;e.parent&&(e=e.parent.cutNode(e));let s=this._layoutView.internal.getNodeTree().subNodes,r=Object.keys(s).length?s[Object.keys(s)[0]]:this._layoutView.internal.getNodeTree();if(isNaN(i?.position))switch(i?.position&&[t.exports.BOTTOM,t.exports.TOP].includes(i.position.toUpperCase())?i.position.toUpperCase():t.exports.BOTTOM){case t.exports.TOP:switch(n){case t.exports.REVERSED:r.pasteNode(e,0);break;case t.exports.ORIGINAL:default:r.pasteNode(e,o)}break;case t.exports.BOTTOM:default:switch(n){case t.exports.REVERSED:r.pasteNode(e,r.elNode.children.length-o);break;case t.exports.ORIGINAL:default:r.pasteNode(e)}}else{let s=i.position;switch(n){case t.exports.REVERSED:r.pasteNode(e,s+1);break;case t.exports.ORIGINAL:default:r.pasteNode(e,s+1+o)}}}));for(let t in this._originalNodesWithTargets){let e=this._originalNodesWithTargets[t],i=e.instruction.parser.value,o=e.instruction.parser.settings,n=this._layoutView.internal.getNodeTree().findNodeByID(i);if(!1===n&&!0===o?.hideWhenNotFound){null!==e.node.parent&&e.node.parent.cutNode(e.node,!0);continue}let s=e.node.parent?e.node.parent.cutNode(e.node):e.node;n.pasteNode(s)}if(i?.inheritAttributes){let t=Array.isArray(i.inheritAttributes);this._instruction.node.elNode.getAttributeNames().forEach((e=>{[o.DATA_MIMOTO_STATUS].includes(e)||t&&!i.inheritAttributes.includes(e)||(Mimoto.log("Inherit attributes sAttributeName =",e),this._layoutView.Mimoto.ui.getHTML().setAttribute(e,this._instruction.node.elNode.getAttribute(e)))}))}},reset:function(){null!==this._originalNode&&(this._restoreNodes(),this._initData())},_initData:function(){this._parentNode=null,this._originalNode=null,this._originalRootNodes=[],this._originalNodesWithTargets={},this._layoutView=null,this._originalInstructionSettings={}},_restoreNodes:function(){this._parentNode.cutNode(this._originalNode.id);this._originalRootNodes.forEach(((t,e)=>{t.parent&&(t=t.parent.cutNode(t)),this._originalNode.pasteNode(t)}));for(let t in this._originalNodesWithTargets){let e=this._originalNodesWithTargets[t];e.node.parent?.id!==e.originalParentNodeID&&this._instruction.node.findNodeByID(e.originalParentNodeID).pasteNode(e.node,e.position)}this._parentNode.pasteNode(this._originalNode)}}},527:(t,e,i)=>{"use strict";const o=i(939),n=i(948),s=i(752);t.exports=function(t){this._instruction=t,this._list=null,this._value=null},t.exports.TYPE="MimotoListInstruction",t.exports.prototype={update:function(t,e){if(/.*\(.*\)/.test(t)){null!==this._value&&this._value!==t&&this._instruction.node.getContainers(this._instruction).forEach((t=>t.api.flush())),this._instruction.node.setState(s.CONSTANT_STATE_BUSY),s.dissectInstructionValue(t).then((t=>{if(!t[0])return;let e={type:s.ARGUMENT_TYPE_CALLBACK,name:t[0].name,arguments:t[0].arguments};s.executeCallback(e,this._instruction,{}).then((t=>{("string"==typeof t?JSON.parse(t):t).forEach((t=>this._list.add(t))),this._instruction.node.unsetState(s.CONSTANT_STATE_BUSY)}))})).catch((t=>Mimoto.log("error =",t))),t="*"}this.___continueUpdate(t,e)},___continueUpdate:function(t,e){if(this._value=t,null!==this._list)return Mimoto.log("RELOAD =",e),void this._list.reload(t,e);this._list=new o(t,e),this._list.localMethods={add:{scope:this._list,method:this._list.add},updateAll:{scope:this,method:this.updateAll},setAll:{scope:this._list,method:this._list.setAll},moveAll:{scope:this._list,method:this._list.moveAll},removeAll:{scope:this._list,method:this._list.removeAll},set:{scope:this._list,method:this._list.set}},this._instruction.node.addDataSource({type:o.TYPE,source:this._list,originInstruction:this._instruction,dispatchers:[this._list.addEventListener(o.ITEM_ADDED,(t=>{this._onItemAdded(t)})),this._list.addEventListener(o.ITEM_CHANGED,(t=>{this._onItemChanged(t)})),this._list.addEventListener(o.ITEM_REMOVED,(t=>{this._onItemRemoved(t)}))]}),this._instruction.node.getContainers(this._instruction).forEach((t=>t.api.setList(this._list))),setTimeout((()=>this._list.load()),1)},discard:function(){this._list.removeEventListener(o.ITEM_ADDED),this._list.removeEventListener(o.ITEM_CHANGED),this._list.removeEventListener(o.ITEM_REMOVED)},_onItemAdded:function(t){let e=t.data;this._instruction.node.getContainers(this._instruction).forEach((t=>t.api.addItem(n.clone(e)))),this._instruction.node.getRoot().view.dispatchEvent(o.ITEM_ADDED,n.clone(e))},_onItemChanged:function(t){let e=t.data;this._instruction.node.getContainers(this._instruction).forEach((t=>t.api.updateItem(n.clone(e)))),this._instruction.node.getRoot().view.dispatchEvent(o.ITEM_CHANGED,n.clone(e))},_onItemRemoved:function(t){let e=t.data;this._instruction.node.getContainers(this._instruction).forEach((t=>t.api.removeItem(n.clone(e)))),this._instruction.node.getRoot().view.dispatchEvent(o.ITEM_REMOVED,n.clone(e))},_onItemMoved:function(t){let e=t.data;Mimoto.log(""),Mimoto.warn("--- ITEM_MOVED ---"),Mimoto.log("data =",e);let i=this._instruction.domOf.length;for(let t=0;t<i;t++){let i=this._instruction.scope.classRoot.MimotoView_aInstructionsInHTML[this._instruction.domOf[t]];for(let t in i.instructions){if(t!==s.DATA_MIMOTO_CONTAINER)continue;let o=i.instructions[t].scope.elNode,n=[],r=o.children.length;for(let t=0;t<r;t++){let i=o.children[t].getAttribute(s.DATA_MIMOTO_KEY),r=parseInt(o.children[t].getAttribute(s.DATA_MIMOTO_SORTINDEX)),a=this._instruction.data.collection.getSortIndex(i);r!==a&&(n.push({collectionItem:e[i].collectionItem,collectionItemContainer:e[i].collectionItemContainer,newSortIndex:a}),o.children[t].setAttribute(s.DATA_MIMOTO_SORTINDEX,a))}let a=n.length;for(let t=0;t<a;t++){let e=n[t].newSortIndex;o.children[e]!==n[t]&&this._instruction.scope.classRoot.mimotoAddChild(n[t].collectionItem,n[t].collectionItemContainer,e)}}}this._instruction.scope.classRoot.dispatchEvent(o.ITEMS_MOVED,e)},updateAll:function(t={},e=null,i=null){let o=this._collectAll(e,i);for(let e in o)o[e].instruction.api.update(n.clone(t))},removeAll:function(){},setAll:function(){},moveAll:function(){},_collectAll:function(t={},e={}){let i={};const o=Mimoto.data.merge(t,e);return this._instruction.node.getContainers(this._instruction).forEach((t=>{let e=t.api.getVisibleItems();for(let t in e)Mimoto.data.compare(o,e[t].value)&&(i[t]=e[t])})),i}}},252:t=>{"use strict";t.exports=function(t){this._instruction=t},t.exports.TYPE="MimotoLogInstruction",t.exports.prototype={update:function(t,e){window.Mimoto.devtools.log(t)}}},804:t=>{"use strict";t.exports=function(t){this._instruction=t},t.exports.TYPE="MimotoMetaInstruction",t.exports.prototype={update:function(t,e,i){for(let e in t){let i=t[e];if(i)switch(e=e.toLowerCase(),e){case"description":this._setMetaTag(e,i),this._setMetaTag("og:"+e,i);break;case"keywords":case"author":this._setMetaTag(e,i);break;case"title":document.title=i;case"url":case"image":this._setMetaTag("og:"+e,i)}}},reset:function(){},_setMetaTag:function(t,e){let i="og:"===t.substring(0,3)?document.querySelector('meta[property="'+t+'"]'):document.querySelector('meta[name="'+t+'"]');i||(i=document.createElement("meta")),i.setAttribute("og:"===t.substring(0,3)?"property":"name",t),i.setAttribute("content",e),document.head.appendChild(i)}}},574:(t,e,i)=>{"use strict";i(752);const o=i(104);t.exports=function(t){this._instruction=t},t.exports.TYPE="MimotoNavigationInstruction",t.exports.prototype={update:function(t,e){let i=this._instruction.node.elNode.getAttribute("data-mimoto-navigation")||"navigation-"+o.process().toUpperCase();this._instruction.node.elNode.setAttribute("data-mimoto-navigation",i),"a"!==this._instruction.node.elNode.tagName.toLowerCase()||this._instruction.node.elNode.getAttribute("href")||this._instruction.node.elNode.setAttribute("href","/"),this._instruction.node.elNode.addEventListener("click",(t=>{t.metaKey||t.preventDefault(),window.Mimoto.navigation.goto(this._instruction.node.elNode.getAttribute("href"))}))},reset:function(){}}},635:t=>{"use strict";t.exports=function(e){this._document=null,this._value=null,this._settings=null,this._vars=null,this._instruction=e,this._realtimeID=null,this._type=t.exports.TYPE},t.exports.TYPE="MimotoRealtimeInstruction",t.exports.prototype={update:function(t,e,i){if(JSON.stringify(t)===JSON.stringify(this._value)&&JSON.stringify(e)===JSON.stringify(this._settings))return;this._value=t,this._settings=e,this._vars=i;let o=e&&void 0!==e.connect?e.connect:null,n=e&&void 0!==e.disconnect?e.disconnect:null,s={};s[t]={connect:o,disconnect:n},this._realtimeID&&window.Mimoto.realtime.clear(this._realtimeID),this._realtimeID=window.Mimoto.realtime.configure(s)}}},101:(t,e,i)=>{"use strict";const o=i(311);t.exports=function(e){this._instruction=e,this._type=t.exports.TYPE,this.__construct()},t.exports.TYPE="MimotoSubviewInstruction",t.exports.prototype=o.prototype},757:t=>{"use strict";t.exports=function(t){this.originalInnerHTML=null,this._instruction=t},t.exports.TYPE="MimotoValueInstruction",t.exports.prototype={update:function(t,e){null===this.originalInnerHTML&&(this.originalInnerHTML=this._instruction.node.elNode.innerHTML),this._instruction.node.elNode.innerHTML=t},reset:function(){null!==this.originalInnerText&&(this._instruction.node.elNode.innerHTML=this.originalInnerText||""),this.originalInnerText=null}}},659:(t,e,i)=>{"use strict";const o=i(311);t.exports=function(e){this._instruction=e,this._type=t.exports.TYPE,this.__construct()},t.exports.TYPE="MimotoViewInstruction",t.exports.prototype=o.prototype},836:t=>{"use strict";t.exports=function(t){this._instruction=t},t.exports.TYPE="MimotoXrayInstruction",t.exports.prototype={update:function(t,e){Mimoto.log("=============== ü©ªXRAY ================"),window.Mimoto.devtools.xray(this._instruction)}}},92:(t,e,i)=>{"use strict";const o=i(752),n=i(948);t.exports=function(t){this.originalInnerHTML=null,this._instruction=t},t.exports.TYPE="MimotoInstruction",t.exports.prototype={update:function(t="",e={},i={}){null===this.originalInnerHTML&&(this.originalInnerHTML=this._instruction.node.elNode.innerHTML),this._value=t,this._settings=e,this._vars=i;let s=t.toString()||e.placeholder||"";switch(this._instruction.node.elNode.tagName.toUpperCase()){case"IMG":this._instruction.node.elNode.src=s;break;default:if(e.parser&&"function"==typeof e.parser){e.parser(n.createInstructionExtensionObject(this._value,this._settings,this._vars,this._instruction.node.elNode,this._instruction.id));break}let t=!0===e.html?"innerHTML":"innerText";this._instruction.node.elNode[t]=s}Mimoto.data.isEmpty(t)&&this._instruction.node.setState(o.CONSTANT_STATE_EMPTY)},reset:function(){null!==this.originalInnerHTML&&(this._instruction.node.elNode.innerHTML=this.originalInnerHTML),this.originalInnerHTML=null}}},718:t=>{t.exports='<div class="MimotoTheme_DevToolsService_panel_container"> <div id="MimotoAdminTools_panel" class="MimotoTheme_DevToolsService_panel"> <div class="MimotoTheme_DevToolsService_panel_header"> <div class="MimotoTheme_DevToolsService_panel_header_title">Mimoto <span class="MimotoTheme_DevToolsService_panel_header_subtitle">Admin</span></div> <div data-mimoto-id="toggle" class="MimotoTheme_DevToolsService_panel_header_logo"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 43.43 35.46"><defs><style>.st0{fill:#FFFFFF}.cls-1,.cls-2{fill:#000000}.cls-2{font-size:4.53px;font-family:Impact}</style></defs><path class="st0" d="M0,17.7C0,29,7.7,35.5,21.1,35.5c13.6,0,21.1-6.3,21.1-17.7S34.8,0,21.1,0C7.7,0,0,6.5,0,17.7z"/><path class="cls-1" d="M0,17.73C0,29,7.71,35.46,21.15,35.46c13.63,0,21.14-6.3,21.14-17.73S34.78,0,21.15,0C7.71,0,0,6.46,0,17.73Zm5.28,0c0-8.26,5.34-12.45,15.87-12.45C37,5.28,37,14.65,37,17.73s0,12.45-15.86,12.45C10.62,30.18,5.28,26,5.28,17.73Z"/><text class="cls-2" transform="translate(38.1 5.16)">TM</text><path class="cls-1" d="M19.83,21.86c0,2.58-.8,4.67-1.79,4.67s-1.78-2.09-1.78-4.67.8-4.67,1.78-4.67S19.83,19.28,19.83,21.86Z"/><path class="cls-1" d="M27.37,21.86c0,2.58-.8,4.67-1.79,4.67s-1.78-2.09-1.78-4.67.8-4.67,1.78-4.67S27.37,19.28,27.37,21.86Z"/></svg></div> </div> <div class="MimotoTheme_DevToolsService_panel_content"> <div data-mimoto-id="MimotoAdminPanel-hints-header" class="MimotoTheme_DevToolsService_panel_block_title">üî• Hints</div> <div data-mimoto-id="MimotoAdminPanel-hints" class="MimotoTheme_DevToolsService_panel_block"></div> <div data-mimoto-id="MimotoAdminPanel-logs-header" class="MimotoTheme_DevToolsService_panel_block_title">üí¨ Logs</div> <div data-mimoto-id="MimotoAdminPanel-logs" class="MimotoTheme_DevToolsService_panel_block"></div> <div data-mimoto-id="MimotoAdminPanel-xrays-header" class="MimotoTheme_DevToolsService_panel_block_title">ü©ª X-rays</div> <div data-mimoto-id="MimotoAdminPanel-xrays" class="MimotoTheme_DevToolsService_panel_block"></div> </div> <div class="MimotoTheme_DevToolsService_panel_footer"> <div data-mimoto-id="MimotoAdminPanel-donationcallout" class="MimotoTheme_DevToolsService_panel_footer_content"> üö® - You are not registered as a donor yet!<br><a href="https://thesocialcode.com/mimoto" target="_blank">Get your license now</a> and support this project </div> <div data-mimoto-id="MimotoAdminPanel-donor" class="MimotoTheme_DevToolsService_panel_footer_content MimotoTheme_DevToolsService_panel_footer_content_license"> ‚ú® You are awesome :) Thanks for your <a href="https://thesocialcode.com/mimoto" target="_blank">support</a> üëè </div> </div> </div> </div> '},292:function(t){
/*! Sortable 1.15.1 - MIT | git://github.com/SortableJS/Sortable.git */
t.exports=function(){"use strict";function t(t,e){var i,o=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,i)),o}function e(e){for(var i=1;i<arguments.length;i++){var o=null!=arguments[i]?arguments[i]:{};i%2?t(Object(o),!0).forEach((function(t){var i,n;i=e,t=o[n=t],n in i?Object.defineProperty(i,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[n]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(){return(o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i,o=arguments[e];for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t}).apply(this,arguments)}function n(t,e){if(null==t)return{};var i,o=function(t,e){if(null==t)return{};for(var i,o={},n=Object.keys(t),s=0;s<n.length;s++)i=n[s],0<=e.indexOf(i)||(o[i]=t[i]);return o}(t,e);if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(t),s=0;s<n.length;s++)i=n[s],0<=e.indexOf(i)||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i]);return o}function s(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(i="Object"===i&&t.constructor?t.constructor.name:i)||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,o=new Array(e);i<e;i++)o[i]=t[i];return o}function a(t){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var l=a(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),u=a(/Edge/i),c=a(/firefox/i),d=a(/safari/i)&&!a(/chrome/i)&&!a(/android/i),h=a(/iP(ad|od|hone)/i),_=a(/chrome/i)&&a(/android/i),p={capture:!1,passive:!1};function T(t,e,i){t.addEventListener(e,i,!l&&p)}function m(t,e,i){t.removeEventListener(e,i,!l&&p)}function g(t,e){if(e&&(">"===e[0]&&(e=e.substring(1)),t))try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(t){return}}function f(t,e,i,o){if(t){i=i||document;do{if(null!=e&&(">"!==e[0]||t.parentNode===i)&&g(t,e)||o&&t===i)return t}while(t!==i&&(t=(n=t).host&&n!==document&&n.host.nodeType?n.host:n.parentNode))}var n;return null}var E,A=/\s+/g;function N(t,e,i){var o;t&&e&&(t.classList?t.classList[i?"add":"remove"](e):(o=(" "+t.className+" ").replace(A," ").replace(" "+e+" "," "),t.className=(o+(i?" "+e:"")).replace(A," ")))}function I(t,e,i){var o=t&&t.style;if(o){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),void 0===e?i:i[e];o[e=e in o||-1!==e.indexOf("webkit")?e:"-webkit-"+e]=i+("string"==typeof i?"":"px")}}function O(t,e){var i="";if("string"==typeof t)i=t;else do{var o=I(t,"transform")}while(o&&"none"!==o&&(i=o+" "+i),!e&&(t=t.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(i)}function M(t,e,i){if(t){var o=t.getElementsByTagName(e),n=0,s=o.length;if(i)for(;n<s;n++)i(o[n],n);return o}return[]}function S(){return document.scrollingElement||document.documentElement}function v(t,e,i,o,n){if(t.getBoundingClientRect||t===window){var s,r,a,u,c,d,h=t!==window&&t.parentNode&&t!==S()?(r=(s=t.getBoundingClientRect()).top,a=s.left,u=s.bottom,c=s.right,d=s.height,s.width):(a=r=0,u=window.innerHeight,c=window.innerWidth,d=window.innerHeight,window.innerWidth);if((e||i)&&t!==window&&(n=n||t.parentNode,!l))do{if(n&&n.getBoundingClientRect&&("none"!==I(n,"transform")||i&&"static"!==I(n,"position"))){var _=n.getBoundingClientRect();r-=_.top+parseInt(I(n,"border-top-width")),a-=_.left+parseInt(I(n,"border-left-width")),u=r+s.height,c=a+s.width;break}}while(n=n.parentNode);return o&&t!==window&&(o=(e=O(n||t))&&e.a,t=e&&e.d,e&&(u=(r/=t)+(d/=t),c=(a/=o)+(h/=o))),{top:r,left:a,bottom:u,right:c,width:h,height:d}}}function b(t){var e=v(t),i=parseInt(I(t,"padding-left")),o=parseInt(I(t,"padding-top")),n=parseInt(I(t,"padding-right")),s=parseInt(I(t,"padding-bottom"));return e.top+=o+parseInt(I(t,"border-top-width")),e.left+=i+parseInt(I(t,"border-left-width")),e.width=t.clientWidth-i-n,e.height=t.clientHeight-o-s,e.bottom=e.top+e.height,e.right=e.left+e.width,e}function w(t,e,i){for(var o=y(t,!0),n=v(t)[e];o;){var s=v(o)[i];if(!("top"===i||"left"===i?s<=n:n<=s))return o;if(o===S())break;o=y(o,!1)}return!1}function D(t,e,i,o){for(var n=0,s=0,r=t.children;s<r.length;){if("none"!==r[s].style.display&&r[s]!==Yt.ghost&&(o||r[s]!==Yt.dragged)&&f(r[s],i.draggable,t,!1)){if(n===e)return r[s];n++}s++}return null}function x(t,e){for(var i=t.lastElementChild;i&&(i===Yt.ghost||"none"===I(i,"display")||e&&!g(i,e));)i=i.previousElementSibling;return i||null}function R(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)"TEMPLATE"===t.nodeName.toUpperCase()||t===Yt.clone||e&&!g(t,e)||i++;return i}function C(t){var e=0,i=0,o=S();if(t)do{var n=(s=O(t)).a,s=s.d}while(e+=t.scrollLeft*n,i+=t.scrollTop*s,t!==o&&(t=t.parentNode));return[e,i]}function y(t,e){if(!t||!t.getBoundingClientRect)return S();var i=t,o=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var n=I(i);if(i.clientWidth<i.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!i.getBoundingClientRect||i===document.body)return S();if(o||e)return i;o=!0}}}while(i=i.parentNode);return S()}function P(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function L(t,e){return function(){var i;E||(1===(i=arguments).length?t.call(this,i[0]):t.apply(this,i),E=setTimeout((function(){E=void 0}),e))}}function U(t,e,i){t.scrollLeft+=e,t.scrollTop+=i}function V(t){var e=window.Polymer,i=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):i?i(t).clone(!0)[0]:t.cloneNode(!0)}function k(t,e){I(t,"position","absolute"),I(t,"top",e.top),I(t,"left",e.left),I(t,"width",e.width),I(t,"height",e.height)}function Y(t){I(t,"position",""),I(t,"top",""),I(t,"left",""),I(t,"width",""),I(t,"height","")}var G="Sortable"+(new Date).getTime();function H(){var t,i=[];return{captureAnimationState:function(){i=[],this.options.animation&&[].slice.call(this.el.children).forEach((function(t){var o,n;"none"!==I(t,"display")&&t!==Yt.ghost&&(i.push({target:t,rect:v(t)}),o=e({},i[i.length-1].rect),!t.thisAnimationDuration||(n=O(t,!0))&&(o.top-=n.f,o.left-=n.e),t.fromRect=o)}))},addAnimationState:function(t){i.push(t)},removeAnimationState:function(t){i.splice(function(t,e){for(var i in t)if(t.hasOwnProperty(i))for(var o in e)if(e.hasOwnProperty(o)&&e[o]===t[i][o])return Number(i);return-1}(i,{target:t}),1)},animateAll:function(e){var o=this;if(!this.options.animation)return clearTimeout(t),void("function"==typeof e&&e());var n=!1,s=0;i.forEach((function(t){var e=0,i=t.target,r=i.fromRect,a=v(i),l=i.prevFromRect,u=i.prevToRect,c=t.rect,d=O(i,!0);d&&(a.top-=d.f,a.left-=d.e),i.toRect=a,i.thisAnimationDuration&&P(l,a)&&!P(r,a)&&(c.top-a.top)/(c.left-a.left)==(r.top-a.top)/(r.left-a.left)&&(t=c,d=l,l=u,u=o.options,e=Math.sqrt(Math.pow(d.top-t.top,2)+Math.pow(d.left-t.left,2))/Math.sqrt(Math.pow(d.top-l.top,2)+Math.pow(d.left-l.left,2))*u.animation),P(a,r)||(i.prevFromRect=r,i.prevToRect=a,e=e||o.options.animation,o.animate(i,c,a,e)),e&&(n=!0,s=Math.max(s,e),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),e),i.thisAnimationDuration=e)})),clearTimeout(t),n?t=setTimeout((function(){"function"==typeof e&&e()}),s):"function"==typeof e&&e(),i=[]},animate:function(t,e,i,o){var n,s;o&&(I(t,"transition",""),I(t,"transform",""),n=(s=O(this.el))&&s.a,s=s&&s.d,n=(e.left-i.left)/(n||1),s=(e.top-i.top)/(s||1),t.animatingX=!!n,t.animatingY=!!s,I(t,"transform","translate3d("+n+"px,"+s+"px,0)"),this.forRepaintDummy=t.offsetWidth,I(t,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),I(t,"transform","translate3d(0,0,0)"),"number"==typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){I(t,"transition",""),I(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),o))}}}var F=[],B={initializeByDefault:!0},j={mount:function(t){for(var e in B)!B.hasOwnProperty(e)||e in t||(t[e]=B[e]);F.forEach((function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")})),F.push(t)},pluginEvent:function(t,i,o){var n=this;this.eventCanceled=!1,o.cancel=function(){n.eventCanceled=!0};var s=t+"Global";F.forEach((function(n){i[n.pluginName]&&(i[n.pluginName][s]&&i[n.pluginName][s](e({sortable:i},o)),i.options[n.pluginName]&&i[n.pluginName][t]&&i[n.pluginName][t](e({sortable:i},o)))}))},initializePlugins:function(t,e,i,n){for(var s in F.forEach((function(n){var s=n.pluginName;(t.options[s]||n.initializeByDefault)&&((n=new n(t,e,t.options)).sortable=t,n.options=t.options,t[s]=n,o(i,n.defaults))})),t.options){var r;t.options.hasOwnProperty(s)&&void 0!==(r=this.modifyOption(t,s,t.options[s]))&&(t.options[s]=r)}},getEventProperties:function(t,e){var i={};return F.forEach((function(n){"function"==typeof n.eventProperties&&o(i,n.eventProperties.call(e[n.pluginName],t))})),i},modifyOption:function(t,e,i){var o;return F.forEach((function(n){t[n.pluginName]&&n.optionListeners&&"function"==typeof n.optionListeners[e]&&(o=n.optionListeners[e].call(t[n.pluginName],i))})),o}};function W(t){var i=t.sortable,o=t.rootEl,n=t.name,s=t.targetEl,r=t.cloneEl,a=t.toEl,c=t.fromEl,d=t.oldIndex,h=t.newIndex,_=t.oldDraggableIndex,p=t.newDraggableIndex,T=t.originalEvent,m=t.putSortable,g=t.extraEventProperties;if(i=i||o&&o[G]){var f,E=i.options;t="on"+n.charAt(0).toUpperCase()+n.substr(1),!window.CustomEvent||l||u?(f=document.createEvent("Event")).initEvent(n,!0,!0):f=new CustomEvent(n,{bubbles:!0,cancelable:!0}),f.to=a||o,f.from=c||o,f.item=s||o,f.clone=r,f.oldIndex=d,f.newIndex=h,f.oldDraggableIndex=_,f.newDraggableIndex=p,f.originalEvent=T,f.pullMode=m?m.lastPutMode:void 0;var A,N=e(e({},g),j.getEventProperties(n,i));for(A in N)f[A]=N[A];o&&o.dispatchEvent(f),E[t]&&E[t].call(i,f)}}function X(t,i){var o=(s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).evt,s=n(s,K);j.pluginEvent.bind(Yt)(t,i,e({dragEl:Q,parentEl:z,ghostEl:J,rootEl:Z,nextEl:$,lastDownEl:tt,cloneEl:et,cloneHidden:it,dragStarted:Tt,putSortable:lt,activeSortable:Yt.active,originalEvent:o,oldIndex:ot,oldDraggableIndex:st,newIndex:nt,newDraggableIndex:rt,hideGhostForTarget:Lt,unhideGhostForTarget:Ut,cloneNowHidden:function(){it=!0},cloneNowShown:function(){it=!1},dispatchSortableEvent:function(t){q({sortable:i,name:t,originalEvent:o})}},s))}var K=["evt"];function q(t){W(e({putSortable:lt,cloneEl:et,targetEl:Q,rootEl:Z,oldIndex:ot,oldDraggableIndex:st,newIndex:nt,newDraggableIndex:rt},t))}var Q,z,J,Z,$,tt,et,it,ot,nt,st,rt,at,lt,ut,ct,dt,ht,_t,pt,Tt,mt,gt,ft,Et,At=!1,Nt=!1,It=[],Ot=!1,Mt=!1,St=[],vt=!1,bt=[],wt="undefined"!=typeof document,Dt=h,xt=u||l?"cssFloat":"float",Rt=wt&&!_&&!h&&"draggable"in document.createElement("div"),Ct=function(){if(wt){if(l)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),yt=function(t,e){var i=I(t),o=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),n=D(t,0,e),s=D(t,1,e),r=n&&I(n),a=s&&I(s),l=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+v(n).width;return t=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+v(s).width,"flex"===i.display?"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal":"grid"===i.display?i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal":n&&r.float&&"none"!==r.float?(e="left"===r.float?"left":"right",!s||"both"!==a.clear&&a.clear!==e?"horizontal":"vertical"):n&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||o<=l&&"none"===i[xt]||s&&"none"===i[xt]&&o<l+t)?"vertical":"horizontal"},Pt=function(t){function e(t,i){return function(o,n,s,r){var a=o.options.group.name&&n.options.group.name&&o.options.group.name===n.options.group.name;return!(null!=t||!i&&!a)||null!=t&&!1!==t&&(i&&"clone"===t?t:"function"==typeof t?e(t(o,n,s,r),i)(o,n,s,r):(n=(i?o:n).options.group.name,!0===t||"string"==typeof t&&t===n||t.join&&-1<t.indexOf(n)))}}var o={},n=t.group;n&&"object"==i(n)||(n={name:n}),o.name=n.name,o.checkPull=e(n.pull,!0),o.checkPut=e(n.put),o.revertClone=n.revertClone,t.group=o},Lt=function(){!Ct&&J&&I(J,"display","none")},Ut=function(){!Ct&&J&&I(J,"display","")};function Vt(t){if(Q){t=t.touches?t.touches[0]:t;var e=(n=t.clientX,s=t.clientY,It.some((function(t){if((o=t[G].options.emptyInsertThreshold)&&!x(t)){var e=v(t),i=n>=e.left-o&&n<=e.right+o,o=s>=e.top-o&&s<=e.bottom+o;return i&&o?r=t:void 0}})),r);if(e){var i,o={};for(i in t)t.hasOwnProperty(i)&&(o[i]=t[i]);o.target=o.rootEl=e,o.preventDefault=void 0,o.stopPropagation=void 0,e[G]._onDragOver(o)}}var n,s,r}function kt(t){Q&&Q.parentNode[G]._isOutsideThisEl(t.target)}function Yt(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=o({},e),t[G]=this;var i,n,s={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return yt(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Yt.supportPointer&&"PointerEvent"in window&&!d,emptyInsertThreshold:5};for(i in j.initializePlugins(this,t,s),s)i in e||(e[i]=s[i]);for(n in Pt(e),this)"_"===n.charAt(0)&&"function"==typeof this[n]&&(this[n]=this[n].bind(this));this.nativeDraggable=!e.forceFallback&&Rt,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?T(t,"pointerdown",this._onTapStart):(T(t,"mousedown",this._onTapStart),T(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(T(t,"dragover",this),T(t,"dragenter",this)),It.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),o(this,H())}function Gt(t,e,i,o,n,s,r,a){var c,d,h=t[G],_=h.options.onMove;return!window.CustomEvent||l||u?(c=document.createEvent("Event")).initEvent("move",!0,!0):c=new CustomEvent("move",{bubbles:!0,cancelable:!0}),c.to=e,c.from=t,c.dragged=i,c.draggedRect=o,c.related=n||e,c.relatedRect=s||v(e),c.willInsertAfter=a,c.originalEvent=r,t.dispatchEvent(c),_?_.call(h,c,r):d}function Ht(t){t.draggable=!1}function Ft(){vt=!1}function Bt(t){return setTimeout(t,0)}function jt(t){return clearTimeout(t)}wt&&!_&&document.addEventListener("click",(function(t){if(Nt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Nt=!1}),!0),Yt.prototype={constructor:Yt,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(mt=null)},_getDirection:function(t,e){return"function"==typeof this.options.direction?this.options.direction.call(this,t,e,Q):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,i=this.el,o=this.options,n=o.preventOnFilter,s=t.type,r=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,a=(r||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||a,u=o.filter;if(function(t){bt.length=0;for(var e=t.getElementsByTagName("input"),i=e.length;i--;){var o=e[i];o.checked&&bt.push(o)}}(i),!Q&&!(/mousedown|pointerdown/.test(s)&&0!==t.button||o.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!d||!a||"SELECT"!==a.tagName.toUpperCase())&&!((a=f(a,o.draggable,i,!1))&&a.animated||tt===a)){if(ot=R(a),st=R(a,o.draggable),"function"==typeof u){if(u.call(this,t,a,this))return q({sortable:e,rootEl:l,name:"filter",targetEl:a,toEl:i,fromEl:i}),X("filter",e,{evt:t}),void(n&&t.cancelable&&t.preventDefault())}else if(u=u&&u.split(",").some((function(o){if(o=f(l,o.trim(),i,!1))return q({sortable:e,rootEl:o,name:"filter",targetEl:a,fromEl:i,toEl:i}),X("filter",e,{evt:t}),!0})))return void(n&&t.cancelable&&t.preventDefault());o.handle&&!f(l,o.handle,i,!1)||this._prepareDragStart(t,r,a)}}},_prepareDragStart:function(t,e,i){var o,n=this,s=n.el,r=n.options,a=s.ownerDocument;i&&!Q&&i.parentNode===s&&(o=v(i),Z=s,z=(Q=i).parentNode,$=Q.nextSibling,tt=i,at=r.group,ut={target:Yt.dragged=Q,clientX:(e||t).clientX,clientY:(e||t).clientY},_t=ut.clientX-o.left,pt=ut.clientY-o.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,Q.style["will-change"]="all",o=function(){X("delayEnded",n,{evt:t}),Yt.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!c&&n.nativeDraggable&&(Q.draggable=!0),n._triggerDragStart(t,e),q({sortable:n,name:"choose",originalEvent:t}),N(Q,r.chosenClass,!0))},r.ignore.split(",").forEach((function(t){M(Q,t.trim(),Ht)})),T(a,"dragover",Vt),T(a,"mousemove",Vt),T(a,"touchmove",Vt),T(a,"mouseup",n._onDrop),T(a,"touchend",n._onDrop),T(a,"touchcancel",n._onDrop),c&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Q.draggable=!0),X("delayStart",this,{evt:t}),!r.delay||r.delayOnTouchOnly&&!e||this.nativeDraggable&&(u||l)?o():Yt.eventCanceled?this._onDrop():(T(a,"mouseup",n._disableDelayedDrag),T(a,"touchend",n._disableDelayedDrag),T(a,"touchcancel",n._disableDelayedDrag),T(a,"mousemove",n._delayedDragTouchMoveHandler),T(a,"touchmove",n._delayedDragTouchMoveHandler),r.supportPointer&&T(a,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(o,r.delay)))},_delayedDragTouchMoveHandler:function(t){t=t.touches?t.touches[0]:t,Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Q&&Ht(Q),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;m(t,"mouseup",this._disableDelayedDrag),m(t,"touchend",this._disableDelayedDrag),m(t,"touchcancel",this._disableDelayedDrag),m(t,"mousemove",this._delayedDragTouchMoveHandler),m(t,"touchmove",this._delayedDragTouchMoveHandler),m(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?T(document,"pointermove",this._onTouchMove):T(document,e?"touchmove":"mousemove",this._onTouchMove):(T(Q,"dragend",this),T(Z,"dragstart",this._onDragStart));try{document.selection?Bt((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(t,e){var i;At=!1,Z&&Q?(X("dragStarted",this,{evt:e}),this.nativeDraggable&&T(document,"dragover",kt),i=this.options,t||N(Q,i.dragClass,!1),N(Q,i.ghostClass,!0),Yt.active=this,t&&this._appendGhost(),q({sortable:this,name:"start",originalEvent:e})):this._nulling()},_emulateDragOver:function(){if(ct){this._lastX=ct.clientX,this._lastY=ct.clientY,Lt();for(var t=document.elementFromPoint(ct.clientX,ct.clientY),e=t;t&&t.shadowRoot&&(t=t.shadowRoot.elementFromPoint(ct.clientX,ct.clientY))!==e;)e=t;if(Q.parentNode[G]._isOutsideThisEl(t),e)do{if(e[G]&&e[G]._onDragOver({clientX:ct.clientX,clientY:ct.clientY,target:t,rootEl:e})&&!this.options.dragoverBubble)break}while(e=(t=e).parentNode);Ut()}},_onTouchMove:function(t){if(ut){var e=(a=this.options).fallbackTolerance,i=a.fallbackOffset,o=t.touches?t.touches[0]:t,n=J&&O(J,!0),s=J&&n&&n.a,r=J&&n&&n.d,a=Dt&&Et&&C(Et);if(s=(o.clientX-ut.clientX+i.x)/(s||1)+(a?a[0]-St[0]:0)/(s||1),r=(o.clientY-ut.clientY+i.y)/(r||1)+(a?a[1]-St[1]:0)/(r||1),!Yt.active&&!At){if(e&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<e)return;this._onDragStart(t,!0)}J&&(n?(n.e+=s-(dt||0),n.f+=r-(ht||0)):n={a:1,b:0,c:0,d:1,e:s,f:r},n="matrix(".concat(n.a,",").concat(n.b,",").concat(n.c,",").concat(n.d,",").concat(n.e,",").concat(n.f,")"),I(J,"webkitTransform",n),I(J,"mozTransform",n),I(J,"msTransform",n),I(J,"transform",n),dt=s,ht=r,ct=o),t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!J){var t=this.options.fallbackOnBody?document.body:Z,e=v(Q,!0,Dt,!0,t),i=this.options;if(Dt){for(Et=t;"static"===I(Et,"position")&&"none"===I(Et,"transform")&&Et!==document;)Et=Et.parentNode;Et!==document.body&&Et!==document.documentElement?(Et===document&&(Et=S()),e.top+=Et.scrollTop,e.left+=Et.scrollLeft):Et=S(),St=C(Et)}N(J=Q.cloneNode(!0),i.ghostClass,!1),N(J,i.fallbackClass,!0),N(J,i.dragClass,!0),I(J,"transition",""),I(J,"transform",""),I(J,"box-sizing","border-box"),I(J,"margin",0),I(J,"top",e.top),I(J,"left",e.left),I(J,"width",e.width),I(J,"height",e.height),I(J,"opacity","0.8"),I(J,"position",Dt?"absolute":"fixed"),I(J,"zIndex","100000"),I(J,"pointerEvents","none"),Yt.ghost=J,t.appendChild(J),I(J,"transform-origin",_t/parseInt(J.style.width)*100+"% "+pt/parseInt(J.style.height)*100+"%")}},_onDragStart:function(t,e){var i=this,o=t.dataTransfer,n=i.options;X("dragStart",this,{evt:t}),Yt.eventCanceled?this._onDrop():(X("setupClone",this),Yt.eventCanceled||((et=V(Q)).removeAttribute("id"),et.draggable=!1,et.style["will-change"]="",this._hideClone(),N(et,this.options.chosenClass,!1),Yt.clone=et),i.cloneId=Bt((function(){X("clone",i),Yt.eventCanceled||(i.options.removeCloneOnHide||Z.insertBefore(et,Q),i._hideClone(),q({sortable:i,name:"clone"}))})),e||N(Q,n.dragClass,!0),e?(Nt=!0,i._loopId=setInterval(i._emulateDragOver,50)):(m(document,"mouseup",i._onDrop),m(document,"touchend",i._onDrop),m(document,"touchcancel",i._onDrop),o&&(o.effectAllowed="move",n.setData&&n.setData.call(i,o,Q)),T(document,"drop",i),I(Q,"transform","translateZ(0)")),At=!0,i._dragStartId=Bt(i._dragStarted.bind(i,e,t)),T(document,"selectstart",i),Tt=!0,d&&I(document.body,"user-select","none"))},_onDragOver:function(t){var i,o,n,s,r,a=this.el,l=t.target,u=this.options,c=u.group,d=Yt.active,h=at===c,_=u.sort,p=lt||d,T=this,m=!1;if(!vt){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),l=f(l,u.draggable,a,!0),Y("dragOver"),Yt.eventCanceled)return m;if(Q.contains(t.target)||l.animated&&l.animatingX&&l.animatingY||T._ignoreWhileAnimating===l)return F(!1);if(Nt=!1,d&&!u.disabled&&(h?_||(o=z!==Z):lt===this||(this.lastPutMode=at.checkPull(this,d,Q,t))&&c.checkPut(this,d,Q,t))){if(n="vertical"===this._getDirection(t,l),i=v(Q),Y("dragOverValid"),Yt.eventCanceled)return m;if(o)return z=Z,H(),this._hideClone(),Y("revert"),Yt.eventCanceled||($?Z.insertBefore(Q,$):Z.appendChild(Q)),F(!0);var g=x(a,u.draggable);if(g&&(C=t,c=n,k=v(x((S=this).el,S.options.draggable)),S=b(S.el),!(c?C.clientX>S.right+10||C.clientY>k.bottom&&C.clientX>k.left:C.clientY>S.bottom+10||C.clientX>k.right&&C.clientY>k.top)||g.animated)){if(g&&(s=t,r=n,P=v(D((y=this).el,0,y.options,!0)),y=b(y.el),r?s.clientX<y.left-10||s.clientY<P.top&&s.clientX<P.right:s.clientY<y.top-10||s.clientY<P.bottom&&s.clientX<P.left)){if((L=D(a,0,u,!0))===Q)return F(!1);if(M=v(l=L),!1!==Gt(Z,a,Q,i,l,M,t,!1))return H(),a.insertBefore(Q,L),z=a,B(),F(!0)}else if(l.parentNode===a){var E,A,O,M=v(l),S=Q.parentNode!==a,C=(C=Q.animated&&Q.toRect||i,k=l.animated&&l.toRect||M,y=(r=n)?C.left:C.top,s=r?C.right:C.bottom,P=r?C.width:C.height,L=r?k.left:k.top,C=r?k.right:k.bottom,k=r?k.width:k.height,!(y===L||s===C||y+P/2===L+k/2)),y=n?"top":"left",P=w(l,"top","top")||w(Q,"top","top"),L=P?P.scrollTop:void 0;if(mt!==l&&(A=M[y],Ot=!1,Mt=!C&&u.invertSwap||S),0!==(E=function(t,e,i,o,n,s,r,a){var l=o?t.clientY:t.clientX,u=o?i.height:i.width;if(t=o?i.top:i.left,o=o?i.bottom:i.right,i=!1,!r)if(a&&ft<u*n){if(Ot=!Ot&&(1===gt?t+u*s/2<l:l<o-u*s/2)||Ot)i=!0;else if(1===gt?l<t+ft:o-ft<l)return-gt}else if(t+u*(1-n)/2<l&&l<o-u*(1-n)/2)return function(t){return R(Q)<R(t)?1:-1}(e);return(i=i||r)&&(l<t+u*s/2||o-u*s/2<l)?t+u/2<l?1:-1:0}(t,l,M,n,C?1:u.swapThreshold,null==u.invertedSwapThreshold?u.swapThreshold:u.invertedSwapThreshold,Mt,mt===l)))for(var V=R(Q);(O=z.children[V-=E])&&("none"===I(O,"display")||O===J););if(0===E||O===l)return F(!1);gt=E;var k=(mt=l).nextElementSibling;if(S=!1,!1!==(C=Gt(Z,a,Q,i,l,M,t,S=1===E)))return 1!==C&&-1!==C||(S=1===C),vt=!0,setTimeout(Ft,30),H(),S&&!k?a.appendChild(Q):l.parentNode.insertBefore(Q,S?k:l),P&&U(P,0,L-P.scrollTop),z=Q.parentNode,void 0===A||Mt||(ft=Math.abs(A-v(l)[y])),B(),F(!0)}}else{if(g===Q)return F(!1);if((l=g&&a===t.target?g:l)&&(M=v(l)),!1!==Gt(Z,a,Q,i,l,M,t,!!l))return H(),g&&g.nextSibling?a.insertBefore(Q,g.nextSibling):a.appendChild(Q),z=a,B(),F(!0)}if(a.contains(Q))return F(!1)}return!1}function Y(s,r){X(s,T,e({evt:t,isOwner:h,axis:n?"vertical":"horizontal",revert:o,dragRect:i,targetRect:M,canSort:_,fromSortable:p,target:l,completed:F,onMove:function(e,o){return Gt(Z,a,Q,i,e,v(e),t,o)},changed:B},r))}function H(){Y("dragOverAnimationCapture"),T.captureAnimationState(),T!==p&&p.captureAnimationState()}function F(e){return Y("dragOverCompleted",{insertion:e}),e&&(h?d._hideClone():d._showClone(T),T!==p&&(N(Q,(lt||d).options.ghostClass,!1),N(Q,u.ghostClass,!0)),lt!==T&&T!==Yt.active?lt=T:T===Yt.active&&lt&&(lt=null),p===T&&(T._ignoreWhileAnimating=l),T.animateAll((function(){Y("dragOverAnimationComplete"),T._ignoreWhileAnimating=null})),T!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(l===Q&&!Q.animated||l===a&&!l.animated)&&(mt=null),u.dragoverBubble||t.rootEl||l===document||(Q.parentNode[G]._isOutsideThisEl(t.target),e||Vt(t)),!u.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),m=!0}function B(){nt=R(Q),rt=R(Q,u.draggable),q({sortable:T,name:"change",toEl:a,newIndex:nt,newDraggableIndex:rt,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){m(document,"mousemove",this._onTouchMove),m(document,"touchmove",this._onTouchMove),m(document,"pointermove",this._onTouchMove),m(document,"dragover",Vt),m(document,"mousemove",Vt),m(document,"touchmove",Vt)},_offUpEvents:function(){var t=this.el.ownerDocument;m(t,"mouseup",this._onDrop),m(t,"touchend",this._onDrop),m(t,"pointerup",this._onDrop),m(t,"touchcancel",this._onDrop),m(document,"selectstart",this)},_onDrop:function(t){var e=this.el,i=this.options;nt=R(Q),rt=R(Q,i.draggable),X("drop",this,{evt:t}),z=Q&&Q.parentNode,nt=R(Q),rt=R(Q,i.draggable),Yt.eventCanceled||(Ot=Mt=At=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),jt(this.cloneId),jt(this._dragStartId),this.nativeDraggable&&(m(document,"drop",this),m(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),d&&I(document.body,"user-select",""),I(Q,"transform",""),t&&(Tt&&(t.cancelable&&t.preventDefault(),i.dropBubble||t.stopPropagation()),J&&J.parentNode&&J.parentNode.removeChild(J),(Z===z||lt&&"clone"!==lt.lastPutMode)&&et&&et.parentNode&&et.parentNode.removeChild(et),Q&&(this.nativeDraggable&&m(Q,"dragend",this),Ht(Q),Q.style["will-change"]="",Tt&&!At&&N(Q,(lt||this).options.ghostClass,!1),N(Q,this.options.chosenClass,!1),q({sortable:this,name:"unchoose",toEl:z,newIndex:null,newDraggableIndex:null,originalEvent:t}),Z!==z?(0<=nt&&(q({rootEl:z,name:"add",toEl:z,fromEl:Z,originalEvent:t}),q({sortable:this,name:"remove",toEl:z,originalEvent:t}),q({rootEl:z,name:"sort",toEl:z,fromEl:Z,originalEvent:t}),q({sortable:this,name:"sort",toEl:z,originalEvent:t})),lt&&lt.save()):nt!==ot&&0<=nt&&(q({sortable:this,name:"update",toEl:z,originalEvent:t}),q({sortable:this,name:"sort",toEl:z,originalEvent:t})),Yt.active&&(null!=nt&&-1!==nt||(nt=ot,rt=st),q({sortable:this,name:"end",toEl:z,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){X("nulling",this),Z=Q=z=J=$=et=tt=it=ut=ct=Tt=nt=rt=ot=st=mt=gt=lt=at=Yt.dragged=Yt.ghost=Yt.clone=Yt.active=null,bt.forEach((function(t){t.checked=!0})),bt.length=dt=ht=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":Q&&(this._onDragOver(t),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}(t));break;case"selectstart":t.preventDefault()}},toArray:function(){for(var t,e=[],i=this.el.children,o=0,n=i.length,s=this.options;o<n;o++)f(t=i[o],s.draggable,this.el,!1)&&e.push(t.getAttribute(s.dataIdAttr)||function(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,o=0;i--;)o+=e.charCodeAt(i);return o.toString(36)}(t));return e},sort:function(t,e){var i={},o=this.el;this.toArray().forEach((function(t,e){f(e=o.children[e],this.options.draggable,o,!1)&&(i[t]=e)}),this),e&&this.captureAnimationState(),t.forEach((function(t){i[t]&&(o.removeChild(i[t]),o.appendChild(i[t]))})),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return f(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var i=this.options;if(void 0===e)return i[t];var o=j.modifyOption(this,t,e);i[t]=void 0!==o?o:e,"group"===t&&Pt(i)},destroy:function(){X("destroy",this);var t=this.el;t[G]=null,m(t,"mousedown",this._onTapStart),m(t,"touchstart",this._onTapStart),m(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(m(t,"dragover",this),m(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),It.splice(It.indexOf(this.el),1),this.el=t=null},_hideClone:function(){it||(X("hideClone",this),Yt.eventCanceled||(I(et,"display","none"),this.options.removeCloneOnHide&&et.parentNode&&et.parentNode.removeChild(et),it=!0))},_showClone:function(t){"clone"===t.lastPutMode?it&&(X("showClone",this),Yt.eventCanceled||(Q.parentNode!=Z||this.options.group.revertClone?$?Z.insertBefore(et,$):Z.appendChild(et):Z.insertBefore(et,Q),this.options.group.revertClone&&this.animate(Q,et),I(et,"display",""),it=!1)):this._hideClone()}},wt&&T(document,"touchmove",(function(t){(Yt.active||At)&&t.cancelable&&t.preventDefault()})),Yt.utils={on:T,off:m,css:I,find:M,is:function(t,e){return!!f(t,e,t,!1)},extend:function(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},throttle:L,closest:f,toggleClass:N,clone:V,index:R,nextTick:Bt,cancelNextTick:jt,detectDirection:yt,getChild:D},Yt.get=function(t){return t[G]},Yt.mount=function(){for(var t=arguments.length,i=new Array(t),o=0;o<t;o++)i[o]=arguments[o];(i=i[0].constructor===Array?i[0]:i).forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(Yt.utils=e(e({},Yt.utils),t.utils)),j.mount(t)}))},Yt.create=function(t,e){return new Yt(t,e)};var Wt,Xt,Kt,qt,Qt,zt,Jt=[],Zt=!(Yt.version="1.15.1");function $t(){Jt.forEach((function(t){clearInterval(t.pid)})),Jt=[]}function te(){clearInterval(zt)}var ee,ie=L((function(t,e,i,o){if(e.scroll){var n,s=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,l=e.scrollSpeed,u=S(),c=!1;Xt!==i&&(Xt=i,$t(),Wt=e.scroll,n=e.scrollFn,!0===Wt&&(Wt=y(i,!0)));var d=0,h=Wt;do{var _=h,p=(D=v(_)).top,T=D.bottom,m=D.left,g=D.right,f=D.width,E=D.height,A=void 0,N=void 0,O=_.scrollWidth,M=_.scrollHeight,b=I(_),w=_.scrollLeft,D=_.scrollTop;if(N=_===u?(A=f<O&&("auto"===b.overflowX||"scroll"===b.overflowX||"visible"===b.overflowX),E<M&&("auto"===b.overflowY||"scroll"===b.overflowY||"visible"===b.overflowY)):(A=f<O&&("auto"===b.overflowX||"scroll"===b.overflowX),E<M&&("auto"===b.overflowY||"scroll"===b.overflowY)),w=A&&(Math.abs(g-s)<=a&&w+f<O)-(Math.abs(m-s)<=a&&!!w),D=N&&(Math.abs(T-r)<=a&&D+E<M)-(Math.abs(p-r)<=a&&!!D),!Jt[d])for(var x=0;x<=d;x++)Jt[x]||(Jt[x]={});Jt[d].vx==w&&Jt[d].vy==D&&Jt[d].el===_||(Jt[d].el=_,Jt[d].vx=w,Jt[d].vy=D,clearInterval(Jt[d].pid),0==w&&0==D||(c=!0,Jt[d].pid=setInterval(function(){o&&0===this.layer&&Yt.active._onTouchMove(Qt);var e=Jt[this.layer].vy?Jt[this.layer].vy*l:0,i=Jt[this.layer].vx?Jt[this.layer].vx*l:0;"function"==typeof n&&"continue"!==n.call(Yt.dragged.parentNode[G],i,e,t,Qt,Jt[this.layer].el)||U(Jt[this.layer].el,i,e)}.bind({layer:d}),24))),d++}while(e.bubbleScroll&&h!==u&&(h=y(h,!1)));Zt=c}}),30);function oe(){}function ne(){}_=function(t){var e=t.originalEvent,i=t.putSortable,o=t.dragEl,n=t.activeSortable,s=t.dispatchSortableEvent,r=t.hideGhostForTarget;t=t.unhideGhostForTarget,e&&(n=i||n,r(),e=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,e=document.elementFromPoint(e.clientX,e.clientY),t(),n&&!n.el.contains(e)&&(s("spill"),this.onSpill({dragEl:o,putSortable:i})))},oe.prototype={startIndex:null,dragStart:function(t){t=t.oldDraggableIndex,this.startIndex=t},onSpill:function(t){var e=t.dragEl,i=t.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState(),(t=D(this.sortable.el,this.startIndex,this.options))?this.sortable.el.insertBefore(e,t):this.sortable.el.appendChild(e),this.sortable.animateAll(),i&&i.animateAll()},drop:_},o(oe,{pluginName:"revertOnSpill"}),ne.prototype={onSpill:function(t){var e=t.dragEl;(t=t.putSortable||this.sortable).captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),t.animateAll()},drop:_},o(ne,{pluginName:"removeOnSpill"});var se,re,ae,le,ue,ce=[],de=[],he=!1,_e=!1,pe=!1;function Te(t,e){de.forEach((function(i,o){(o=e.children[i.sortableIndex+(t?Number(o):0)])?e.insertBefore(i,o):e.appendChild(i)}))}function me(){ce.forEach((function(t){t!==ae&&t.parentNode&&t.parentNode.removeChild(t)}))}return Yt.mount(new function(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){t=t.originalEvent,this.sortable.nativeDraggable?T(document,"dragover",this._handleAutoScroll):this.options.supportPointer?T(document,"pointermove",this._handleFallbackAutoScroll):t.touches?T(document,"touchmove",this._handleFallbackAutoScroll):T(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){t=t.originalEvent,this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?m(document,"dragover",this._handleAutoScroll):(m(document,"pointermove",this._handleFallbackAutoScroll),m(document,"touchmove",this._handleFallbackAutoScroll),m(document,"mousemove",this._handleFallbackAutoScroll)),te(),$t(),clearTimeout(E),E=void 0},nulling:function(){Qt=Xt=Wt=Zt=zt=Kt=qt=null,Jt.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var i,o=this,n=(t.touches?t.touches[0]:t).clientX,s=(t.touches?t.touches[0]:t).clientY,r=document.elementFromPoint(n,s);Qt=t,e||this.options.forceAutoScrollFallback||u||l||d?(ie(t,this.options,r,e),i=y(r,!0),!Zt||zt&&n===Kt&&s===qt||(zt&&te(),zt=setInterval((function(){var r=y(document.elementFromPoint(n,s),!0);r!==i&&(i=r,$t()),ie(t,o.options,r,e)}),10),Kt=n,qt=s)):this.options.bubbleScroll&&y(r,!0)!==S()?ie(t,this.options,y(r,!1),!1):$t()}},o(t,{pluginName:"scroll",initializeByDefault:!0})}),Yt.mount(ne,oe),Yt.mount(new function(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(t){t=t.dragEl,ee=t},dragOverValid:function(t){var e=t.completed,i=t.target,o=t.onMove,n=t.activeSortable,s=t.changed,r=t.cancel;n.options.swap&&(t=this.sortable.el,n=this.options,i&&i!==t&&(t=ee,ee=!1!==o(i)?(N(i,n.swapClass,!0),i):null,t&&t!==ee&&N(t,n.swapClass,!1)),s(),e(!0),r())},drop:function(t){var e,i,o=t.activeSortable,n=t.putSortable,s=t.dragEl,r=n||this.sortable,a=this.options;ee&&N(ee,a.swapClass,!1),ee&&(a.swap||n&&n.options.swap)&&s!==ee&&(r.captureAnimationState(),r!==o&&o.captureAnimationState(),i=ee,t=(e=s).parentNode,a=i.parentNode,t&&a&&!t.isEqualNode(i)&&!a.isEqualNode(e)&&(n=R(e),s=R(i),t.isEqualNode(a)&&n<s&&s++,t.insertBefore(i,t.children[n]),a.insertBefore(e,a.children[s])),r.animateAll(),r!==o&&o.animateAll())},nulling:function(){ee=null}},o(t,{pluginName:"swap",eventProperties:function(){return{swapItem:ee}}})}),Yt.mount(new function(){function t(t){for(var e in this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this));t.options.avoidImplicitDeselect||(t.options.supportPointer?T(document,"pointerup",this._deselectMultiDrag):(T(document,"mouseup",this._deselectMultiDrag),T(document,"touchend",this._deselectMultiDrag))),T(document,"keydown",this._checkKeyDown),T(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,avoidImplicitDeselect:!1,setData:function(e,i){var o="";ce.length&&re===t?ce.forEach((function(t,e){o+=(e?", ":"")+t.textContent})):o=i.textContent,e.setData("Text",o)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){t=t.dragEl,ae=t},delayEnded:function(){this.isMultiDrag=~ce.indexOf(ae)},setupClone:function(t){var e=t.sortable;if(t=t.cancel,this.isMultiDrag){for(var i=0;i<ce.length;i++)de.push(V(ce[i])),de[i].sortableIndex=ce[i].sortableIndex,de[i].draggable=!1,de[i].style["will-change"]="",N(de[i],this.options.selectedClass,!1),ce[i]===ae&&N(de[i],this.options.chosenClass,!1);e._hideClone(),t()}},clone:function(t){var e=t.sortable,i=t.rootEl,o=t.dispatchSortableEvent;t=t.cancel,this.isMultiDrag&&(this.options.removeCloneOnHide||ce.length&&re===e&&(Te(!0,i),o("clone"),t()))},showClone:function(t){var e=t.cloneNowShown,i=t.rootEl;t=t.cancel,this.isMultiDrag&&(Te(!1,i),de.forEach((function(t){I(t,"display","")})),e(),ue=!1,t())},hideClone:function(t){var e=this,i=(t.sortable,t.cloneNowHidden);t=t.cancel,this.isMultiDrag&&(de.forEach((function(t){I(t,"display","none"),e.options.removeCloneOnHide&&t.parentNode&&t.parentNode.removeChild(t)})),i(),ue=!0,t())},dragStartGlobal:function(t){t.sortable,!this.isMultiDrag&&re&&re.multiDrag._deselectMultiDrag(),ce.forEach((function(t){t.sortableIndex=R(t)})),ce=ce.sort((function(t,e){return t.sortableIndex-e.sortableIndex})),pe=!0},dragStarted:function(t){var e,i=this;t=t.sortable,this.isMultiDrag&&(this.options.sort&&(t.captureAnimationState(),this.options.animation&&(ce.forEach((function(t){t!==ae&&I(t,"position","absolute")})),e=v(ae,!1,!0,!0),ce.forEach((function(t){t!==ae&&k(t,e)})),he=_e=!0)),t.animateAll((function(){he=_e=!1,i.options.animation&&ce.forEach((function(t){Y(t)})),i.options.sort&&me()})))},dragOver:function(t){var e=t.target,i=t.completed;t=t.cancel,_e&&~ce.indexOf(e)&&(i(!1),t())},revert:function(t){var e,i,o=t.fromSortable,n=t.rootEl,s=t.sortable,r=t.dragRect;1<ce.length&&(ce.forEach((function(t){s.addAnimationState({target:t,rect:_e?v(t):r}),Y(t),t.fromRect=r,o.removeAnimationState(t)})),_e=!1,e=!this.options.removeCloneOnHide,i=n,ce.forEach((function(t,o){(o=i.children[t.sortableIndex+(e?Number(o):0)])?i.insertBefore(t,o):i.appendChild(t)})))},dragOverCompleted:function(t){var e,i=t.sortable,o=t.isOwner,n=t.insertion,s=t.activeSortable,r=t.parentEl,a=t.putSortable;t=this.options,n&&(o&&s._hideClone(),he=!1,t.animation&&1<ce.length&&(_e||!o&&!s.options.sort&&!a)&&(e=v(ae,!1,!0,!0),ce.forEach((function(t){t!==ae&&(k(t,e),r.appendChild(t))})),_e=!0),o||(_e||me(),1<ce.length?(o=ue,s._showClone(i),s.options.animation&&!ue&&o&&de.forEach((function(t){s.addAnimationState({target:t,rect:le}),t.fromRect=le,t.thisAnimationDuration=null}))):s._showClone(i)))},dragOverAnimationCapture:function(t){var e=t.dragRect,i=t.isOwner;t=t.activeSortable,ce.forEach((function(t){t.thisAnimationDuration=null})),t.options.animation&&!i&&t.multiDrag.isMultiDrag&&(le=o({},e),e=O(ae,!0),le.top-=e.f,le.left-=e.e)},dragOverAnimationComplete:function(){_e&&(_e=!1,me())},drop:function(t){var e=t.originalEvent,i=t.rootEl,o=t.parentEl,n=t.sortable,s=t.dispatchSortableEvent,r=t.oldIndex,a=t.putSortable,l=a||this.sortable;if(e){var u,c,d,h=this.options,_=o.children;if(!pe)if(h.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),N(ae,h.selectedClass,!~ce.indexOf(ae)),~ce.indexOf(ae))ce.splice(ce.indexOf(ae),1),se=null,W({sortable:n,rootEl:i,name:"deselect",targetEl:ae,originalEvent:e});else{if(ce.push(ae),W({sortable:n,rootEl:i,name:"select",targetEl:ae,originalEvent:e}),e.shiftKey&&se&&n.el.contains(se)){var p=R(se);if(t=R(ae),~p&&~t&&p!==t)for(var T,m=p<t?(T=p,t):(T=t,p+1);T<m;T++)~ce.indexOf(_[T])||(N(_[T],h.selectedClass,!0),ce.push(_[T]),W({sortable:n,rootEl:i,name:"select",targetEl:_[T],originalEvent:e}))}else se=ae;re=l}pe&&this.isMultiDrag&&(_e=!1,(o[G].options.sort||o!==i)&&1<ce.length&&(u=v(ae),c=R(ae,":not(."+this.options.selectedClass+")"),!he&&h.animation&&(ae.thisAnimationDuration=null),l.captureAnimationState(),he||(h.animation&&(ae.fromRect=u,ce.forEach((function(t){var e;t.thisAnimationDuration=null,t!==ae&&(e=_e?v(t):u,t.fromRect=e,l.addAnimationState({target:t,rect:e}))}))),me(),ce.forEach((function(t){_[c]?o.insertBefore(t,_[c]):o.appendChild(t),c++})),r===R(ae)&&(d=!1,ce.forEach((function(t){t.sortableIndex!==R(t)&&(d=!0)})),d&&(s("update"),s("sort")))),ce.forEach((function(t){Y(t)})),l.animateAll()),re=l),(i===o||a&&"clone"!==a.lastPutMode)&&de.forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}))}},nullingGlobal:function(){this.isMultiDrag=pe=!1,de.length=0},destroyGlobal:function(){this._deselectMultiDrag(),m(document,"pointerup",this._deselectMultiDrag),m(document,"mouseup",this._deselectMultiDrag),m(document,"touchend",this._deselectMultiDrag),m(document,"keydown",this._checkKeyDown),m(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(!(void 0!==pe&&pe||re!==this.sortable||t&&f(t.target,this.options.draggable,this.sortable.el,!1)||t&&0!==t.button))for(;ce.length;){var e=ce[0];N(e,this.options.selectedClass,!1),ce.shift(),W({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvent:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},o(t,{pluginName:"multiDrag",utils:{select:function(t){var e=t.parentNode[G];e&&e.options.multiDrag&&!~ce.indexOf(t)&&(re&&re!==e&&(re.multiDrag._deselectMultiDrag(),re=e),N(t,e.options.selectedClass,!0),ce.push(t))},deselect:function(t){var e=t.parentNode[G],i=ce.indexOf(t);e&&e.options.multiDrag&&~i&&(N(t,e.options.selectedClass,!1),ce.splice(i,1))}},eventProperties:function(){var t=this,e=[],i=[];return ce.forEach((function(o){var n;e.push({multiDragElement:o,index:o.sortableIndex}),n=_e&&o!==ae?-1:_e?R(o,":not(."+t.options.selectedClass+")"):R(o),i.push({multiDragElement:o,index:n})})),{items:s(ce),clones:[].concat(de),oldIndicies:e,newIndicies:i}},optionListeners:{multiDragKey:function(t){return"ctrl"===(t=t.toLowerCase())?t="Control":1<t.length&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}),Yt}()},914:()=>{
/*!
 * swiped-events.js - v1.1.9
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */
!function(t,e){"use strict";"function"!=typeof t.CustomEvent&&(t.CustomEvent=function(t,i){i=i||{bubbles:!1,cancelable:!1,detail:void 0};var o=e.createEvent("CustomEvent");return o.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),o},t.CustomEvent.prototype=t.Event.prototype),e.addEventListener("touchstart",(function(t){"true"!==t.target.getAttribute("data-swipe-ignore")&&(a=t.target,r=Date.now(),i=t.touches[0].clientX,o=t.touches[0].clientY,n=0,s=0,l=t.touches.length)}),!1),e.addEventListener("touchmove",(function(t){if(i&&o){var e=t.touches[0].clientX,r=t.touches[0].clientY;n=i-e,s=o-r}}),!1),e.addEventListener("touchend",(function(t){if(a===t.target){var c=parseInt(u(a,"data-swipe-threshold","20"),10),d=u(a,"data-swipe-unit","px"),h=parseInt(u(a,"data-swipe-timeout","500"),10),_=Date.now()-r,p="",T=t.changedTouches||t.touches||[];if("vh"===d&&(c=Math.round(c/100*e.documentElement.clientHeight)),"vw"===d&&(c=Math.round(c/100*e.documentElement.clientWidth)),Math.abs(n)>Math.abs(s)?Math.abs(n)>c&&_<h&&(p=n>0?"swiped-left":"swiped-right"):Math.abs(s)>c&&_<h&&(p=s>0?"swiped-up":"swiped-down"),""!==p){var m={dir:p.replace(/swiped-/,""),touchType:(T[0]||{}).touchType||"direct",fingers:l,xStart:parseInt(i,10),xEnd:parseInt((T[0]||{}).clientX||-1,10),yStart:parseInt(o,10),yEnd:parseInt((T[0]||{}).clientY||-1,10)};a.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:m})),a.dispatchEvent(new CustomEvent(p,{bubbles:!0,cancelable:!0,detail:m}))}i=null,o=null,r=null}}),!1);var i=null,o=null,n=null,s=null,r=null,a=null,l=0;function u(t,i,o){for(;t&&t!==e.documentElement;){var n=t.getAttribute(i);if(n)return n;t=t.parentNode}return o}}(window,document)},104:t=>{var e="undefined"!=typeof process&&process.pid?process.pid.toString(36):"";function i(){var t=Date.now(),e=i.last||t;return i.last=t>e?t:e+1}t.exports=t.exports.default=function(t,o){return(t||"")+""+e+i().toString(36)+(o||"")},t.exports.process=function(t,o){return(t||"")+e+i().toString(36)+(o||"")},t.exports.time=function(t,e){return(t||"")+i().toString(36)+(e||"")}},671:(t,e,i)=>{"use strict";i(948);t.exports.storeFile=function(t,e){return new Promise(((i,o)=>{const n=window.Mimoto.data.internal.storage(),s=window.Mimoto.data.internal.storageModules().storageRef(n,e),r=window.Mimoto.data.internal.storageModules().uploadBytesResumable(s,t);r.on("state_changed",(t=>{t.bytesTransferred,t.totalBytes}),(t=>{Mimoto.error("Upload failed:",t),o(t)}),(()=>{window.Mimoto.data.internal.storageModules().getDownloadURL(r.snapshot.ref).then((t=>{i(t)}))}))}))}},752:(t,e,i)=>{"use strict";const o=i(948),n=i(697),{concat:s}=(i(939),i(790));t.exports=function(){},t.exports.MIMOTO_PREFIX="mimoto",t.exports.INSTRUCTION_PREFIX="data-mimoto-",t.exports.INSTRUCTION_SETTINGS_POSTFIX="-settings",t.exports.INSTRUCTION_SETTINGS_POSTFIX_DATASET="Settings",t.exports.INSTRUCTION_VARS_POSTFIX="-vars",t.exports.INSTRUCTION_VARS_POSTFIX_DATASET="Vars",t.exports.INSTRUCTION_ID_POSTFIX="-id",t.exports.INSTRUCTION_ID_POSTFIX_DATASET="Id",t.exports.MIMOTO_CORE_METHOD_PREFIX="Mimoto.",t.exports.PARSER_PHASE_PREPARSING="ParserPhasePreParsing",t.exports.PARSER_PHASE_PARSING="ParserPhaseParsing",t.exports.DATA_MIMOTO_ID="data-mimoto-id",t.exports.DATA_MIMOTO_VIEWID="data-mimoto-viewid",t.exports.DATA_MIMOTO_SUBVIEWID="data-mimoto-subviewid",t.exports.DATA_MIMOTO_CONTAINERID="data-mimoto-containerid",t.exports.DATA_MIMOTO_NOPE="data-mimoto-nope",t.exports.DATA_MIMOTO_STATUS="data-mimoto-status",t.exports.DATA_MIMOTO_VIEW="data-mimoto-view",t.exports.DATA_MIMOTO_SUBVIEW="data-mimoto-subview",t.exports.DATA_MIMOTO_NAVIGATION="data-mimoto-navigation",t.exports.DATA_MIMOTO_DRAGHANDLE="data-mimoto-draghandle",t.exports.DATA_MIMOTO_KEY="data-mimoto-key",t.exports.DATA_MIMOTO_SORTINDEX="data-mimoto-sortindex",t.exports.DATA_MIMOTO_OUTPUT="data-mimoto-output",t.exports.DATA_MIMOTO_VALUE="data-mimoto-value",t.exports.DATA_MIMOTO_INPUT="data-mimoto-input",t.exports.DATA_MIMOTO_ACTION="data-mimoto-action",t.exports.DATA_MIMOTO_REGISTER="data-mimoto-register",t.exports.DATA_MIMOTO_LAYOUT="data-mimoto-layout",t.exports.DATA_MIMOTO_TARGET="data-mimoto-target",t.exports.DATA_MIMOTO_DOCUMENT="data-mimoto-document",t.exports.DATA_MIMOTO_LIST="data-mimoto-list",t.exports.DATA_MIMOTO_COLLECTION="data-mimoto-collection",t.exports.DATA_MIMOTO_CONTAINER="data-mimoto-container",t.exports.DATA_MIMOTO_CLASS="data-mimoto-class",t.exports.DATA_MIMOTO_ATTRIBUTE="data-mimoto-attribute",t.exports.DATA_MIMOTO_FORM="data-mimoto-form",t.exports.DATA_MIMOTO_EVENT="data-mimoto-event",t.exports.DATA_MIMOTO_REALTIME="data-mimoto-realtime",t.exports.DATA_MIMOTO_META="data-mimoto-meta",t.exports.DATA_MIMOTO_HINT="data-mimoto-hint",t.exports.DATA_MIMOTO_LOG="data-mimoto-log",t.exports.DATA_MIMOTO_XRAY="data-mimoto-xray",t.exports.ARGUMENT_TYPE_VALUE="VALUE",t.exports.ARGUMENT_TYPE_VAR="VAR",t.exports.ARGUMENT_TYPE_CONST="CONST",t.exports.ARGUMENT_TYPE_CALLBACK="CALLBACK",t.exports.ARGUMENT_TYPE_OBJECT="OBJECT",t.exports.ARGUMENT_TYPE_ARRAY="ARRAY",t.exports.ARGUMENT_TYPE_MATH_PLUS="MATH_PLUS",t.exports.ARGUMENT_TYPE_MATH_MINUS="MATH_MINUS",t.exports.ARGUMENT_TYPE_MATH_MULTIPLY="MATH_MULTIPLY",t.exports.ARGUMENT_TYPE_MATH_DIVIDE="MATH_DIVIDE",t.exports.ARGUMENT_TYPE_MATH_POWER="MATH_POWER",t.exports.ARGUMENT_TYPE_OPERATOR_GROUP="MATH_GROUP",t.exports.ARGUMENT_TYPE_OPERATOR_AND="OPERATOR_AND",t.exports.ARGUMENT_TYPE_OPERATOR_OR="OPERATOR_OR",t.exports.ARGUMENT_TYPE_OPERATOR_EQUAL="OPERATOR_EQUAL",t.exports.ARGUMENT_TYPE_OPERATOR_LESSTHAN="OPERATOR_LESSTHAN",t.exports.ARGUMENT_TYPE_OPERATOR_LESSOREQUAL="OPERATOR_LESSOREQUAL",t.exports.ARGUMENT_TYPE_OPERATOR_GREATERTHAN="OPERATOR_GREATERTHAN",t.exports.ARGUMENT_TYPE_OPERATOR_GREATEROREQUAL="OPERATOR_GREATEROREQUAL",t.exports.ARGUMENT_TYPE_CHAIN="CHAIN",t.exports.ARGUMENT_TYPE_CHAIN_VERIFY="VERIFY",t.exports.ARGUMENT_TYPE_CHAIN_DATA="DATA",t.exports.ARGUMENT_TYPE_CHAIN_EVENTDATA="CHAIN_EVENTDATA",t.exports.INSTRUCTION_VALUE="value",t.exports.INSTRUCTION_SETTINGS="settings",t.exports.INSTRUCTION_VARS="vars",t.exports.INSTRUCTION_PREPARSE_INDEX="PreparseIndex",t.exports.INSTRUCTION_PREPARSED="Preparsed",t.exports.INSTRUCTION_PARSE_INDEX="ParseIndex",t.exports.INSTRUCTION_PARSED="Parsed",t.exports.INSTRUCTION_VALUE_PREPARSED=t.exports.INSTRUCTION_VALUE+t.exports.INSTRUCTION_PREPARSED,t.exports.CANCEL="cancel",t.exports.INSTRUCTION_READY="INSTRUCTION_READY",t.exports.DEFAULT_SETTINGS="{}",t.exports.DEFAULT_VARS="{}",t.exports.DATA_MIMOTO_STATUS_ACTIVE="‚ú®",t.exports.DATA_MIMOTO_STATUS_ERROR="üî•",t.exports.VIEW="view",t.exports.SUBVIEW="subview",t.exports.DOCUMENT="document",t.exports.COLLECTION="collection",t.exports.INPUT="input",t.exports.UI="ui",t.exports.STACK="Stack",t.exports.CONSTANT_PARENT="PARENT",t.exports.CONSTANT_KEY="KEY",t.exports.CONSTANT_DOCUMENT_KEY="DOCUMENT_KEY",t.exports.CONSTANT_DOCUMENT_PATH="DOCUMENT_PATH",t.exports.CONSTANT_SORTINDEX="SORTINDEX",t.exports.CONSTANT_DATA="DATA",t.exports.CONSTANT_NULL="NULL",t.exports.CONSTANT_NULL_LOWERCASE="null",t.exports.CONSTANT_UNDEFINED="UNDEFINED",t.exports.CONSTANT_UNDEFINED_LOWERCASE="undefined",t.exports.CONSTANT_ALL="ALL",t.exports.CONSTANT_LOCAL="LOCAL",t.exports.CONSTANT_REALTIME="REALTIME",t.exports.CONSTANT_HTML="HTML",t.exports.CONSTANT_NODE="NODE",t.exports.CONSTANT_VIEW="VIEW",t.exports.CONSTANT_VARS="VARS",t.exports.CONSTANT_VALUES="VALUES",t.exports.CONSTANT_URL="URL",t.exports.CONSTANT_URL_DOMAIN="URL_DOMAIN",t.exports.CONSTANT_URL_PROTOCOL="URL_PROTOCOL",t.exports.CONSTANT_URL_HOST="URL_HOST",t.exports.CONSTANT_URL_PORT="URL_PORT",t.exports.CONSTANT_URL_PATH="URL_PATH",t.exports.CONSTANT_STATE_LOCKED="STATE_LOCKED",t.exports.CONSTANT_STATE_UNLOCKED="STATE_UNLOCKED",t.exports.CONSTANT_STATE_DRAGGING="STATE_DRAGGING",t.exports.CONSTANT_STATE_FOCUSED="STATE_FOCUSED",t.exports.CONSTANT_STATE_EMPTY="STATE_EMPTY",t.exports.CONSTANT_STATE_EDITABLE="STATE_EDITABLE",t.exports.CONSTANT_STATE_ERROR="STATE_ERROR",t.exports.CONSTANT_STATE_SIGNED_IN="STATE_SIGNED_IN",t.exports.CONSTANT_STATE_SIGNED_OUT="STATE_SIGNED_OUT",t.exports.CONSTANT_STATE_EDIT="STATE_EDIT",t.exports.CONSTANT_STATE_BUSY="STATE_BUSY",t.exports.CONSTANT_USER_ID="USER_ID",t.exports.CONSTANT_USER_DISPLAYNAME="USER_DISPLAYNAME",t.exports.CONSTANT_USER_AVATAR="USER_AVATAR",t.exports.CONSTANT_USER_EMAIL="USER_EMAIL",t.exports.CONSTANT_USER_ISADMIN="USER_ISADMIN",t.exports.CONSTANT_USER_ISVERIFIED="USER_ISVERIFIED",t.exports.CONSTANT_EVENT_CLICK="CLICK",t.exports.CONSTANT_EVENT_DOUBLECLICK="DOUBLE_CLICK",t.exports.CONSTANT_EVENT_SWIPE="SWIPE",t.exports.CONSTANT_EVENT_SWIPE_LEFT="SWIPE_LEFT",t.exports.CONSTANT_EVENT_SWIPE_RIGHT="SWIPE_RIGHT",t.exports.CONSTANT_EVENT_UP="SWIPE_UP",t.exports.CONSTANT_EVENT_DOWN="SWIPE_DOWN",t.exports.CONSTANT_EVENT_MOUSE_OVER="MOUSE_OVER",t.exports.CONSTANT_EVENT_MOUSE_OUT="MOUSE_OUT",t.exports.CONSTANT_EVENT_MOUSE_CONTEXTMENU="MOUSE_CONTEXTMENU",t.exports.CONSTANT_EVENT_MOUSE_DOW="MOUSE_DOW",t.exports.CONSTANT_EVENT_MOUSE_ENTER="MOUSE_ENTER",t.exports.CONSTANT_EVENT_MOUSE_LEAVE="MOUSE_LEAVE",t.exports.CONSTANT_EVENT_MOUSE_DOWN="MOUSE_DOWN",t.exports.CONSTANT_EVENT_MOUSE_UP="MOUSE_UP",t.exports.CONSTANT_EVENT_KEY="EVENT_KEY",t.exports.CONSTANT_EVENT_DATA="EVENT_DATA",t.exports.CONSTANT_EVENT_DELETED="EVENT_DELETED",t.exports.CONSTANT_EVENT_ERROR="EVENT_ERROR",t.exports.CONSTANT_EVENT_FIRST_ITEM_ADDED="FIRST_ITEM_ADDED",t.exports.CONSTANT_EVENT_ITEM_ADDED="ITEM_ADDED",t.exports.CONSTANT_EVENT_ITEM_REMOVED="ITEM_REMOVED",t.exports.ITEM_COUNT="ITEM_COUNT",t.exports.CONSTANT_EVENT_VIEW_INIT="START",t.exports.CONSTANT_EVENT_SIGNED_IN="EVENT_SIGNED_IN",t.exports.CONSTANT_EVENT_SIGNED_OUT="EVENT_SIGNED_OUT",t.exports.CONSTANT_EVENT_INIT="EVENT_INIT",t.exports.MIMOTOSCRIPT_CONSTANTS=[t.exports.CONSTANT_PARENT,t.exports.CONSTANT_KEY,t.exports.CONSTANT_DOCUMENT_KEY,t.exports.CONSTANT_DOCUMENT_PATH,t.exports.CONSTANT_SORTINDEX,t.exports.CONSTANT_DATA,t.exports.CONSTANT_VARS,t.exports.CONSTANT_NULL,t.exports.CONSTANT_NULL_LOWERCASE,t.exports.CONSTANT_UNDEFINED,t.exports.CONSTANT_UNDEFINED_LOWERCASE,t.exports.CONSTANT_ALL,t.exports.CONSTANT_LOCAL,t.exports.CONSTANT_REALTIME,t.exports.CONSTANT_HTML,t.exports.CONSTANT_NODE,t.exports.CONSTANT_VIEW,t.exports.CONSTANT_URL,t.exports.CONSTANT_URL_DOMAIN,t.exports.CONSTANT_URL_PROTOCOL,t.exports.CONSTANT_URL_HOST,t.exports.CONSTANT_URL_PORT,t.exports.CONSTANT_URL_PATH,t.exports.CONSTANT_STATE_LOCKED,t.exports.CONSTANT_STATE_UNLOCKED,t.exports.CONSTANT_STATE_DRAGGING,t.exports.CONSTANT_STATE_EMPTY,t.exports.CONSTANT_STATE_EDITABLE,t.exports.CONSTANT_STATE_FOCUSED,t.exports.CONSTANT_STATE_ERROR,t.exports.CONSTANT_EVENT_CLICK,t.exports.CONSTANT_EVENT_DOUBLECLICK,t.exports.CONSTANT_EVENT_SWIPE,t.exports.CONSTANT_EVENT_SWIPE_LEFT,t.exports.CONSTANT_EVENT_SWIPE_RIGHT,t.exports.CONSTANT_EVENT_UP,t.exports.CONSTANT_EVENT_DOWN,t.exports.CONSTANT_EVENT_MOUSE_OVER,t.exports.CONSTANT_EVENT_MOUSE_OUT,t.exports.CONSTANT_EVENT_MOUSE_CONTEXTMENU,t.exports.CONSTANT_EVENT_MOUSE_ENTER,t.exports.CONSTANT_EVENT_MOUSE_LEAVE,t.exports.CONSTANT_EVENT_MOUSE_DOWN,t.exports.CONSTANT_EVENT_MOUSE_UP,t.exports.CONSTANT_EVENT_FIRST_ITEM_ADDED,t.exports.CONSTANT_EVENT_ITEM_ADDED,t.exports.CONSTANT_EVENT_ITEM_REMOVED,t.exports.ITEM_COUNT,t.exports.CONSTANT_STATE_SIGNED_IN,t.exports.CONSTANT_STATE_SIGNED_OUT,t.exports.CONSTANT_EVENT_INIT,t.exports.CONSTANT_EVENT_DATA,t.exports.CONSTANT_EVENT_SIGNED_IN,t.exports.CONSTANT_EVENT_SIGNED_OUT,t.exports.CONSTANT_STATE_EDIT,t.exports.CONSTANT_STATE_BUSY,t.exports.CONSTANT_USER_ID,t.exports.CONSTANT_USER_DISPLAYNAME,t.exports.CONSTANT_USER_AVATAR,t.exports.CONSTANT_USER_EMAIL,t.exports.CONSTANT_USER_ISADMIN,t.exports.CONSTANT_USER_ISVERIFIED],t.exports.MIMOTOSCRIPT_ACTION_TYPES={},t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_CLICK]="click",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_DOUBLECLICK]="dblclick",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_SWIPE]="swiped",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_SWIPE_LEFT]="swiped-left",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_SWIPE_RIGHT]="swiped-right",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_UP]="swiped-up",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_DOWN]="swiped-down",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_MOUSE_OVER]="mouseover",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_MOUSE_OUT]="mouseout",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_MOUSE_CONTEXTMENU]="contextmenu",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_MOUSE_ENTER]="mouseenter",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_MOUSE_LEAVE]="mouseleave",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_MOUSE_DOWN]="mousedown",t.exports.MIMOTOSCRIPT_ACTION_TYPES[t.exports.CONSTANT_EVENT_MOUSE_UP]="mouseup",t.exports.INSTRUCTIONS_CONFIGURATION=[t.exports.DATA_MIMOTO_ID,t.exports.DATA_MIMOTO_LAYOUT,t.exports.DATA_MIMOTO_TARGET,t.exports.DATA_MIMOTO_VIEW,t.exports.DATA_MIMOTO_SUBVIEW,t.exports.DATA_MIMOTO_DOCUMENT,t.exports.DATA_MIMOTO_LIST,t.exports.DATA_MIMOTO_COLLECTION,t.exports.DATA_MIMOTO_VALUE,t.exports.DATA_MIMOTO_NAVIGATION,t.exports.DATA_MIMOTO_DRAGHANDLE,t.exports.DATA_MIMOTO_FORM,t.exports.DATA_MIMOTO_REALTIME],t.exports.INSTRUCTIONS_WITH_PARSE_SUPPORT=[t.exports.DATA_MIMOTO_OUTPUT,t.exports.DATA_MIMOTO_INPUT,t.exports.DATA_MIMOTO_ACTION,t.exports.DATA_MIMOTO_EVENT,t.exports.DATA_MIMOTO_LOG,t.exports.DATA_MIMOTO_XRAY,t.exports.DATA_MIMOTO_ATTRIBUTE,t.exports.DATA_MIMOTO_CLASS,t.exports.DATA_MIMOTO_CONTAINER,t.exports.DATA_MIMOTO_META],t.exports.INSTRUCTIONS_STRING_AND_OBJECT=[t.exports.DATA_MIMOTO_CLASS,t.exports.DATA_MIMOTO_CONTAINER,t.exports.DATA_MIMOTO_TARGET,t.exports.DATA_MIMOTO_LAYOUT,t.exports.DATA_MIMOTO_VIEW,t.exports.DATA_MIMOTO_SUBVIEW,t.exports.DATA_MIMOTO_XRAY],t.exports.INSTRUCTIONS_ALL=t.exports.INSTRUCTIONS_CONFIGURATION.concat(t.exports.INSTRUCTIONS_WITH_PARSE_SUPPORT),t.exports.datasetIdentifierToInstruction={id:t.exports.DATA_MIMOTO_ID,nope:t.exports.DATA_MIMOTO_NOPE,status:t.exports.DATA_MIMOTO_STATUS,register:t.exports.DATA_MIMOTO_REGISTER,layout:t.exports.DATA_MIMOTO_LAYOUT,target:t.exports.DATA_MIMOTO_TARGET,view:t.exports.DATA_MIMOTO_VIEW,subview:t.exports.DATA_MIMOTO_SUBVIEW,document:t.exports.DATA_MIMOTO_DOCUMENT,key:t.exports.DATA_MIMOTO_KEY,output:t.exports.DATA_MIMOTO_OUTPUT,input:t.exports.DATA_MIMOTO_INPUT,list:t.exports.DATA_MIMOTO_LIST,collection:t.exports.DATA_MIMOTO_COLLECTION,container:t.exports.DATA_MIMOTO_CONTAINER,sortindex:t.exports.DATA_MIMOTO_SORTINDEX,value:t.exports.DATA_MIMOTO_VALUE,form:t.exports.DATA_MIMOTO_FORM,class:t.exports.DATA_MIMOTO_CLASS,attribute:t.exports.DATA_MIMOTO_ATTRIBUTE,meta:t.exports.DATA_MIMOTO_META,navigation:t.exports.DATA_MIMOTO_NAVIGATION,draghandle:t.exports.DATA_MIMOTO_DRAGHANDLE,action:t.exports.DATA_MIMOTO_ACTION,event:t.exports.DATA_MIMOTO_EVENT,realtime:t.exports.DATA_MIMOTO_REALTIME,hint:t.exports.DATA_MIMOTO_HINT,log:t.exports.DATA_MIMOTO_LOG,xray:t.exports.DATA_MIMOTO_XRAY},t.exports.INSTRUCTION_OPENING_CHARS=["[","{","(",'"',"'"],t.exports.INSTRUCTION_OPENING_CLOSING_CHARS={"[":{endChar:"]",type:t.exports.ARGUMENT_TYPE_ARRAY,isObject:!0},"{":{endChar:"}",type:t.exports.ARGUMENT_TYPE_OBJECT,isObject:!0,requiresKey:!0},"(":{endChar:")",type:t.exports.ARGUMENT_TYPE_CALLBACK,isObject:!0,hasName:!0},'"':{endChar:'"',type:t.exports.ARGUMENT_TYPE_VALUE,isString:!0},"'":{endChar:"'",type:t.exports.ARGUMENT_TYPE_VALUE,isString:!0}},t.exports.INSTRUCTION_OPERATORS=[",",".","+","-","*","/","^","&","|",">","<","="],t.exports.INSTRUCTION_OPERATORS_TYPES={",":{isDivider:!0},".":{type:t.exports.ARGUMENT_TYPE_CHAIN,requirePredecessor:[t.exports.ARGUMENT_TYPE_CALLBACK],method:t.exports.ARGUMENT_TYPE_CHAIN},"+":{type:t.exports.ARGUMENT_TYPE_MATH_PLUS,method:"sum"},"-":{type:t.exports.ARGUMENT_TYPE_MATH_MINUS,method:"subtract"},"*":{type:t.exports.ARGUMENT_TYPE_MATH_MULTIPLY,method:"multiply"},"/":{type:t.exports.ARGUMENT_TYPE_MATH_DIVIDE,method:"divide"},"^":{type:t.exports.ARGUMENT_TYPE_MATH_POWER,method:"power"},"&":{combo:{"&":{type:t.exports.ARGUMENT_TYPE_OPERATOR_AND,method:"and"}}},"|":{combo:{"|":{type:t.exports.ARGUMENT_TYPE_OPERATOR_OR,method:"or"}}},"=":{type:t.exports.ARGUMENT_TYPE_OPERATOR_EQUAL,method:"isEqual"},"<":{type:t.exports.ARGUMENT_TYPE_OPERATOR_LESSTHAN,method:"isLessThan",combo:{"=":{type:t.exports.ARGUMENT_TYPE_OPERATOR_LESSOREQUAL,method:"isLessOrEqualTo"}}},">":{type:t.exports.ARGUMENT_TYPE_OPERATOR_GREATERTHAN,method:"isGreaterThan",combo:{"=":{type:t.exports.ARGUMENT_TYPE_OPERATOR_GREATEROREQUAL,method:"isGreaterOrEqualTo"}}}},t.exports.INSTRUCTION_OPERATORS_TYPES_PRIMARY=[t.exports.ARGUMENT_TYPE_MATH_MULTIPLY,t.exports.ARGUMENT_TYPE_MATH_DIVIDE,t.exports.ARGUMENT_TYPE_MATH_POWER,t.exports.ARGUMENT_TYPE_OPERATOR_LESSTHAN,t.exports.ARGUMENT_TYPE_OPERATOR_LESSOREQUAL,t.exports.ARGUMENT_TYPE_OPERATOR_GREATERTHAN,t.exports.ARGUMENT_TYPE_OPERATOR_GREATEROREQUAL],t.exports.INSTRUCTION_OPERATORS_TYPES_SECONDARY=[t.exports.ARGUMENT_TYPE_OPERATOR_AND,t.exports.ARGUMENT_TYPE_OPERATOR_EQUAL],t.exports.INSTRUCTION_OPERATORS_TYPES_TERTIARY=[t.exports.ARGUMENT_TYPE_MATH_PLUS,t.exports.ARGUMENT_TYPE_MATH_MINUS,t.exports.ARGUMENT_TYPE_OPERATOR_OR,t.exports.ARGUMENT_TYPE_CHAIN],t.exports.convertDatasetIdentifierToInstruction=function(e,i=!1){if(void 0===t.exports.datasetIdentifierToInstructionRegex){let e="^mimoto(";Object.keys(t.exports.datasetIdentifierToInstruction).forEach(((t,i)=>{i>0&&(e+="|"),e+=t})),e+=")",t.exports.datasetIdentifierToInstructionRegex=new RegExp(e,"i")}let o=e.substring(0,t.exports.MIMOTO_PREFIX.length)===t.exports.MIMOTO_PREFIX,n=e.match(t.exports.datasetIdentifierToInstructionRegex);return null===n||void 0===n[1]?o?!!i&&t.exports.INSTRUCTION_PREFIX+e.substring(t.exports.MIMOTO_PREFIX.length).toLowerCase():null:t.exports.datasetIdentifierToInstruction[n[1].toLowerCase()]},t.exports.executeInstructions=function(e){for(let i in e){let n=e[i];if(t.exports.isSubview(n))n.subview.internal.run();else{for(let e in n.instructions){let i=n.instructions[e];t.exports.isAutoExecutableAction(i.type)&&(i.user.isEditing||i.execute().then((()=>{})).catch((t=>{})))}o.isEmpty(n.subNodes||{})||t.exports.executeInstructions(n.subNodes)}}},t.exports.indexInstructionForPreparsing=function(e){return new Promise(((i,n)=>{let s=[],r=!1;e.requiredVarsAndValuesPreparsed=[],e.requiredVarsAndValues=[],[t.exports.INSTRUCTION_VALUE,t.exports.INSTRUCTION_SETTINGS,t.exports.INSTRUCTION_VARS].forEach((i=>{if(Mimoto.data.isEmpty(e[i]))return;let a=null!==e[i]?e[i].replace(/(\r\n|\n|\r)/gm,""):null;e.parser[i]=a;let l=t.exports.preparseInstructionExecutable(e,i,a);s.push(l),l.then((n=>{e.parser[i+t.exports.INSTRUCTION_PREPARSE_INDEX]=n,e.requiredVarsAndValuesPreparse=t.exports.collectVars(e.parser[i+t.exports.INSTRUCTION_PREPARSE_INDEX],e.requiredVarsAndValues),e.requiredVarsAndValues=o.clone(e.requiredVarsAndValuesPreparse),e.parser[i+t.exports.INSTRUCTION_PREPARSED]=a,e.parser[i]=a,r||(r=!0===e.parser[i+t.exports.INSTRUCTION_PREPARSE_INDEX].some((e=>e.type===t.exports.ARGUMENT_TYPE_VAR||e.type===t.exports.ARGUMENT_TYPE_CONST||e.type===t.exports.ARGUMENT_TYPE_CALLBACK)))})).catch((t=>n(t)))})),Promise.all(s).then((()=>i(r))).catch((t=>n(t)))}))},t.exports.preparseInstructionExecutable=function(e,i,o){return new Promise(((e,i)=>{let n=null!==o?o.match(/{{(.*?)}}/gi):null,s=[],r=[];if(n){let e=n.length;for(let a=0;a<e;a++){let e=n[a],l=o.indexOf(e),u=t.exports.convertArgument("'"+o.substring(0,l)+"'");void 0!==u.hint&&i(u.hint),l>0&&s.push(u),o=o.substring(l+e.length),e=e.substring(2,e.length-2).trim();let c=t.exports.dissectInstructionValue(e),d=s.length;s.push(c),r.push(c),c.then((t=>s[d]=t[0]||[])).catch((t=>i(t)))}}let a=t.exports.convertArgument("'"+o+"'");void 0!==a.hint&&i(a.hint),o&&o.length>0&&s.push(a),Promise.all(r).then((()=>e(s))).catch((t=>i(t)))}))},t.exports.indexInstructionForParsing=function(e,i){return new Promise(((n,s)=>{let r=[],a=!1;e.requiredVarsAndValues=[],(i?[t.exports.INSTRUCTION_VALUE,t.exports.INSTRUCTION_SETTINGS,t.exports.INSTRUCTION_VARS]:[t.exports.INSTRUCTION_SETTINGS,t.exports.INSTRUCTION_VARS]).forEach((function(i){let n=e.parser[i];if(e.parser[i+t.exports.INSTRUCTION_PARSE_INDEX]=[],n=n&&"string"==typeof n?n.trim():void 0,e.parser[i]=n,void 0===n||0===n.length)return;t.exports.INSTRUCTIONS_STRING_AND_OBJECT.includes(e.type)&&("string"!=typeof e.parser[i]||o.isJSON(e.parser[i])||(n='"'+n+'"'));let l=t.exports.dissectInstructionValue(n);r.push(l),l.then((s=>{e.parser[i+t.exports.INSTRUCTION_PARSE_INDEX]=s,void 0!==n&&(e.requiredVarsAndValues=t.exports.collectVars(e.parser[i+t.exports.INSTRUCTION_PARSE_INDEX],o.clone(e.requiredVarsAndValuesPreparse))),a||void 0===n||(a=!0===e.parser[i+t.exports.INSTRUCTION_PARSE_INDEX].some((e=>e.type===t.exports.ARGUMENT_TYPE_VAR||e.type===t.exports.ARGUMENT_TYPE_CONST||e.type===t.exports.ARGUMENT_TYPE_CALLBACK||e.type===t.exports.ARGUMENT_TYPE_OBJECT||e.type===t.exports.ARGUMENT_TYPE_ARRAY)))})).catch((t=>s(t)))})),Promise.all(r).then((()=>n(a))).catch((t=>s(t)))}))},t.exports.dissectInstructionValue=function(e){return new Promise(((i,o)=>{try{let n=t.exports.deepDissectInstructionValue(e);if(void 0===n)return void i(void 0);if(n.hint)return void o(n);n=t.exports.convertOperators(n,t.exports.INSTRUCTION_OPERATORS_TYPES_PRIMARY),n=t.exports.convertOperators(n,t.exports.INSTRUCTION_OPERATORS_TYPES_SECONDARY),n=t.exports.convertOperators(n,t.exports.INSTRUCTION_OPERATORS_TYPES_TERTIARY),i(n)}catch(t){o(t)}}))},t.exports.deepDissectInstructionValue=function(e,i=null,o=!1,n=!1,s=!1){if(void 0===e)return;let r=[],a={key:"",value:"",element:{}};for(e=e||"";e.length>0;){let l=e.substring(0,1);if(e=e.slice(1),null!==i&&l===i)return t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l]?.isString&&(a.value+=l),!n&&a.value.length>0&&t.exports.parseInstructionAddArgument(t.exports.convertArgument(a.value),r,a),{sRemainingInstruction:e,result:n?a.value:r};if(n)t.exports.parseInstructionAddChar(a,l,n);else if(t.exports.INSTRUCTION_OPENING_CHARS.includes(l)){if(t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l]?.isObject){if(a.element.type=t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l].type,s&&0===a.key.length)return{hint:"Object is missing a key"};if(!t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l].hasName&&a.value.length>0)return{hint:"Incorrectly formatted "+a.element.type};t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l].hasName&&0===a.value.length&&(a.element.type=t.exports.ARGUMENT_TYPE_OPERATOR_GROUP),t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l].hasName&&(a.element.type!==t.exports.ARGUMENT_TYPE_OPERATOR_GROUP&&(a.element.name=a.value.trim(),a.element.name.toUpperCase()===t.exports.ARGUMENT_TYPE_CHAIN_DATA&&(a.element.type=t.exports.ARGUMENT_TYPE_CHAIN_DATA)),a.value="")}let i=t.exports.deepDissectInstructionValue(e,t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l].endChar,t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l].type===t.exports.ARGUMENT_TYPE_OBJECT,t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l]?.isString,t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l]?.requiresKey);if(i.hint)return i;e=i.sRemainingInstruction,t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l]?.isString?a.element=t.exports.convertArgument(t.exports.INSTRUCTION_OPENING_CLOSING_CHARS[l].endChar+i.result):a.element.arguments=i.result,t.exports.parseInstructionAddArgument(a.element,r,a),a.element={}}else if(o&&":"===l)0===a.value.length&&r.length>0&&r[r.length-1].type===t.exports.ARGUMENT_TYPE_VALUE?(a.key=r[r.length-1].value.trim(),r.splice(r.length-1,1)):a.key=a.value,a.value="";else if("."===l&&a.value.length>0&&!isNaN(a.value))a.value+=l;else if((o&&a.key.length>0||!o)&&t.exports.INSTRUCTION_OPERATORS.includes(l)){if(t.exports.INSTRUCTION_OPERATORS_TYPES[l].requirePredecessor&&(0===r.length||!t.exports.INSTRUCTION_OPERATORS_TYPES[l]?.requirePredecessor.includes(r[r.length-1].type))){t.exports.parseInstructionAddChar(a,l,n);continue}if(t.exports.parseInstructionAddRemainingValue(r,a),a.value="",t.exports.INSTRUCTION_OPERATORS_TYPES[l].isDivider){a.key="";continue}if(0===r.length&&["-","+"].includes(l))r.push({type:t.exports.ARGUMENT_TYPE_VALUE,value:parseInt(l+"1")}),r.push({type:t.exports.ARGUMENT_TYPE_MATH_MULTIPLY,operator:"*"});else{let i=null,o=l;t.exports.INSTRUCTION_OPERATORS_TYPES[l].combo&&void 0!==t.exports.INSTRUCTION_OPERATORS_TYPES[l].combo[e.substring(0,1)]?(i=t.exports.INSTRUCTION_OPERATORS_TYPES[l].combo[e.substring(0,1)].type,o+=e.substring(0,1),e=e.slice(1)):t.exports.INSTRUCTION_OPERATORS_TYPES[l].type&&(i=t.exports.INSTRUCTION_OPERATORS_TYPES[l].type),null!==i&&r.push({type:i,operator:o})}a.value=""}else t.exports.parseInstructionAddChar(a,l,n)}return t.exports.parseInstructionAddRemainingValue(r,a),null!==i?{hint:"Instruction not properly formatted"}:r},t.exports.parseInstructionAddChar=function(t,e,i){(0!==t.value.length||" "!==e||i)&&(t.value+=e)},t.exports.parseInstructionAddRemainingValue=function(e,i){i.value.trim().length>0&&t.exports.parseInstructionAddArgument(t.exports.convertArgument(i.value),e,i),i.element={}},t.exports.parseInstructionAddArgument=function(t,e,i){void 0!==i.key&&i.key.length>0&&(t.key=i.key),e.push(t)},t.exports.convertOperators=function(e,i=[]){for(let o=e.length-1;o>=0;o--){let n=e[o];if(n.arguments&&n.arguments.length>0&&(n.arguments=t.exports.convertOperators(n.arguments,i)),!i.includes(n.type))continue;let s=null,r=t.exports.INSTRUCTION_OPERATORS_TYPES[n.operator.substring(0,1)];for(let t in r.combo)if(r.combo[t].type===n.type){s=r.combo[t].method;break}null===s&&r.type===n.type&&(s=r.method);let a=e.splice(o-1,3),l={type:t.exports.ARGUMENT_TYPE_CALLBACK,name:s,arguments:[a[0],a[2]]};a[0].key&&(l.key=a[0].key),e.splice(o-1,0,l)}return e},t.exports.convertArgument=function(e){if(e=e.trim(),/^["'].*["']$/.test(e))return{type:t.exports.ARGUMENT_TYPE_VALUE,value:e.substring(1,e.length-1)};if(/^-?[0-9]+(\.[0-9]+)?$/.test(e))return{type:t.exports.ARGUMENT_TYPE_VALUE,value:-1!==e.indexOf(".")?parseFloat(e):parseInt(e)};if(/^(true|false)$/.test(e))return{type:t.exports.ARGUMENT_TYPE_VALUE,value:"true"===e};if(t.exports.MIMOTOSCRIPT_CONSTANTS.includes(e))return{type:t.exports.ARGUMENT_TYPE_CONST,value:e};let i=e,n={type:t.exports.ARGUMENT_TYPE_VAR,name:i};return o.verifyFormat(i)||(n.hint='Var name "'+i+'" not formatted correctly'),n},t.exports.collectVars=function(e,i){let o=e.length;for(let n=0;n<o;n++){let o=e[n];switch(o.type){case t.exports.ARGUMENT_TYPE_VAR:i.includes(o.name)||i.push(o.name);break;case t.exports.ARGUMENT_TYPE_CALLBACK:case t.exports.ARGUMENT_TYPE_OBJECT:case t.exports.ARGUMENT_TYPE_ARRAY:case t.exports.ARGUMENT_TYPE_OPERATOR_GROUP:i=t.exports.collectVars(o.arguments,i)}}return i},t.exports.computeInstruction=function(e,i,n,s=!0){return new Promise(((r,a)=>{let l=[],u=[],c=[];(s?[t.exports.INSTRUCTION_VALUE,t.exports.INSTRUCTION_SETTINGS,t.exports.INSTRUCTION_VARS]:[t.exports.INSTRUCTION_SETTINGS,t.exports.INSTRUCTION_VARS]).forEach((s=>{let r=e.parser[s+i];if(void 0===r)return;u[s]=[],c[s]=[];let a=new Promise(((i,a)=>{let l=r.length;for(let i=0;i<l;i++){let o=r[i],l=t.exports.composeArgument(o,e,n);l.then((t=>c[s][i]=t)).catch((t=>a(t))),u[s].push(l)}Promise.all(u[s]).then((()=>{if(1===c[s].length&&o.isObject(c[s][0])||Array.isArray(c[s][0]))e.parser[s]=c[s][0];else if(1===c[s].length)e.parser[s]=c[s][0];else if(0===c[s].length)e.parser[s]=void 0;else{let t="",i=c[s].length;for(let e=0;e<i;e++)t+=void 0!==c[s][e]?c[s][e]:"";e.parser[s]=t}i()})).catch((t=>a(t)))}));l.push(a)})),Promise.all(l).then((()=>r())).catch((t=>a(t)))}))},t.exports.executeCallback=function(e,i,n){return new Promise(((s,r)=>{let a=e.group||"",l=e.name,u=l.lastIndexOf(".");u>-1&&(a=l.substring(0,u),l=l.substring(u+1));let c=[];a.length>0&&(c=a.indexOf(".")>-1?a.split("."):[a]);let d=["set","update","delete","add","remove"].includes(l.toLowerCase()),h=c.filter((e=>e.toUpperCase()===t.exports.CONSTANT_PARENT)).length;d&&(c=c.filter((e=>e.toUpperCase()!==t.exports.CONSTANT_PARENT)));let _=i.node.getDataSource(i.group,void 0,l,h),p=i.node.getRoot(),T=p.ui?p.ui.localMethods:{};if(_)for(let t in _.source.localMethods)T[t]=_.source.localMethods[t];a.length;let m=void 0!==T[l],g=i.node.getRoot().view;c.length>0&&("Mimoto"===c[0]?(g=window.Mimoto,c.shift()):"window"===c[0].toLowerCase()?(g=window,c.shift()):"document"===c[0].toLowerCase()&&(g=document,c.shift()));let f=t.exports.buildScope(g,o.clone(c));if(!m){if(!1===f&&(f=t.exports.buildScope(window,c),!1===f))return void r("Callback's location '"+a+"' not found");if(void 0===f[l])if(p.view.internal.publicAPI[l.toUpperCase()])f=p.view.Mimoto.ui,l=p.view.internal.publicAPI[l.toUpperCase()];else if(Mimoto.data.internal.publicAPI[l.toUpperCase()])f=Mimoto.data,l=Mimoto.data.internal.publicAPI[l.toUpperCase()];else if(Mimoto.user.internal.publicAPI[l.toUpperCase()])f=Mimoto.user,l=Mimoto.user.internal.publicAPI[l.toUpperCase()];else{if(!window[l])return void r("Callback '"+(a?a+".":"")+l+"' not found");f=window}}t.exports.composeArguments(e.arguments,i,n).then((t=>{let e=null;if(m){let i=Array.isArray(T[l].arguments)?T[l].arguments:[];if(Array.isArray(T[l].delegatedArguments)){let t=[];T[l].delegatedArguments.forEach((e=>{t.push("function"==typeof e?e():e)})),i=i.concat(t)}i=i.concat(t),e=T[l].method.apply(T[l].scope,i)}else{if(!f[l])return void r("Callback '"+(a?a+".":"")+l+"' not found.");e=f[l].apply(f,t)}o.isPromise(e)?e.then((t=>s(t))).catch((t=>r(t))):s(e)})).catch((t=>r(t)))}))},t.exports.composeArguments=function(e,i,o,n=!1){return new Promise(((s,r)=>{let a=[],l=n?{}:[],u=e.length;for(let s=0;s<u;s++){let u=e[s],c=t.exports.composeArgument(u,i,o);c.then((t=>{n?l[u.key]=t:l[s]=t})).catch((t=>r(t))),a.push(c)}Promise.all(a).then((()=>{s(l)})).catch((t=>r(t)))}))},t.exports.composeArgument=function(e,i,s){return new Promise(((r,a)=>{switch(e.type){case t.exports.ARGUMENT_TYPE_VALUE:r(e.value);break;case t.exports.ARGUMENT_TYPE_VAR:if(!s){r(void 0);break}r(o.getDeepValue(e.name,s));break;case t.exports.ARGUMENT_TYPE_CONST:if("STATE_"===e.value.substring(0,6)){r(i.node.hasState(e.value));break}if([t.exports.CONSTANT_KEY,t.exports.CONSTANT_DOCUMENT_KEY,t.exports.CONSTANT_DOCUMENT_PATH,t.exports.CONSTANT_SORTINDEX,t.exports.CONSTANT_DATA,t.exports.CONSTANT_VARS].includes(e.value)){let o=i.node.getDataSource(i.group,[n.TYPE,n.TYPE_FORM]);if(o)switch(e.value){case t.exports.CONSTANT_KEY:case t.exports.CONSTANT_DOCUMENT_KEY:r(o.source.getKey());break;case t.exports.CONSTANT_DOCUMENT_PATH:r(o.source.getPath()+"/"+o.source.getKey());break;case t.exports.CONSTANT_SORTINDEX:Mimoto.log("CONSTANT_SORTINDEX",i.node.getRoot().ui.elRoot.getAttribute(t.exports.DATA_MIMOTO_SORTINDEX)),r(i.node.getRoot().ui.elRoot.getAttribute(t.exports.DATA_MIMOTO_SORTINDEX));break;case t.exports.CONSTANT_DATA:r(o.source.getValue());break;case t.exports.CONSTANT_VARS:r(i.node.getVars())}break}if([t.exports.CONSTANT_USER_ID,t.exports.CONSTANT_USER_DISPLAYNAME,t.exports.CONSTANT_USER_AVATAR,t.exports.CONSTANT_USER_EMAIL,t.exports.CONSTANT_USER_ISADMIN,t.exports.CONSTANT_USER_ISVERIFIED,t.exports.CONSTANT_HTML,t.exports.CONSTANT_NODE,t.exports.CONSTANT_VIEW,t.exports.CONSTANT_URL,t.exports.CONSTANT_URL_DOMAIN,t.exports.CONSTANT_URL_PROTOCOL,t.exports.CONSTANT_URL_HOST,t.exports.CONSTANT_URL_PORT,t.exports.CONSTANT_URL_PATH,t.exports.CONSTANT_VARS,t.exports.CONSTANT_VALUES,t.exports.CONSTANT_NULL,t.exports.CONSTANT_NULL_LOWERCASE,t.exports.CONSTANT_UNDEFINED,t.exports.CONSTANT_UNDEFINED_LOWERCASE].includes(e.value)){switch(e.value){case t.exports.CONSTANT_USER_ID:r(window.Mimoto.user.getId());break;case t.exports.CONSTANT_USER_ISADMIN:r(window.Mimoto.user.isAdmin());break;case t.exports.CONSTANT_USER_ISVERIFIED:r(window.Mimoto.user.hasEmailVerified());break;case t.exports.CONSTANT_USER_DISPLAYNAME:r(window.Mimoto.user.getDisplayName());break;case t.exports.CONSTANT_USER_AVATAR:r(window.Mimoto.user.getPhotoURL());break;case t.exports.CONSTANT_USER_EMAIL:r(window.Mimoto.user.getEmail());break;case t.exports.CONSTANT_HTML:r(i.node.elNode);break;case t.exports.CONSTANT_NODE:r(i.node);break;case t.exports.CONSTANT_VIEW:r(i.node.getRoot().view);break;case t.exports.CONSTANT_URL:r(window.location.href);break;case t.exports.CONSTANT_URL_DOMAIN:r(window.location.protocol+"//"+window.location.hostname+":"+window.location.port);break;case t.exports.CONSTANT_URL_PROTOCOL:r(window.location.protocol);break;case t.exports.CONSTANT_URL_HOST:r(window.location.hostname);break;case t.exports.CONSTANT_URL_PORT:r(window.location.port);break;case t.exports.CONSTANT_URL_PATH:r(window.location.pathname);break;case t.exports.CONSTANT_NULL:case t.exports.CONSTANT_NULL_LOWERCASE:r(null);break;case t.exports.CONSTANT_UNDEFINED:case t.exports.CONSTANT_UNDEFINED_LOWERCASE:r(void 0)}break}r(e.value);break;case t.exports.ARGUMENT_TYPE_ARRAY:t.exports.composeArguments(e.arguments,i,s).then((t=>r(t))).catch((t=>a(t)));break;case t.exports.ARGUMENT_TYPE_OBJECT:t.exports.composeArguments(e.arguments,i,s,!0).then((t=>r(t))).catch((t=>a(t)));break;case t.exports.ARGUMENT_TYPE_CALLBACK:switch(e.name.toUpperCase()){case t.exports.ARGUMENT_TYPE_CHAIN:let o=e.arguments[0],n=e.arguments[1];if(o.name.toUpperCase()===t.exports.ARGUMENT_TYPE_CHAIN_VERIFY){let e=new Promise(((e,n)=>{t.exports.executeCallback(o.arguments[0],i,s).then((i=>{!0===i?e():n({MimotoParseResponse:t.exports.CANCEL})})).catch((t=>n(t)))}));e.then((()=>{t.exports.executeFollowUpMethods(n,i,{},s).then((t=>r())).catch((t=>a(t)))})).catch((t=>a(t)))}else{t.exports.composeArgument(o,i,s).then((e=>{t.exports.executeFollowUpMethods(n,i,e,s).then((t=>r(t))).catch((t=>a(t)))})).catch((t=>a(t)))}break;case t.exports.ARGUMENT_TYPE_CHAIN_EVENTDATA:r(e.arguments[0]);break;default:t.exports.executeCallback(e,i,s).then((t=>r(t))).catch((t=>a(t)))}break;case t.exports.ARGUMENT_TYPE_OPERATOR_GROUP:t.exports.composeArguments(e.arguments,i,s).then((t=>r(t))).catch((t=>a(t)))}}))},t.exports.executeFollowUpMethods=function(e,i,n,s={}){return new Promise(((r,a)=>{e||r();let l=[];switch(e.type){case t.exports.ARGUMENT_TYPE_ARRAY:l=e.arguments;break;case t.exports.ARGUMENT_TYPE_CALLBACK:l.push(e)}l.forEach((e=>{let l=t.exports.mapVars(o.clone(e),n);t.exports.composeArgument(l,i,s).then((t=>r(t))).catch((t=>a(t)))}))}))},t.exports.mapVars=function(e,i,n=!1){if(!e.arguments)return e;let s=e.type===t.exports.ARGUMENT_TYPE_CALLBACK&&e.name===t.exports.ARGUMENT_TYPE_CHAIN;return e.arguments.forEach(((r,a)=>{if(!n&&s&&a>0&&(n=!0),r.type===t.exports.ARGUMENT_TYPE_CHAIN_DATA){if(n){if(!o.isObject(i))return;return void(r.inheritedData=r.inheritedData?o.mergeDeep(r.inheritedData,i):i)}let s=r.inheritedData?o.mergeDeep(r.inheritedData,i||{}):i;if(0===r.arguments.length)return void(e.arguments[a]={type:t.exports.ARGUMENT_TYPE_VALUE,value:s,key:r.key});if(r.arguments[0].type===t.exports.ARGUMENT_TYPE_VALUE){let i=null!=s?o.getDeepValue(r?.arguments[0].value,s):"";e.arguments[a]={type:t.exports.ARGUMENT_TYPE_VALUE,value:i,key:r.key}}return}let l=n||r.type===t.exports.ARGUMENT_TYPE_CALLBACK&&r.name.toUpperCase()===t.exports.ARGUMENT_TYPE_CHAIN;e.arguments[a]=t.exports.mapVars(r,i,l)})),e},t.exports.buildScope=function(e,i){if(i.length>0){let o=i.shift();if(o.toUpperCase()===t.exports.CONSTANT_PARENT)Mimoto.log("PARENT",o,i,e),e=(e=t.exports.buildScope(e.internal.getNodeTree().container.getRoot().view,i)).Mimoto.ui;else{if(void 0===e[o])return!1;e=t.exports.buildScope(e[o],i)}}return e},t.exports.addHint=function(e,i){e.getAttribute(t.exports.DATA_MIMOTO_HINT)!==i&&(e.setAttribute(t.exports.DATA_MIMOTO_HINT,"string"==typeof i?i:JSON.stringify(i)),e.setAttribute(t.exports.DATA_MIMOTO_STATUS,t.exports.DATA_MIMOTO_STATUS_ERROR),window.Mimoto.devtools.hint(e),"object"==typeof i&&Mimoto.error("ERROR =",i))},t.exports.verifyIfValueChanged=function(t,e,i){if(null!==t.data.cache){if(o.getDeepValue(i,t.data.cache)!==o.getDeepValue(i,e))return!0}else if(void 0!==o.getDeepValue(i,e))return!0;return!1},t.exports.buildDeepValue=function(e,i,o={},n=null){if(e.indexOf(".")<0)null!==n?o[n][e]=i:("object"!=typeof o&&(o={}),o[e]=i);else{let s=e.substring(0,e.indexOf(".")),r=e.substring(e.indexOf(".")+1),a=t.exports.buildDeepValue(r,i);null!==n?o[n][s]=a:o[s]=a}return null!==n?o[n]:o},t.exports.isAutoExecutableAction=function(e){return![t.exports.DATA_MIMOTO_ID].includes(e)},t.exports.isSubview=function(t){return!0===t.isSubview}},42:(t,e,i)=>{"use strict";const o=i(948);t.exports.PREFIX="mim‚ò∫to.24a",t.exports.POSTFIX="s‚ô•3",t.exports.KEY_LENGTH=32,t.exports.validateLicenseKeyFormat=function(e=""){return 0===e.indexOf(t.exports.PREFIX)&&e.indexOf(t.exports.POSTFIX)===e.length-t.exports.POSTFIX.length},t.exports.validateLicenseKey=function(e=""){const i=function(t="",e=""){let i=[];for(let o=0;o<t.length;o++){const n=t.charCodeAt(o),s=e.charCodeAt(o%e.length);i.push(n^s)}return String.fromCharCode(...i)}(function(t){const e=new TextDecoder,i=Uint8Array.from(atob(t),(t=>t.charCodeAt(0)));return e.decode(i)}(e.substring(t.exports.PREFIX.length+t.exports.KEY_LENGTH,e.length-t.exports.POSTFIX.length)),e.substring(t.exports.PREFIX.length,t.exports.PREFIX.length+t.exports.KEY_LENGTH));if(!o.isJSON(i))return!1;let n={};try{n=JSON.parse(i)}catch(t){return!1}if(t.exports.getRootDomain(location.hostname)!==n.domain)return"Domain "+location.hostname+" not licensed";if(!/^\d{4}\.\d{2}\.\d{2}$/.test(n.expires))return"Invalid expiry date";const s=n.expires.split("."),r=parseInt(s[0],10),a=parseInt(s[1],10)-1,l=parseInt(s[2],10),u=new Date(r,a,l+1),c=new Date;return c.setHours(0,0,0,0),c<=u||"License expired"},t.exports.getRootDomain=function(t){return t.split(".").slice(-2).join(".")},t.exports.reportMissingLicenseKey=function(){Mimoto.log("%c üôà Missing license key %c - Get yours at https://thesocialcode.com/mimoto (pay what you want)","font-weight: bold; background-color:#93C47C; color: #ffffff; padding: 5px 5px;border-radius: 5px;","font-weight: normal")}},749:(t,e,i)=>{"use strict";const o=i(752),n=i(749);t.exports.registerTemplates=function(t){t.querySelectorAll("["+o.DATA_MIMOTO_REGISTER+"]").forEach((t=>{let e=t.getAttribute(o.DATA_MIMOTO_REGISTER);t.parentNode.removeChild(t),t.removeAttribute(o.DATA_MIMOTO_REGISTER),window.Mimoto.layout.addTemplate(e,t.outerHTML)}))},t.exports.buildInstanceFromTemplate=function(t){let e=document.createElement("div"),i=document.createElement("div");for(i.innerHTML=t.trim();i.childNodes.length>0;){let t=i.removeChild(i.firstChild);/^(#comment|#text)$/gi.test(t.nodeName)||e.append(t)}if(n.registerTemplates(e),1===e.children.length)return e.firstChild;if(0===e.children.length)return!1;{let t=0;e.childNodes.forEach((e=>{e.hasAttribute&&!e.hasAttribute(o.DATA_MIMOTO_REGISTER)&&t++})),!t>1&&o.addHint(e,"Template should only contain 1 node")}return e},t.exports.findElementIndexInContainer=function(t){return Array.prototype.slice.call(t.parentNode.children).indexOf(t)}},46:t=>{"use strict";t.exports.selectText=function(t){let e,i;window.getSelection&&document.createRange?(i=document.createRange(),i.selectNodeContents(t),e=window.getSelection(),e.removeAllRanges(),e.addRange(i)):document.body.createTextRange&&(i=document.body.createTextRange(),i.moveToElementText(t),i.select())},t.exports.setCursorPosition=function(e,i){if(i>=0){var o=window.getSelection();let n=t.exports._createRange(e,{count:i});n&&(n.collapse(!1),o.removeAllRanges(),o.addRange(n))}},t.exports._createRange=function(e,i,o){if(o||((o=document.createRange()).selectNode(e),o.setStart(e,0)),0===i.count)o.setEnd(e,i.count);else if(e&&i.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<i.count?i.count-=e.textContent.length:(o.setEnd(e,i.count),i.count=0);else for(var n=0;n<e.childNodes.length&&(o=t.exports._createRange(e.childNodes[n],i,o),0!==i.count);n++);return o}},948:t=>{"use strict";t.exports.isObject=function(t){return t&&"object"==typeof t&&!Array.isArray(t)},t.exports.clone=function(e){if(null===e||"object"!=typeof e)return e;let i=Array.isArray(e)?[]:{};for(let o in e)e.hasOwnProperty(o)&&(i[o]=t.exports.clone(e[o]));return i},t.exports.updateObjectWithMissingFields=function(e,i){for(let o in e)e.hasOwnProperty(o)&&("object"!=typeof e[o]||null===e[o]||Array.isArray(e[o])?i.hasOwnProperty(o)||(i[o]=void 0):(i.hasOwnProperty(o)&&"object"==typeof i[o]&&null!==i[o]&&!Array.isArray(i[o])||(i[o]={}),t.exports.updateObjectWithMissingFields(e[o],i[o])));return i},t.exports.compare=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},t.exports.compareValuesInObjects=function(e,i){if("object"==typeof e&&"object"==typeof i){for(let o in e){if(i&&"object"==typeof i&&void 0===i[o])return!1===e[o];if("object"==typeof e[o]||i&&"object"==typeof i[o])return t.exports.compareValuesInObjects(e[o],i[o]);if(i&&e[o]!==i[o])return!1}return!0}return e===i},t.exports.verifyFormat=function(t){return/^[a-z_][a-z0-9_]*(\.[a-z_][a-z0-9_]*)*$/gi.test(t)},t.exports.isJSON=function(t){return!(t.length<2)&&(!!/^(\[|{)/gi.test(t)&&!t.substring(t.length-1,1)!==t.substring(0,1))},t.exports.isPromise=function(t){return Boolean(t&&"function"==typeof t.then)},t.exports.isEmpty=function(t){return 0===Object.keys(t).length},t.exports.mergeDeep=function(e,i){let o={};if(t.exports.isObject(e)&&t.exports.isObject(i)){for(let n in i)void 0===e[n]||t.exports.isObject(i[n])&&0===Object.keys(i[n]).length?o[n]=i[n]:t.exports.isObject(e[n])?o[n]=t.exports.mergeDeep(e[n],i[n]):o[n]=i[n];for(let t in e)void 0===o[t]&&(o[t]=e[t])}else o=window.Mimoto.data.isEmpty(e)?i:e;return o},t.exports.getDeepValue=function(t,e){let i=t.split("."),o=e;for(;i.length>0;){let t=i.shift();if(void 0===o[t])return;o=o[t]}return o},t.exports.setDeepValue=function(t,e,i={}){let o=t.split("."),n=i;for(;o.length>0;){let t=o.shift();if(0===o.length)return n[t]=e,i;void 0===n[t]&&(n[t]={}),n=n[t]}},t.exports.sortByKeys=t=>(e,i)=>t.map((t=>{let o=1;return"-"===t[0]&&(o=-1,t=t.substring(1)),e[t]>i[t]?o:e[t]<i[t]?-o:0})).reduce(((t,e)=>t||e),0),t.exports.removeUndefinedProperties=function(e){for(let i in e)e.hasOwnProperty(i)&&void 0===e[i]&&delete e[i],"object"==typeof e[i]&&t.exports.removeUndefinedProperties(e[i]);return e},t.exports.createInstructionExtensionObject=function(t,e,i,o,n,s=null){return{id:n,value:t,settings:e,vars:i,elNode:o,data:s}}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__(914);var __webpack_exports__=__webpack_require__(412)})();